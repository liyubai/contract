//package com.cauc.training.business.hibernate.del;
//
//
//import java.text.ParseException;
//import java.util.ArrayList;
//import java.util.Calendar;
//import java.util.Collections;
//import java.util.Date;
//import java.util.HashMap;
//import java.util.Iterator;
//import java.util.List;
//import java.util.Map;
//
//import org.apache.commons.lang.StringUtils;
//import org.apache.commons.logging.Log;
//import org.apache.commons.logging.LogFactory;
//import org.hibernate.Criteria;
//import org.hibernate.HibernateException;
//import org.hibernate.criterion.Order;
//import org.hibernate.criterion.Restrictions;
//import org.springframework.stereotype.Service;
//import org.springframework.transaction.annotation.Isolation;
//import org.springframework.transaction.annotation.Transactional;
//
//import com.cauc.training.FinanceServiceException;
//import com.cauc.training.business.IStudentService;
//import com.cauc.training.business.dao.GenericHibernateDAO;
//import com.cauc.training.business.dao.support.Page;
//import com.cauc.training.config.FinanceConfig;
//import com.cauc.training.pojos.GraduationDesign;
//import com.cauc.training.pojos.GraduationStudentAssign;
//import com.cauc.training.pojos.Newworkerandchangetrain;
//import com.cauc.training.pojos.RecommendStudentLicenseExam;
//import com.cauc.training.pojos.StudentBaseInfo;
//import com.cauc.training.pojos.StudentDistributionClass;
//import com.cauc.training.pojos.StudentLicense;
//import com.cauc.training.pojos.StudentLicensehistory;
//import com.cauc.training.pojos.StudentLicenseskilledcheck;
//import com.cauc.training.pojos.Studentassignschool;
//import com.cauc.training.pojos.Studentstatuschange;
//import com.cauc.training.pojos.TAbroadaviationschool;
//import com.cauc.training.pojos.TAbroadtrain;
//import com.cauc.training.pojos.TChangedbase;
//import com.cauc.training.pojos.TChangedgroup;
//import com.cauc.training.pojos.TDgdistribution;
//import com.cauc.training.pojos.TDiction;
//import com.cauc.training.pojos.TForeignaviationschoolinterview;
//import com.cauc.training.pojos.TGnchangedgw;
//import com.cauc.training.pojos.TGntrainbackschool;
//import com.cauc.training.pojos.THistoryscore;
//import com.cauc.training.pojos.THistoryscorebak;
//import com.cauc.training.pojos.TLesson;
//import com.cauc.training.pojos.TOffschool;
//import com.cauc.training.pojos.TOrg;
//import com.cauc.training.pojos.TOtheruser;
//import com.cauc.training.pojos.TPointLine;
//import com.cauc.training.pojos.TScore;
//import com.cauc.training.pojos.TSetClass;
//import com.cauc.training.pojos.TStuMedical;
//import com.cauc.training.pojos.TStuStatus;
//import com.cauc.training.pojos.TStuassignbase;
//import com.cauc.training.pojos.TStuassigngroup;
//import com.cauc.training.pojos.TStuassignteacher;
//import com.cauc.training.pojos.TStuchangedteacher;
//import com.cauc.training.pojos.TStustopfly;
//import com.cauc.training.pojos.TUser;
//import com.cauc.training.pojos.TeacherBaseInfo;
//import com.cauc.training.util.SortComparator;
//import com.cauc.training.util.Utilities;
//import com.cauc.training.vo.AdvancedSearchBean;
//import com.cauc.training.vo.VLessonScore;
//import com.cauc.training.vo.VOTTeaLicenseskilledcheck;
//import com.cauc.training.vo.VScore;
//import com.cauc.training.vo.VSetClass;
//import com.cauc.training.vo.VSetClassContent;
//import com.cauc.training.vo.VStudentBaseInfo;
//import com.cauc.training.vo.VStudentDistributionClass;
//import com.cauc.training.vo.VStudentLicense;
//import com.cauc.training.vo.Vforeignaviationschoolinterview;
//
//@Service
//public class StudentServiceImpl extends GenericHibernateDAO implements IStudentService{
//
//	private static Log log = LogFactory.getLog(StudentServiceImpl.class);
//	
//	private TLesson lesson;
//	private TSetClass setClass;
//	private TScore score;
//
//	public List<TDiction> readDictionList(String typeid)throws FinanceServiceException {
//		try{
//			return super.findBy(TDiction.class, "TDictype.VId", typeid);
//		}catch(HibernateException e){
//			throw new FinanceServiceException("读取相关配置信息失败", e);
//		}
//	}
//
//	private String[] getCondValue(Map<String, Object> params){
//		
//		String cond = "";
//		String condValue = "";
//		
//		if (params.get(QUERY_KEY_NAME) != null
//				&& !params.get(QUERY_KEY_NAME).equals("")){
//			cond+=" and ( a.v_code like ? or a.v_name like ? )";
//			condValue+="%" + params.get(QUERY_KEY_NAME) + "%" + ","+"%" + params.get(QUERY_KEY_NAME) + "%" + ",";
//		}
//		
//		if (params.get(QUERY_KEY_CLASS) != null
//				&& !params.get(QUERY_KEY_CLASS).equals("")){
//			cond+=" and a.V_classNoid like ? ";
//			condValue+="%" + params.get(QUERY_KEY_CLASS) + "%" + ",";
//		}
//		
//		if (params.get(QUERY_KEY_YEAR) != null
//				&& !params.get(QUERY_KEY_YEAR).equals("")){
//			cond+=" and year(a.D_rxsj) = ? ";
//			condValue+=params.get(QUERY_KEY_YEAR) + ",";
//		}
//	
//		
//		/*
//		if(params.get(QUERY_KEY_ASSIGN_YES) != null
//				&& !params.get(QUERY_KEY_ASSIGN_YES).equals("")){
//			cond+=" and isnull(b.v_outlineid,'')<>''";
//		}*/
//		
//		if(params.get(QUERY_KEY_STUDENT_TYPE) != null
//				&& !params.get(QUERY_KEY_STUDENT_TYPE).equals("")){
//			cond+=" and a.v_stuTypeid = ? ";
//			condValue+= params.get(QUERY_KEY_STUDENT_TYPE)+","; 
//		}
//		
//		if(params.get(QUERY_KEY_COMPANY) != null
//				&& !params.get(QUERY_KEY_COMPANY).equals("")){
//			if(params.get(QUERY_KEY_COMPANY).equals("0")){
//				cond+=" and a.v_companyid is null";
//			}else{
//				cond+=" and a.v_companyid = ? ";
//				condValue+= params.get(QUERY_KEY_COMPANY)+",";
//			}
//		}
//		
//		if(params.get(QUERY_KEY_STUDENT_STATUS) != null
//				&& !params.get(QUERY_KEY_STUDENT_STATUS).equals("")){
//			if(params.get(QUERY_KEY_STUDENT_STATUS).equals("0")){
//				cond+=" and a.v_stuStatusid is null ";
//			}else{
//				cond+=" and a.v_stuStatusid = ? ";
//				condValue+= params.get(QUERY_KEY_STUDENT_STATUS)+","; 
//			}
//		}
//		
//		if(params.get(QUERY_KEY_XJ_STUDENT_STATUS) != null
//				&& !params.get(QUERY_KEY_XJ_STUDENT_STATUS).equals("")){
//			if(params.get(QUERY_KEY_XJ_STUDENT_STATUS).equals("0")){
//				cond+=" and a.v_xjStatusid is null ";
//			}else{
//				cond+=" and a.v_xjStatusid = ? ";
//				condValue+= params.get(QUERY_KEY_XJ_STUDENT_STATUS)+","; 
//			}
//		}
//		if(params.get(QUERY_KEY_FORM) != null
//				&& !params.get(QUERY_KEY_FORM).equals("")){
//			cond+=" and a.v_formid = ? ";
//			condValue+= params.get(QUERY_KEY_FORM)+","; 
//		}
//		if(params.get(QUERY_KEY_FREE_FORM) != null
//				&& !params.get(QUERY_KEY_FREE_FORM).equals("")){
//			cond+=" and a.v_freeTypeid = ? ";
//			condValue+= params.get(QUERY_KEY_FREE_FORM)+","; 
//		}
//		//高级查询写在此处
//		if(params.get(QUERY_KEY_ADVANCED_SEARCH_OBJ) != null){
//			
//			AdvancedSearchBean bean = (AdvancedSearchBean)params.get(QUERY_KEY_ADVANCED_SEARCH_OBJ);
//			
//			//按照并且与或者两大类处理
//			
//			//对八种条件一一处理
//			//1.关键字
//			if(bean.getName()!=null && bean.getName().length()>0){
//				
//				if(bean.getParaNum()<2){
//					cond+=" and ";
//				}
//				else{
//					if(bean.getIsAndName().equals("0")){
//						cond+=" and ";						
//					}else{
//						cond+=" or ";
//					}
//				}
//				cond+=" ( a.v_code like ? or a.v_name like ?  or a.v_gender=? or a.v_cardid like ?) ";
//				condValue+="%" + bean.getName() + "%" + ","+"%" + bean.getName() + "%" 
//						+ "," + bean.getName() + ","+"%" + bean.getName() + "%" + ",";
//			}
//			
//			if(bean.getXstuTypeid()!=null && bean.getXstuTypeid().length()>0){
//				if(bean.getParaNum()<2){
//					cond+=" and ";
//				}else{
//					if(bean.getIsAndStuType().equals("0")){
//						cond+=" and ";	
//						
//					}else{
//						cond+=" or "; 
//					}
//				}
//				cond+=" ? like '%'+ a.v_stuTypeid + '%' ";//高招，翻过来用
//				condValue+=bean.getXstuTypeid().replaceAll(",", "")+",";
//			}
//			
//			//3.公司
//			if(bean.getXcompanyid()!=null && bean.getXcompanyid().length()>0){
//				if(bean.getParaNum()<2){
//					cond+=" and ";
//				}else{
//					if(bean.getIsAndCompany().equals("0")){
//						cond+=" and ";
//						
//					}else{
//						cond+=" or "; 
//					}
//				}
//				cond+=" ? like '%'+ a.v_companyid + '%' ";
//				condValue+=bean.getXcompanyid().replaceAll(",", "")+",";
//			}
//			
//			//4.学生状态
//
//			if(bean.getXstatusid()!=null && bean.getXstatusid().length()>0){
//				if(bean.getParaNum()<2){
//					cond+=" and ";
//				}else{
//					if(bean.getIsAndStatus().equals("0")){
//						cond+=" and ";
//						
//					}else{
//						cond+=" or "; 
//					}
//				}
//				cond+=" ? like '%'+ a.v_stuStatusid + '%' ";
//				condValue+=bean.getXstatusid().replaceAll(",", "")+",";
//			}
//			
//			//5.学籍状态
//
//			if(bean.getXxjstatusid()!=null && bean.getXxjstatusid().length()>0){
//				if(bean.getParaNum()<2){
//					cond+=" and ";
//				}else{
//					if(bean.getIsAndXjStatus().equals("0")){
//						cond+=" and ";
//					}else{
//						cond+=" or "; 
//					}
//				}
//				cond+=" ? like '%'+ a.v_xjStatusid + '%' ";
//				condValue+=bean.getXxjstatusid().replaceAll(",", "")+",";
//			}
//			//6.招生形式
//
//			if(bean.getXformid()!=null && bean.getXformid().length()>0){
//				if(bean.getParaNum()<2){
//					cond+=" and ";
//				}else{
//					if(bean.getIsAndForm().equals("0")){
//						cond+=" and ";
//						
//					}else{
//						cond+=" or "; 
//					}
//				}
//				cond+=" ? like '%'+ a.v_formid + '%' "; 
//				condValue+=bean.getXformid().replaceAll(",", "")+",";
//			}
//			//7.费用形式
//
//			if(bean.getXfreetypeid()!=null && bean.getXfreetypeid().length()>0){
//				if(bean.getParaNum()<2){
//					cond+=" and ";
//				}else{
//					if(bean.getIsAndFreeType().equals("0")){
//						cond+=" and ";
//						
//					}else{
//						cond+=" or "; 
//					}
//				}
//				cond+=" ? like '%'+ a.v_freeTypeid + '%' ";
//				condValue+=bean.getXfreetypeid().replaceAll(",", "")+",";
//			}
//			//8.是否分配
//			/*
//			if(bean.getIsAssignid()!=null && bean.getIsAssignid().length()>0 && bean.getIsAssignid().length()<4){//2,3, 表示全选
//				
//				if(bean.getIsAndAssign().equals("0")){
//					cond+=" and ";
//				}else{
//					cond+=" or ";
//				}
//				
//				if(bean.getIsAssignid().indexOf("2")!=-1){
//					cond+=" isnull(b.v_outlineid,'')=''";
//				}else if(bean.getIsAssignid().indexOf("3")!=-1){
//					cond+=" isnull(b.v_outlineid,'')<>''";
//				}
//			}
//			*/
//		}
//		String[] back = new String[2];
//		back[0]= cond;
//		back[1] = condValue;
//		return back;
//	}
//	@SuppressWarnings("unchecked")
//	public Page readStudentList(Map<String, Object> params, String pageNo)throws FinanceServiceException {
//		try {
//			
//			int pageSize = FinanceConfig.getIntProperty("default.system.pagesize");
//			
//			String[] back = getCondValue(params);
//			
//			//更多查询
//			if(params.get(QUERY_KEY_IF_ASSIGN) != null
//					&& !params.get(QUERY_KEY_IF_ASSIGN).equals("1")){
//
//				if(params.get(QUERY_KEY_IF_ASSIGN).equals("4")){
//					back[0]+=" and a.v_gender='男'";
//				}else if(params.get(QUERY_KEY_IF_ASSIGN).equals("5")){
//					back[0]+=" and a.v_gender='女'";
//				}else{
//					back[0]+="";
//				}
//			}
//			
//			String sql =getSql(back[0],0);
//
//			Integer pageIndex = Integer.parseInt(pageNo);
//
//			Page page;
//			if(back[1].equals("")){
//				page = this.pagedSQLQuery(sql, pageIndex, pageSize);
//			}else{
//				page = this.pagedSQLQuery(sql, pageIndex, pageSize,(Object[])back[1].split(","));
//			}
//			List<VStudentBaseInfo> vlist = new ArrayList<VStudentBaseInfo>();
//			VStudentBaseInfo vs;
//			
//			List<Object[]> olist = page.getResult();
//			
//			for(Object[] obj:olist){
//				vs = new VStudentBaseInfo();
//				vs.setVId(obj[0].toString());
//				vs.setVCode(obj[1].toString());
//				vs.setVName(obj[2].toString());
//				vs.setVGender(obj[3].toString());
//				
//				vs.setStuTypeName(obj[4].toString());
//				vs.setCompanyName(obj[5].toString());
//				vs.setStuStatusName(obj[6].toString());
//				
//				vs.setXjStatusName(obj[7].toString());
//				vs.setFormName(obj[8].toString());
//				vs.setFreeTypeName(obj[9].toString());
//				vs.setVClassNoid(obj[10].toString());
//				vs.setVCardid(obj[11].toString());
//				vs.setJg(obj[12].toString());
//				vs.setLxfs(obj[13].toString());
//				vs.setJtzz(obj[14].toString());
//				
//				vs.setNation(obj[15].toString());
//				vs.setWhcd(obj[16].toString());
//				vs.setZzmm(obj[17].toString());
//				vs.setByyx(obj[18].toString());
//				vs.setEnLevel(obj[19].toString());
//				vs.setZy(obj[20].toString());
//				vs.setXlxz(obj[21].toString());
//				vs.setXxlx(obj[22].toString());
//				vlist.add(vs);
//			}
//			
//			page.setData(vlist);
//			
//			return page;
//		}catch(HibernateException e){
//			log.error("获取学生列表失败", e);
//			throw new FinanceServiceException("获取学生列表失败。", e);
//		}
//	}
//
//
//	public Page readMoreSeacrhStudentBaseInfoList(StudentBaseInfo stu, String pageNo)throws FinanceServiceException {
//		try {
//			int pageSize = FinanceConfig.getIntProperty("default.system.pagesize");
//			Integer pageIndex = Integer.parseInt(pageNo);
//			String hql =" from StudentBaseInfo where 1=1"+getCondition(stu) + " order by VCode,DCreatedate desc,VId desc";
//			//System.out.println(hql);
//			Page page = this.pagedQuery(hql,pageIndex,pageSize);
//			return page;
//		}catch(HibernateException e){
//			log.error("获取学生列表失败", e);
//			throw new FinanceServiceException("获取学生列表失败。", e);
//		}catch(Exception e){
//			log.error("获取学生列表失败", e);
//			throw new FinanceServiceException("获取学生列表失败。", e);
//		}
//	}
//	
//	@SuppressWarnings("unchecked")
//	public List<StudentBaseInfo> exportStudentBaseInfo(StudentBaseInfo stu) throws FinanceServiceException {
//		try {
//		
//			String hql =" from StudentBaseInfo where 1=1"+getCondition(stu) + " order by VCode,DCreatedate desc,VId desc";
//			return super.find(hql);
//		}catch(HibernateException e){
//			log.error("获取学生列表失败", e);
//			throw new FinanceServiceException("获取学生列表失败。", e);
//		}catch(Exception e){
//			log.error("获取学生列表失败", e);
//			throw new FinanceServiceException("获取学生列表失败。", e);
//		}
//	}
//	private String getCondition(StudentBaseInfo stu){
//		String cond = "";
//		//组装条件开始-------------------------------------------------------
//		if(stu!=null){
//
//			if(stu.getVName()!=null && !stu.getVName().equals("")){
//				cond+=" and VName like '%"+stu.getVName()+"%'";
//			}
//			if(stu.getVGender()!=null && !stu.getVGender().equals("")){
//				cond+=" and VGender='"+stu.getVGender()+"'";
//			}
//			if(stu.getVCardid()!=null && !stu.getVCardid().equals("")){
//				cond+=" and VCardid='"+stu.getVCardid()+"'";
//			}
//			if(stu.getDBirthday()!=null && !stu.getDBirthday().equals("")){
//				cond+=" and DBirthday='"+Utilities.format(stu.getDBirthday())+"'";
//			}
//			
//			if(stu.getTDictionByVStuTypeid().getVId()!=null && !stu.getTDictionByVStuTypeid().getVId().equals("")){
//				cond+=" and TDictionByVStuTypeid.VId='"+stu.getTDictionByVStuTypeid().getVId()+"'";
//			}
//			if(stu.getVCode()!=null && !stu.getVCode().equals("")){
//				cond+=" and VCode='"+stu.getVCode()+"'";
//			}
//			if(stu.getVClassNoid()!=null && !stu.getVClassNoid().equals("")){
//				cond+=" and VClassNoid='"+stu.getVClassNoid()+"'";
//			}
//			if(stu.getVSyd()!=null && !stu.getVSyd().equals("")){
//				cond+=" and VSyd like '%"+stu.getVSyd()+"%'";
//			}
//			
//			if(stu.getDRxsj()!=null && !stu.getDRxsj().equals("")){
//				cond+=" and DRxsj='" +Utilities.format(stu.getDRxsj())+"'";
//			}
//			if(stu.getDLxsj()!=null && !stu.getDLxsj().equals("")){
//				cond+=" and DLxsj='" +Utilities.format(stu.getDLxsj())+"'";
//			}
//			if(stu.getTDictionByVStuStatusid().getVId()!=null && !stu.getTDictionByVStuStatusid().getVId().equals("")){
//				cond+=" and TDictionByVStuStatusid.VId='"+stu.getTDictionByVStuStatusid().getVId()+"'";
//			}
//			if(stu.getVLxfs()!=null && !stu.getVLxfs().equals("")){
//				cond+=" and VLxfs like '%"+stu.getVLxfs()+"%'";
//			}
//			
//			if(stu.getTDictionByVFormid().getVId()!=null && !stu.getTDictionByVFormid().getVId().equals("")){
//				cond+=" and TDictionByVFormid.VId='"+stu.getTDictionByVFormid().getVId()+"'";
//			}
//			if(stu.getTDictionByVFreeTypeid().getVId()!=null && !stu.getTDictionByVFreeTypeid().getVId().equals("")){
//				cond+=" and TDictionByVFreeTypeid.VId='"+stu.getTDictionByVFreeTypeid().getVId()+"'";
//			}
//			if(stu.getTDictionByVXjStatusid().getVId()!=null && !stu.getTDictionByVXjStatusid().getVId().equals("")){
//				cond+=" and TDictionByVXjStatusid.VId='"+stu.getTDictionByVXjStatusid().getVId()+"'";
//			}
//			if(stu.getVByyx()!=null && !stu.getVByyx().equals("")){
//				cond+=" and VByyx like '%"+stu.getVByyx()+"%'";
//			}
//			
//			if(stu.getTOrg().getVId()!=null && !stu.getTOrg().getVId().equals("")){
//				cond+=" and TOrg.VId='"+stu.getTOrg().getVId()+"'";
//			}
//			if(stu.getVZzmm()!=null && !stu.getVZzmm().equals("")){
//				cond+=" and VZzmm='"+stu.getVZzmm()+"'";
//			}
//			if(stu.getTDictionByVNationid().getVId()!=null && !stu.getTDictionByVNationid().getVId().equals("")){
//				cond+=" and TDictionByVNationid.VId='"+stu.getTDictionByVNationid().getVId()+"'";
//			}
//			if(stu.getVJtzz()!=null && !stu.getVJtzz().equals("")){
//				cond+=" and VJtzz like '%"+stu.getVJtzz()+"%'";
//			}
//			
//			if(stu.getTDictionByVWhcd().getVId()!=null && !stu.getTDictionByVWhcd().getVId().equals("")){
//				cond+=" and TDictionByVWhcd.VId='"+stu.getTDictionByVWhcd().getVId()+"'";
//			}
//			if(stu.getVEnlevel()!=null && !stu.getVEnlevel().equals("")){
//				cond+=" and VEnlevel='"+stu.getVEnlevel()+"'";
//			}
//			if(stu.getVJg()!=null && !stu.getVJg().equals("")){
//				cond+=" and VJg='"+stu.getVJg()+"'";
//			}
//			if(stu.getVZy()!=null && !stu.getVZy().equals("")){
//				cond+=" and VZy like '%"+stu.getVZy()+"%'";
//			}
//			
//		}
//		return cond;
//	}
//	@SuppressWarnings("unchecked")
//	public Page readStudentBaseList(Map<String, Object> params, String pageNo)throws FinanceServiceException {
//		try {
//			
//			int pageSize = FinanceConfig.getIntProperty("default.system.pagesize");
//			
//			String[] back = getCondValue(params);
//			//back[0]= cond;
//			//back[1] = condValue;
//			//更多查询
//			if(params.get(QUERY_KEY_IF_ASSIGN) != null
//					&& !params.get(QUERY_KEY_IF_ASSIGN).equals("1")){
//				if(params.get(QUERY_KEY_IF_ASSIGN).equals("4")){
//					back[0]+=" and isnull(i.v_name,'')<>''";
//				}else if(params.get(QUERY_KEY_IF_ASSIGN).equals("5")){
//					back[0]+=" and isnull(i.v_name,'')=''";
//				}else if(params.get(QUERY_KEY_IF_ASSIGN).equals("7")){
//					back[0]+=" and i.v_id='4028816a470e3d6601470e47174b0003'";//朝阳
//				}else if(params.get(QUERY_KEY_IF_ASSIGN).equals("8")){
//					back[0]+=" and i.v_id='4028816a470e3d6601470e473afa0004'";//呼伦贝尔
//				}else{
//					back[0]+="";
//				}
//			}
//			back[0]+=" and isnull(assign.v_outlineid,'')<>''";
//			String sql =getSql(back[0],2);
//			Integer pageIndex = Integer.parseInt(pageNo);
//
//			Page page;
//			if(back[1].equals("")){
//				page = this.pagedSQLQuery(sql, pageIndex, pageSize);
//			}else{
//				page = this.pagedSQLQuery(sql, pageIndex, pageSize,(Object[])back[1].split(","));
//			}
//			List<VStudentBaseInfo> vlist = new ArrayList<VStudentBaseInfo>();
//			VStudentBaseInfo vs;
//			
//			List<Object[]> olist = page.getResult();
//			
//			for(Object[] obj:olist){
//				vs = new VStudentBaseInfo();
//				vs.setVId(obj[0].toString());
//				vs.setVCode(obj[1].toString());
//				vs.setVName(obj[2].toString());
//				vs.setVGender(obj[3].toString());
//				
//				vs.setStuTypeName(obj[4].toString());
//				vs.setCompanyName(obj[5].toString());
//				vs.setStuStatusName(obj[6].toString());
//				
//				vs.setXjStatusName(obj[7].toString());
//				vs.setFormName(obj[8].toString());
//				vs.setFreeTypeName(obj[9].toString());
//				vs.setOutlineName(obj[10].toString());//基地名称
//				vs.setOutlineid(obj[11].toString());//大纲名称
//
//				vlist.add(vs);
//			}
//			
//			page.setData(vlist);
//			
//			return page;
//		}catch(HibernateException e){
//			log.error("获取学生列表失败", e);
//			throw new FinanceServiceException("获取学生列表失败。", e);
//		}
//	}
//	
//	@SuppressWarnings("unchecked")
//	public Page readStudentGroupList(Map<String, Object> params, String pageNo)throws FinanceServiceException {
//		try {
//			
//			int pageSize = FinanceConfig.getIntProperty("default.system.pagesize");
//			
//			String[] back = getCondValue(params);
//			
//			back[0]+=" and isnull(i.v_name,'')<>''";//已有基地
//			//back[0]= cond;
//			//back[1] = condValue;
//			//更多查询
//			
//			if(params.get(QUERY_KEY_IF_ASSIGN) != null
//					&& !params.get(QUERY_KEY_IF_ASSIGN).equals("1") && !params.get(QUERY_KEY_IF_ASSIGN).equals("6")){
//				
//				back[0]+=" and ii.v_id='"+params.get(QUERY_KEY_IF_ASSIGN)+"'";
//			}
//
//			if(params.get(QUERY_KEY_LOGIN_USER) != null
//					&& !params.get(QUERY_KEY_LOGIN_USER).equals("")){
//				String hql = " from TOtheruser where VCode=?";
//				List<TOtheruser> olist = super.find(hql, params.get(QUERY_KEY_LOGIN_USER));
//				if(olist.size()>0){
//					TOtheruser other = olist.get(0);
//					back[0]+=" and i.v_id='"+other.getTOrg().getVParentid()+"'";
//				}
//				
//			}
//
//			String sql =getSql(back[0],3);
//			Integer pageIndex = Integer.parseInt(pageNo);
//
//			Page page;
//			if(back[1].equals("")){
//				page = this.pagedSQLQuery(sql, pageIndex, pageSize);
//			}else{
//				page = this.pagedSQLQuery(sql, pageIndex, pageSize,(Object[])back[1].split(","));
//			}
//			List<VStudentBaseInfo> vlist = new ArrayList<VStudentBaseInfo>();
//			VStudentBaseInfo vs;
//			
//			List<Object[]> olist = page.getResult();
//			
//			for(Object[] obj:olist){
//				vs = new VStudentBaseInfo();
//				vs.setVId(obj[0].toString());
//				vs.setVCode(obj[1].toString());
//				vs.setVName(obj[2].toString());
//				vs.setVGender(obj[3].toString());
//				
//				vs.setStuTypeName(obj[4].toString());
//				vs.setCompanyName(obj[5].toString());
//				vs.setStuStatusName(obj[6].toString());
//				
//				vs.setXjStatusName(obj[7].toString());
//				vs.setFormName(obj[8].toString());
//				vs.setFreeTypeName(obj[9].toString());
//				vs.setOutlineName(obj[10].toString());//基地名称
//				vs.setByyx(obj[11].toString());//大队名称
//				vlist.add(vs);
//			}
//			
//			page.setData(vlist);
//			
//			return page;
//		}catch(HibernateException e){
//			log.error("获取学生列表失败", e);
//			throw new FinanceServiceException("获取学生列表失败。", e);
//		}
//	}
//	
//	@SuppressWarnings("unchecked")
//	public Page readStudentTeacherList(Map<String, Object> params, String pageNo)throws FinanceServiceException {
//		try {
//			
//			int pageSize = FinanceConfig.getIntProperty("default.system.pagesize");
//			
//			String[] back = getCondValue(params);
//			
//			back[0]+=" and isnull(ii.v_name,'')<>''";//已有大队
//			//back[0]= cond;
//			//back[1] = condValue;
//			//更多查询
//			
//			if(params.get(QUERY_KEY_IF_ASSIGN) != null
//					&& !params.get(QUERY_KEY_IF_ASSIGN).equals("1") && !params.get(QUERY_KEY_IF_ASSIGN).equals("6")){
//				
//				back[0]+=" and iii.v_id='"+params.get(QUERY_KEY_IF_ASSIGN)+"'";
//			}
//
//			if(params.get(QUERY_KEY_LOGIN_USER) != null
//					&& !params.get(QUERY_KEY_LOGIN_USER).equals("")){
//				String hql = " from TeacherBaseInfo where VCode=?";
//				List<TeacherBaseInfo> olist = super.find(hql, params.get(QUERY_KEY_LOGIN_USER));
//				if(olist.size()>0){
//					TeacherBaseInfo other = olist.get(0);
//					back[0]+=" and ii.v_id='"+other.getTOrg().getVId()+"'";
//				}
//				
//			}
//
//			String sql =getSql(back[0],4);
//			Integer pageIndex = Integer.parseInt(pageNo);
//
//			Page page;
//			if(back[1].equals("")){
//				page = this.pagedSQLQuery(sql, pageIndex, pageSize);
//			}else{
//				page = this.pagedSQLQuery(sql, pageIndex, pageSize,(Object[])back[1].split(","));
//			}
//			List<VStudentBaseInfo> vlist = new ArrayList<VStudentBaseInfo>();
//			VStudentBaseInfo vs;
//			
//			List<Object[]> olist = page.getResult();
//			
//			for(Object[] obj:olist){
//				vs = new VStudentBaseInfo();
//				vs.setVId(obj[0].toString());
//				vs.setVCode(obj[1].toString());
//				vs.setVName(obj[2].toString());
//				vs.setVGender(obj[3].toString());
//				
//				vs.setStuTypeName(obj[4].toString());
//				vs.setCompanyName(obj[5].toString());
//				vs.setStuStatusName(obj[6].toString());
//				
//				vs.setXjStatusName(obj[7].toString());
//				vs.setFormName(obj[8].toString());
//				vs.setFreeTypeName(obj[9].toString());
//				vs.setOutlineName(obj[10].toString());//基地名称
//				vs.setByyx(obj[11].toString());//大队名称
//				vs.setZy(obj[12].toString());//教员名称
//				vlist.add(vs);
//			}
//			
//			page.setData(vlist);
//			
//			return page;
//		}catch(HibernateException e){
//			log.error("获取学生列表失败", e);
//			throw new FinanceServiceException("获取学生列表失败。", e);
//		}
//	}
//	
//	@SuppressWarnings("unchecked")
//	public Page readStudentInterviewList(Map<String, Object> params, String pageNo)throws FinanceServiceException {
//		try {
//			
//			int pageSize = FinanceConfig.getIntProperty("default.system.pagesize");
//			pageSize =20;
//			String[] back = getCondValue(params);
//			
//			//back[0]= cond;
//			//back[1] = condValue;
//			//更多查询
//			
//			if(params.get(QUERY_KEY_IF_ASSIGN) != null
//					&& !params.get(QUERY_KEY_IF_ASSIGN).equals("1") && !params.get(QUERY_KEY_IF_ASSIGN).equals("6")){
//				
//				
//					if(params.get(QUERY_KEY_IF_ASSIGN).equals("4")){//已分派航校
//						back[0]+=" and a.v_id in (select v_stuid from studentassignschool)";
//						
//						
//					}else if(params.get(QUERY_KEY_IF_ASSIGN).equals("5")){//未分派航校
//						back[0]+=" and a.v_id not in (select v_stuid from studentassignschool)";
//					}else{
//						back[0]+="";
//					}
//	
//			}
//			if(params.get("schoolid") != null
//					&& !params.get("schoolid").equals("")){
//				back[0]+=" and a.v_id in (select v_stuid from studentassignschool where v_school='"+params.get("schoolid")+"')";
//				//System.out.println(back[0]);
//			}
//			//国外送培阶段与国外训练
//			back[0]+=" and ( a.v_stuStatusid = '"+QUERY_KEY_STUDENT_STATUS_GUOWAI+"' or a.v_stuStatusid='"+QUERY_KEY_STUDENT_STATUS_GW_SONGPEI+"')";
//			String sql =getSql(back[0],1);
//			Integer pageIndex = Integer.parseInt(pageNo);
//
//			Page page;
//			if(back[1].equals("")){
//				page = this.pagedSQLQuery(sql, pageIndex, pageSize);
//			}else{
//				page = this.pagedSQLQuery(sql, pageIndex, pageSize,(Object[])back[1].split(","));
//			}
//			List<Vforeignaviationschoolinterview> vlist = new ArrayList<Vforeignaviationschoolinterview>();
//			Vforeignaviationschoolinterview vs;
//			
//			List<Object[]> olist = page.getResult();
//			
//			String hql =" from Studentassignschool where studentBaseInfo.VId=? order by DCreatedate desc";
//			String viewHql = " from TForeignaviationschoolinterview where " +
//					"studentassignschool.studentBaseInfo.VId=? order by DAuditiontime desc";
//			String trainingHql =" from TAbroadtrain where studentassignschool.studentBaseInfo.VId=? order by DCreatedate desc";
//			for(Object[] obj:olist){
//				vs = new Vforeignaviationschoolinterview();
//				vs.setVId(obj[0].toString());
//				vs.setVCode(obj[1].toString());
//				vs.setVName(obj[2].toString());
//				vs.setSchoolList(super.find(hql, obj[0].toString()));
//				vs.setViewList(super.find(viewHql, obj[0].toString()));
//				vs.setTrainingList(super.find(trainingHql, obj[0].toString()));
//				
//				vlist.add(vs);
//			}
//			
//			page.setData(vlist);
//			
//			return page;
//		}catch(HibernateException e){
//			log.error("获取学生列表失败", e);
//			throw new FinanceServiceException("获取学生列表失败。", e);
//		}
//	}
//	
//	@SuppressWarnings("unchecked")
//	public Page readStudentMedicalList(Map<String, Object> params, String pageNo)throws FinanceServiceException {
//		try {
//			
//			int pageSize = FinanceConfig.getIntProperty("default.system.pagesize");
//			
//			String[] back = getCondValue(params);
//			
//			//back[0]= cond;
//			//back[1] = condValue;
//			//更多查询
//			
//			if(params.get(QUERY_KEY_IF_ASSIGN) != null
//					&& !params.get(QUERY_KEY_IF_ASSIGN).equals("1") && !params.get(QUERY_KEY_IF_ASSIGN).equals("6")){
//				
//				
//					if(params.get(QUERY_KEY_IF_ASSIGN).equals("4")){//有合格证
//						back[0]+=" and a.v_id in (select v_stuid from t_stuMedical)";
//						
//						
//					}else if(params.get(QUERY_KEY_IF_ASSIGN).equals("5")){//无合格证
//						back[0]+=" and a.v_id not in (select v_stuid from t_stuMedical)";
//					}else{
//						back[0]+="";
//					}
//	
//			}
//
//			String sql =getSql(back[0],9);
//			Integer pageIndex = Integer.parseInt(pageNo);
//
//			Page page;
//			if(back[1].equals("")){
//				page = this.pagedSQLQuery(sql, pageIndex, pageSize);
//			}else{
//				page = this.pagedSQLQuery(sql, pageIndex, pageSize,(Object[])back[1].split(","));
//			}
//			List<VStudentBaseInfo> vlist = new ArrayList<VStudentBaseInfo>();
//			VStudentBaseInfo vs;
//			
//			List<Object[]> olist = page.getResult();
//			
//			String hql =" from TStuMedical where studentBaseInfo.VId=? order by DCreateDate desc";
//			
//			List<TStuMedical> mlist;
//			
//			TStuMedical m;
//			Date birth;
//			long l1 = 0;
//			long l2 = 0;
//			long dd = 0;
//			for(Object[] obj:olist){
//				vs = new VStudentBaseInfo();
//				vs.setVId(obj[0].toString());
//				vs.setVCode(obj[1].toString());
//				vs.setVName(obj[2].toString());
//				vs.setVGender(obj[3].toString());
//
//				mlist = super.find(hql, obj[0].toString());
//				
//				if(mlist.size()>0){
//					m = mlist.get(0);
//					if(m.getILevel()==0){
//						vs.setEnLevel("Ⅰ级体检合格证");
//					}else if(m.getILevel()==1){
//						vs.setEnLevel("Ⅰ级体检合格证(限91部运行)");
//					}else{
//						vs.setEnLevel("Ⅱ级体检合格证");
//					}
//					vs.setStuTypeName(Utilities.format(m.getDResultdate()));
//					vs.setCompanyName(Utilities.format(m.getDIssueTime()));
//					vs.setStuStatusName(Utilities.format(m.getDUsedTime()));
//					vs.setXjStatusName(m.getVDoctor());
//					vs.setFormName(m.getVIssuer());
//				}
//				
//				if(obj[10]!=null){
//					birth = (Date)obj[10];
//					l1 = birth.getTime();
//					l2 = new Date().getTime();
//					dd = (l2-l1)/1000/3600/24/365;//岁数
//					vs.setXxlx(String.valueOf(dd));
//						
//				}else{
//					vs.setXxlx("");
//				}
//				vlist.add(vs);
//			}
//			
//			page.setData(vlist);
//			
//			return page;
//		}catch(HibernateException e){
//			log.error("获取学生列表失败", e);
//			throw new FinanceServiceException("获取学生列表失败。", e);
//		}
//	}
//	@SuppressWarnings("unchecked")
//	public Page readFinishTrainingStudentList(Map<String, Object> params, String pageNo)throws FinanceServiceException {
//		try {
//			
//			int pageSize = FinanceConfig.getIntProperty("default.system.pagesize");
//			
//			String[] back = getCondValue(params);
//			
//			if(params.get(QUERY_KEY_IF_ASSIGN) != null
//					&& !params.get(QUERY_KEY_IF_ASSIGN).equals("1") && !params.get(QUERY_KEY_IF_ASSIGN).equals("6")){
//				
//					if(params.get(QUERY_KEY_IF_ASSIGN).equals("4")){//完成训练
//						back[0]+=" and a.v_id in (select v_stuid from t_gntrainbackschool where i_type=0)";
//						
//					}else if(params.get(QUERY_KEY_IF_ASSIGN).equals("5")){//停飞
//						back[0]+=" and a.v_id in (select v_stuid from t_stustopfly)";
//					}else{
//						back[0]+="";
//					}
//	
//			}
//			back[0]+=" and ( a.v_stuStatusid = '"+QUERY_KEY_STUDENT_STATUS_GUONEI
//			+"' or  a.v_stuStatusid = '"+QUERY_KEY_STUDENT_STATUS_GUOWAI+"'"+
//			" or  a.v_stuStatusid = '4028aa494765f33d014765f85a400014') ";//停飞离校
//			
//			back[0]+=" and a.v_id not in (select v_stuid from t_offschool) ";
//			
//			String sql =getSql(back[0],5);
//			Integer pageIndex = Integer.parseInt(pageNo);
//
//			Page page;
//			if(back[1].equals("")){
//				page = this.pagedSQLQuery(sql, pageIndex, pageSize);
//			}else{
//				page = this.pagedSQLQuery(sql, pageIndex, pageSize,(Object[])back[1].split(","));
//			}
//			List<VStudentBaseInfo> vlist = new ArrayList<VStudentBaseInfo>();
//			VStudentBaseInfo vs;
//			
//			List<Object[]> olist = page.getResult();
//			
//			for(Object[] obj:olist){
//				vs = new VStudentBaseInfo();
//				
//				vs.setVId(obj[0].toString());
//				vs.setVCode(obj[1].toString());
//				vs.setVName(obj[2].toString());
//				vs.setVGender(obj[3].toString());
//				
//				vs.setStuTypeName(obj[4].toString());
//				vs.setCompanyName(obj[5].toString());
//				vs.setStuStatusName(obj[6].toString());
//				vs.setXjStatusName(obj[7].toString());
//				vs.setFormName(obj[8].toString());
//				vs.setFreeTypeName(obj[9].toString());
//				if(obj[10]==null){
//					vs.setCreateTime("");
//				}else{
//					vs.setCreateTime(Utilities.format((Date)obj[10]));
//				}
//				if(obj[11]==null){
//					vs.setXxlx("");
//				}else{
//					vs.setXxlx(Utilities.format((Date)obj[11]));
//				}
//				vlist.add(vs);
//			}
//			
//			page.setData(vlist);
//			
//			return page;
//		}catch(HibernateException e){
//			log.error("获取学生列表失败", e);
//			throw new FinanceServiceException("获取学生列表失败。", e);
//		}
//	}
//	@SuppressWarnings("unchecked")
//	public Page readStudentGraduationList(Map<String, Object> params, String pageNo)throws FinanceServiceException {
//		try {
//			
//			int pageSize = FinanceConfig.getIntProperty("default.system.pagesize");
//			
//			String[] back = getCondValue(params);
//			
//			if(params.get(QUERY_KEY_IF_ASSIGN) != null
//					&& !params.get(QUERY_KEY_IF_ASSIGN).equals("1") && !params.get(QUERY_KEY_IF_ASSIGN).equals("6")){
//				
//				
//					if(params.get(QUERY_KEY_IF_ASSIGN).equals("4")){//证齐
//						back[0]+=" and score.ishg=1";
//						
//					}else if(params.get(QUERY_KEY_IF_ASSIGN).equals("5")){//毕业设计合格
//						back[0]+=" and tc.i_checkResult=0";
//					}else if(params.get(QUERY_KEY_IF_ASSIGN).equals("7")){//领毕业证
//						back[0]+=" and td.i_checkResult=0";
//					}else if(params.get(QUERY_KEY_IF_ASSIGN).equals("8")){//满足毕业条件
//						back[0]+=" and tc.i_checkResult=0 and td.i_checkResult=0";
//						back[0]+=" and score.ishg=1";
//					}else if(params.get(QUERY_KEY_IF_ASSIGN).equals("9")){//毕业已分配
//						back[0]+=" and tg.v_id is not null";
//					}else if(params.get(QUERY_KEY_IF_ASSIGN).equals("10")){//毕业未分配
//						back[0]+="and tg.v_id is null";
//					}else{
//						back[0]+="";
//					}
//					
//	
//			}
//			back[0]+=" and ( a.v_stuStatusid = '"+QUERY_KEY_STUDENT_STATUS_FINISH +
//				"' or a.v_stuStatusid = '"+QUERY_KEY_STUDENT_STATUS_OFF_SCHOOL+"')";
//			String sql =getSql(back[0],6);
//			//System.out.println(sql);
//			Integer pageIndex = Integer.parseInt(pageNo);
//
//			Page page;
//			if(back[1].equals("")){
//				page = this.pagedSQLQuery(sql, pageIndex, pageSize);
//			}else{
//				page = this.pagedSQLQuery(sql, pageIndex, pageSize,(Object[])back[1].split(","));
//			}
//			List<VStudentBaseInfo> vlist = new ArrayList<VStudentBaseInfo>();
//			VStudentBaseInfo vs;
//			
//			List<Object[]> olist = page.getResult();
//			
//			for(Object[] obj:olist){
//				vs = new VStudentBaseInfo();
//				
//				vs.setVId(obj[0].toString());
//				vs.setVCode(obj[1].toString());
//				vs.setVName(obj[2].toString());
//				vs.setVGender(obj[3].toString());
//				vs.setCompanyName(obj[5].toString());
//				vs.setStuStatusName(obj[6].toString());
//				vs.setOutlineid(obj[10].toString());
//				
//				if(obj[11]!=null && !obj[11].equals("")){
//					vs.setByyx(obj[11].toString());//毕设结果
//				}else{
//					vs.setByyx("");//毕设结果
//				}
//				
//				if(obj[12]!=null && !obj[12].equals("")){//毕设确认日期
//					vs.setZy(Utilities.format((Date)obj[12]));
//				}else{
//					vs.setZy("");
//				}
//				
//				if(obj[13]!=null && !obj[13].equals("")){//领毕业证
//					vs.setSyd(obj[13].toString());
//				}else{
//					vs.setSyd("");
//				}
//				if(obj[14]!=null && !obj[14].equals("")){//领毕业证日期
//					vs.setJtzz(Utilities.format((Date)obj[14]));
//				}else{
//					vs.setJtzz("");
//				}
//				
//				if(obj[15]!=null && !obj[15].equals("")){//新雇成绩
//					vs.setXlxz(Utilities.getXxje(Double.parseDouble(obj[15].toString())));
//				}else{
//					vs.setXlxz("");
//				}
//				if(obj[16]!=null && !obj[16].equals("")){//改装成绩
//					vs.setXxlx(Utilities.getXxje(Double.parseDouble(obj[16].toString())));
//				}else{
//					vs.setXxlx("");
//				}
//				
//				if(obj[17]!=null && !obj[17].equals("")){
//					vs.setJg("0");
//				}else{
//					vs.setJg("1");
//				}
//				if(obj[18]!=null && !obj[18].equals("")){
//					vs.setVSyd("0");
//				}else{
//					vs.setVSyd("1");
//				}
//				vlist.add(vs);
//
//			}
//			
//			page.setData(vlist);
//			
//			return page;
//		}catch(HibernateException e){
//			log.error("获取学生列表失败", e);
//			throw new FinanceServiceException("获取学生列表失败。", e);
//		}
//	}
//	
//	@SuppressWarnings("unchecked")
//	public Page readStudentScoreList(Map<String, Object> params, String pageNo)throws FinanceServiceException {
//		try {
//			
//			int type = Integer.parseInt(params.get(QUERY_KEY_LESSON_TYPE).toString());
//			
//			int pageSize = FinanceConfig.getIntProperty("default.system.pagesize");
//			
//			String[] back = getCondValue(params);
//			String classid = "";
//			if(params.get(QUERY_KEY_IF_ASSIGN) != null
//					&& !params.get(QUERY_KEY_IF_ASSIGN).equals("1") && !params.get(QUERY_KEY_IF_ASSIGN).equals("6")){
//				
//				
//					if(params.get(QUERY_KEY_IF_ASSIGN).equals("4")){//有补考
//						back[0]+=" and  a.v_id in (select V_stuid from t_score where i_times>1" +
//								" and v_lessonid in (select v_id from t_lesson where i_type="+type+"))";
//						
//					}else if(params.get(QUERY_KEY_IF_ASSIGN).equals("5")){//无补考
//						back[0]+=" and  a.v_id in (select V_stuid from t_score where i_times<=1 " +
//								"and v_lessonid in (select v_id from t_lesson where i_type="+type+"))";
//					}/*else if(params.get(QUERY_KEY_IF_ASSIGN).equals("7")){//审批通过
//						back[0]+=" and td.i_checkResult=0";
//					}else if(params.get(QUERY_KEY_IF_ASSIGN).equals("8")){//未提交审批
//						back[0]+=" and tc.i_checkResult=0 and td.i_checkResult=0";
//					}else if(params.get(QUERY_KEY_IF_ASSIGN).equals("9")){//待审批
//						back[0]+=" and tg.v_id is not null";
//					}else if(params.get(QUERY_KEY_IF_ASSIGN).equals("10")){//审批未通过
//						back[0]+=" and tg.v_id is null";
//					}*/else if(params.get(QUERY_KEY_IF_ASSIGN).equals("11")){//合格
//						back[0]+=" and a.v_id in (select V_stuid from (select V_stuid,SUM(i_pass) " +
//								"as ps FROM t_score where v_lessonid in " +
//								"(select v_id from t_lesson where i_type="+type+") group by V_stuid)  score where score.ps=0)";
//					}else if(params.get(QUERY_KEY_IF_ASSIGN).equals("12")){//不合格
//						back[0]+=" and (a.v_id in (select V_stuid from (select V_stuid,SUM(i_pass) " +
//						"as ps FROM t_score where v_lessonid in " +
//						"(select v_id from t_lesson where i_type="+type+") group by V_stuid)  score where score.ps=1)" +
//								" or a.v_id not in (select V_stuid from t_score where " +
//								"v_lessonid in (select v_id from t_lesson where i_type="+type+")))";
//					}else if(params.get(QUERY_KEY_IF_ASSIGN).toString().length()>10){
//						//back[0]+=" and sclass.v_id='"+params.get(QUERY_KEY_IF_ASSIGN)+"'";
//						classid = params.get(QUERY_KEY_IF_ASSIGN).toString();
//						
//						//sql+="left join studentDistributionClass stuc on a.v_id=stuc.v_stuid ";
//						//	sql+="left join t_setClass sclass on stuc.v_classid=sclass.v_id ";
//						
//						back[0]+=" and a.v_id in (select v_stuid from studentDistributionClass where  v_classid ='"+classid+"')";
//						
//					}else if(params.get(QUERY_KEY_IF_ASSIGN).equals("13")){//审核通过
//						back[0]+=" and a.v_id in (select V_stuid from t_score where i_audit=2 and v_lessonid in " +
//								"(select v_id from t_lesson where i_type="+type+"))";
//					}else if(params.get(QUERY_KEY_IF_ASSIGN).equals("14")){//审核未通过
//						back[0]+=" and a.v_id in (select V_stuid from t_score where i_audit=3 and v_lessonid in " +
//								"(select v_id from t_lesson where i_type="+type+"))";
//					}
//					else{
//						back[0]+="";
//					}
//					
//	
//			}
//			
//			//获取教员所在培训班，获取该班的学员信息
//			String hql =" from TSetClass where TOtheruser.VCode=?";
//			List<TSetClass> tlist = super.find(hql, params.get(QUERY_KEY_LOGIN_USER));
//			String str = "";
//			for(int i = 0;i<tlist.size();i++){
//				if(i==tlist.size()-1){
//					str+="'"+tlist.get(i).getVId()+"'";
//				}else{
//					str+="'"+tlist.get(i).getVId()+"',";
//				}
//			}
//			if(tlist.size()>0){
//				back[0]+= " and a.v_id in (select v_stuid from studentDistributionClass where  v_classid in (" + str + "))";
//			}
//			
//			if(params.get(QUERY_KEY_LESSON_ID) != null
//					&& !params.get(QUERY_KEY_LESSON_ID).equals("")){
//				if(params.get(QUERY_KEY_PASS) != null
//						&& !params.get(QUERY_KEY_PASS).equals("")){
//					if(params.get(QUERY_KEY_PASS).equals("0")){
//						back[0]+=" and a.v_id in (select V_stuid from t_score where v_lessonid=? and i_pass=0)";
//						back[1]+= params.get(QUERY_KEY_LESSON_ID) +",";
//					}else if(params.get(QUERY_KEY_PASS).equals("1")){
//						back[0]+=" and a.v_id in (select V_stuid from t_score where v_lessonid=? and i_pass=1)";
//						back[1]+= params.get(QUERY_KEY_LESSON_ID) +",";
//					}else{
//					}
//				}
//			}
//			//有执照班的学生
//			back[0]+=" and a.v_id in (select v_stuid from studentDistributionClass)";
//			//back[0]+=" and ( a.v_stuStatusid = '"+QUERY_KEY_STUDENT_STATUS_FINISH+"'" +
//			//" or a.v_stuStatusid='"+QUERY_KEY_STUDENT_STATUS_GN_SONGPEI+"' or a.v_stuStatusid='"+QUERY_KEY_STUDENT_STATUS_GW_SONGPEI+"')";
//			String sql =getSql(back[0],11);
//			//System.out.println(sql);
//			Integer pageIndex = Integer.parseInt(pageNo);
//
//			Page page;
//			if(back[1].equals("")){
//				page = this.pagedSQLQuery(sql, pageIndex, pageSize);
//			}else{
//				page = this.pagedSQLQuery(sql, pageIndex, pageSize,(Object[])back[1].split(","));
//			}
//			//System.out.println(sql);
//			List<VLessonScore> vlist = new ArrayList<VLessonScore>();
//			VLessonScore vs;
//			
//			List<Object[]> olist = page.getResult();
//			String scoreHql = " from TScore where studentBaseInfo.VId=? and TLesson.IType="+type;
//			if(classid.length()>0){
//				scoreHql = " from TScore where studentBaseInfo.VId=? and TSetClass.VId=? and TLesson.IType="+type;
//			}
//			List<TScore> list;
//			List<VScore> scoreList;
//			VScore vsc;
//			String historyHql =" from THistoryscore where TScore.VId=? order by DExamtime desc";
//			for(Object[] obj:olist){
//				
//				scoreList = new ArrayList<VScore>();
//				vs = new VLessonScore();
//				vs.setVId(obj[0].toString());
//				vs.setVCode(obj[1].toString());
//				vs.setVName(obj[2].toString());
//				if(classid.length()==0){
//					list = super.find(scoreHql, vs.getVId());
//				}else{
//					list = super.find(scoreHql, vs.getVId(),classid);
//				}
//				for(TScore s:list){
//					vsc = new VScore();
//					vsc.setVId(s.getVId());
//					vsc.setDExamTime(s.getDExamTime());
//					vsc.setViewTime(Utilities.format(s.getDExamTime()));
//					vsc.setDScore(s.getDScore());
//					vsc.setClassid(s.getTSetClass().getVId());
//					vsc.setClassName(s.getTSetClass().getVName());
//					vsc.setHistoryList(super.find(historyHql, s.getVId()));
//					vsc.setIAudit(s.getIAudit());
//					vsc.setIPass(s.getIPass());
//					vsc.setITimes(s.getITimes());
//					vsc.setLessonid(s.getTLesson().getVId());
//					vsc.setLessonName(s.getTLesson().getVLessonName());
//					scoreList.add(vsc);
//				}
//				
//				vs.setScoreList(scoreList);
//				vlist.add(vs);
//
//			}
//			
//			page.setData(vlist);
//			
//			return page;
//		}catch(HibernateException e){
//			log.error("获取学生列表失败", e);
//			throw new FinanceServiceException("获取学生列表失败。", e);
//		}
//	}
//	@SuppressWarnings("unchecked")
//	public Page readStudentLicenseScoreList(Map<String, Object> params, String pageNo)throws FinanceServiceException {
//		try {
//			
//			int type = Integer.parseInt(params.get(QUERY_KEY_LESSON_TYPE).toString());
//			
//			int pageSize = FinanceConfig.getIntProperty("default.system.pagesize");
//			
//			String[] back = getCondValue(params);
//			
//			if(params.get(QUERY_KEY_IF_ASSIGN) != null
//					&& !params.get(QUERY_KEY_IF_ASSIGN).equals("1") && !params.get(QUERY_KEY_IF_ASSIGN).equals("6")){
//				
//				
//				if(params.get(QUERY_KEY_IF_ASSIGN).equals("7")){//已推荐
//					//back[0]+=" and  a.i_tjexam=1";
//					back[0]+= " and a.v_id in (select v_stuid from recommendStudentLicenseExam)";
//				}else if(params.get(QUERY_KEY_IF_ASSIGN).equals("8")){//未推荐
//					//back[0]+=" and ( a.i_tjexam is null or a.i_tjexam=0)";
//					back[0]+= " and a.v_id not in (select v_stuid from recommendStudentLicenseExam)";
//				}else if(params.get(QUERY_KEY_IF_ASSIGN).equals("4")){//合格
//					back[0]+=" and a.v_id in (select V_stuid from (select V_stuid,SUM(i_pass) " +
//							"as ps FROM t_score where v_lessonid in " +
//							"(select v_id from t_lesson where i_type="+type+") group by V_stuid)  score where score.ps=0)";
//				}else if(params.get(QUERY_KEY_IF_ASSIGN).equals("5")){//不合格
//					back[0]+=" and (a.v_id in (select V_stuid from (select V_stuid,SUM(i_pass) " +
//					"as ps FROM t_score where v_lessonid in " +
//					"(select v_id from t_lesson where i_type="+type+") group by V_stuid)  score where score.ps=1)" +
//							" or a.v_id not in (select V_stuid from t_score where " +
//							"v_lessonid in (select v_id from t_lesson where i_type="+type+")))";
//				}else if(params.get(QUERY_KEY_IF_ASSIGN).toString().length()>10){
//					//back[0]+=" and sclass.v_id='"+params.get(QUERY_KEY_IF_ASSIGN)+"'";
//					back[0]+=" and a.v_id in (select v_stuid from studentDistributionClass where v_classid= '"
//						+params.get(QUERY_KEY_IF_ASSIGN)+"')";
//				}
//				else{
//					back[0]+="";
//				}
//					
//	
//			}
//			//获取教员所在培训班，获取该办的学员信息
//			String hql =" from TSetClass where TOtheruser.VCode=?";
//			List<TSetClass> tlist = super.find(hql, params.get(QUERY_KEY_LOGIN_USER));
//			String str = "";
//			for(int i = 0;i<tlist.size();i++){
//				if(i==tlist.size()-1){
//					str+="'"+tlist.get(i).getVId()+"'";
//				}else{
//					str+="'"+tlist.get(i).getVId()+"',";
//				}
//			}
//			if(tlist.size()>0){
//				back[0]+= " and a.v_id in (select v_stuid from studentDistributionClass where v_classid in (" + str + "))";
//			}
//			/*
//			if(params.get(QUERY_KEY_LESSON_ID) != null
//					&& !params.get(QUERY_KEY_LESSON_ID).equals("")){
//				if(params.get(QUERY_KEY_PASS) != null
//						&& !params.get(QUERY_KEY_PASS).equals("")){
//					if(params.get(QUERY_KEY_PASS).equals("0")){
//						back[0]+=" and a.v_id in (select V_stuid from t_score where v_lessonid=? and i_pass=0)";
//						back[1]+= params.get(QUERY_KEY_LESSON_ID) +",";
//					}else if(params.get(QUERY_KEY_PASS).equals("1")){
//						back[0]+=" and a.v_id in (select V_stuid from t_score where v_lessonid=? and i_pass=1)";
//						back[1]+= params.get(QUERY_KEY_LESSON_ID) +",";
//					}else{
//					}
//				}
//			}
//			*/
//			//back[0]+=" and ( a.v_stuStatusid = '"+QUERY_KEY_STUDENT_STATUS_FINISH+"'
//			//or a.v_stuStatusid='"+QUERY_KEY_STUDENT_STATUS_GN_SONGPEI+"')";
//			
//			//有执照班的学生
//			back[0]+=" and a.v_id in (select v_stuid from studentDistributionClass)";
//			
//			String sql =getSql(back[0],1);
//			
//			Integer pageIndex = Integer.parseInt(pageNo);
//
//			Page page;
//			if(back[1].equals("")){
//				page = this.pagedSQLQuery(sql, pageIndex, pageSize);
//			}else{
//				page = this.pagedSQLQuery(sql, pageIndex, pageSize,(Object[])back[1].split(","));
//			}
//			List<VLessonScore> vlist = new ArrayList<VLessonScore>();
//			VLessonScore vs;
//			
//			List<Object[]> olist = page.getResult();
//			String scoreHql = " from TScore where studentBaseInfo.VId=? and TLesson.IType="+type;
//			
//			//String jfHql =" from TScore where studentBaseInfo.VId=? and TLesson.IType=2 order by DExamTime desc";
//			
//			String chql= " from RecommendStudentLicenseExam where studentBaseInfo.VId=? order by DExamDate desc";
//			//List<RecommendStudentLicenseExam> clist;
//			
//			List<TScore> list;
//			//List<TScore> jflist;
//			List<VScore> scoreList;
//			VScore vsc;
//			//long l1=0;
//			//long l2=0;
//			//String historyHql =" from THistoryscore where TScore.VId=? order by DExamtime desc";
//			for(Object[] obj:olist){
//				scoreList = new ArrayList<VScore>();
//				vs = new VLessonScore();
//				vs.setVId(obj[0].toString());
//				vs.setVCode(obj[1].toString());
//				vs.setVName(obj[2].toString());
//				//clist = super.find(chql, obj[0]);
//				vs.setRecomlist(super.find(chql, obj[0]));
//				/*
//				if(clist.size()>0){
//					vs.setTuijian(1);
//					vs.setTjTime(Utilities.format(clist.get(0).getDExamDate()));
//				}else{
//					vs.setTuijian(0);
//					vs.setTjTime("");
//				}
//				*/
//				//vs.setTuijian(Integer.parseInt(obj[10].toString()));
//			//	if(obj[11]!=null && !obj[11].equals("")){
//			//		vs.setTjTime(Utilities.format((Date)obj[11]));
//			//	}else{
//			//		vs.setTjTime("");
//			//	}
//				/*
//				jflist = super.find(jfHql,vs.getVId());
//				if(jflist.size()>0 && jflist.get(0).getDExamTime()!=null){
//					vs.setLastTime(Utilities.format(jflist.get(0).getDExamTime()));
//				}else{
//					vs.setLastTime("");
//				}
//				if(vs.getTjTime().length()>0 && vs.getLastTime().length()>0){
//					l1 = Utilities.parse(vs.getTjTime()).getTime();
//					l2 = Utilities.parse(vs.getLastTime()).getTime();
//					vs.setVday(String.valueOf((l1-l2)/1000/3600/24));
//				}else{
//					vs.setVday("");
//				}
//				*/
//				list = super.find(scoreHql, vs.getVId());
//				
//				for(TScore s:list){
//					vsc = new VScore();
//					vsc.setDExamTime(s.getDExamTime());
//					vsc.setDScore(s.getDScore());
//					//vsc.setHistoryList(super.find(historyHql, s.getVId()));
//					vsc.setIAudit(s.getIAudit());
//					vsc.setIPass(s.getIPass());
//					vsc.setITimes(s.getITimes());
//					vsc.setLessonid(s.getTLesson().getVId());
//					scoreList.add(vsc);
//				}
//				vs.setScoreList(scoreList);
//				vlist.add(vs);
//
//			}
//			
//			page.setData(vlist);
//			
//			return page;
//		}//catch(ParseException p){
//		//	throw new FinanceServiceException("获取学生列表失败。", p);
//		//}
//		catch(HibernateException e){
//			log.error("获取学生列表失败", e);
//			throw new FinanceServiceException("获取学生列表失败。", e);
//		}
//	}
//	@SuppressWarnings("unchecked")
//	public Page readStudentLicenseList(Map<String, Object> params, String pageNo)throws FinanceServiceException {
//		try {
//			
//			int pageSize = FinanceConfig.getIntProperty("default.system.pagesize");
//			
//			String[] back = getCondValue(params);
//			
//			//更多查询
//			if(params.get(QUERY_KEY_IF_ASSIGN) != null
//					&& !params.get(QUERY_KEY_IF_ASSIGN).equals("1") && !params.get(QUERY_KEY_IF_ASSIGN).equals("6")){
//
//				if(params.get(QUERY_KEY_IF_ASSIGN).equals("2")){//有执照
//					back[0]+=" and isnull(zz.v_cardid,'')<>''";
//				}else if(params.get(QUERY_KEY_IF_ASSIGN).equals("3")){//无执照
//					back[0]+=" and isnull(zz.v_cardid,'')=''";
//				}else{
//					back[0]+="";
//				}
//			}
//			long l1 = 0;
//			long l2 = 0;
//			long dd = 0;
//			int d = 0;
//			String sql =getSql(back[0],8);
//
//			Integer pageIndex = Integer.parseInt(pageNo);
//
//			Page page;
//			if(back[1].equals("")){
//				page = this.pagedSQLQuery(sql, pageIndex, pageSize);
//			}else{
//				page = this.pagedSQLQuery(sql, pageIndex, pageSize,(Object[])back[1].split(","));
//			}
//			List<VStudentBaseInfo> vlist = new ArrayList<VStudentBaseInfo>();
//			VStudentBaseInfo vs;
//			
//			List<Object[]> olist = page.getResult();
//			Date date; 
//			for(Object[] obj:olist){
//				vs = new VStudentBaseInfo();
//				vs.setVId(obj[0].toString());
//				vs.setVCode(obj[1].toString());
//				vs.setVName(obj[2].toString());
//				vs.setVGender(obj[3].toString());
//				
//				vs.setVCardid(obj[10].toString());
//				
//				if(obj[11]==null){//签发日期
//					vs.setCreateTime("");
//					
//				}else{
//					vs.setCreateTime(Utilities.format((Date)obj[11]));
//				}
//				
//				if(obj[12]==null){//到期日期
//					vs.setStuTypeName("");
//					date = null;
//				}else{
//					date = (Date)obj[12];
//					vs.setStuTypeName(Utilities.format((Date)obj[12]));
//				}
//				if(obj[13]==null){//上次熟练检查日期
//					vs.setCompanyName("");
//				}else{
//					vs.setCompanyName(Utilities.format((Date)obj[13]));
//				}
//				
//				if(obj[14]==null){//下次熟练检查日期
//					vs.setStuStatusName("");
//				}else{
//					vs.setStuStatusName(Utilities.format((Date)obj[14]));
//				}
//				if(obj[15]==null){//执照id
//					vs.setUserid("");
//				}else{
//					vs.setUserid(obj[15].toString());
//				}
//				
//				//计算剩余天数
//				if(date!=null){//到期日期
//					l1 = date.getTime();
//					l2 = new Date().getTime();
//					dd = (l1-l2)/1000/3600/24 + 1;
//					d = (int)dd;
//					vs.setIday(d);//剩余天数
//				}else{
//					vs.setIday(10000);//剩余天数
//				}
//				
//				vlist.add(vs);
//			}
//						
//			page.setData(vlist);
//			
//			return page;
//		}catch(HibernateException e){
//			log.error("获取学生列表失败", e);
//			throw new FinanceServiceException("获取学生列表失败。", e);
//		}
//	}
//	@SuppressWarnings("unchecked")
//	public Page readStudentStatusInfoList(Map<String, Object> params, String pageNo)throws FinanceServiceException {
//		try {
//			
//			int pageSize = FinanceConfig.getIntProperty("default.system.pagesize");
//			
//			String[] back = getCondValue(params);
//			
//			//更多查询
//			if(params.get(QUERY_KEY_IF_ASSIGN) != null
//					&& !params.get(QUERY_KEY_IF_ASSIGN).equals("1")){
//
//				if(params.get(QUERY_KEY_IF_ASSIGN).equals("4")){
//					back[0]+=" and a.v_gender='男'";
//				}else if(params.get(QUERY_KEY_IF_ASSIGN).equals("5")){
//					back[0]+=" and a.v_gender='女'";
//				}else if(params.get(QUERY_KEY_IF_ASSIGN).equals("7")){
//					back[0]+=" and cj.i_result=0 and st.i_result=0 and bx.i_result=0";
//				}else{
//					back[0]+="";
//				}
//			}
//			
//			String sql =getSql(back[0],10);
//			Integer pageIndex = Integer.parseInt(pageNo);
//			Page page;
//			if(back[1].equals("")){
//				page = this.pagedSQLQuery(sql, pageIndex, pageSize);
//			}else{
//				page = this.pagedSQLQuery(sql, pageIndex, pageSize,(Object[])back[1].split(","));
//			}
//			List<VStudentBaseInfo> vlist = new ArrayList<VStudentBaseInfo>();
//			VStudentBaseInfo vs;
//			
//			List<Object[]> olist = page.getResult();
//			
//			for(Object[] obj:olist){
//				vs = new VStudentBaseInfo();
//				vs.setVId(obj[0].toString());
//				vs.setVCode(obj[1].toString());
//				vs.setVName(obj[2].toString());
//				vs.setVGender(obj[3].toString());
//				
//				vs.setStuTypeName(obj[4].toString());
//				vs.setCompanyName(obj[5].toString());
//				vs.setStuStatusName(obj[6].toString());
//				
//				vs.setXjStatusName(obj[7].toString());
//				vs.setFormName(obj[8].toString());
//				vs.setFreeTypeName(obj[9].toString());
//				if(obj[10]!=null){//成绩
//					
//					if(obj[10].toString().equals("0")){
//						vs.setZy("合格");
//					}else if(obj[10].toString().equals("1")){
//						vs.setZy("不合格");
//					}else if(obj[10].toString().equals("2")){
//						vs.setZy("暂不合格");
//					}else{
//						vs.setZy("未审查");
//					}
//					
//				}else{
//					vs.setZy("未审查");
//				}
//				if(obj[11]!=null){//身体
//					if(obj[11].toString().equals("0")){
//						vs.setSyd("合格");
//					}else if(obj[11].toString().equals("1")){
//						vs.setSyd("不合格");
//					}else if(obj[11].toString().equals("2")){
//						vs.setSyd("暂不合格");
//					}else{
//						vs.setSyd("未审查");
//					}
//				}else{
//					vs.setSyd("未审查");
//				}
//				if(obj[12]!=null){//在校表现
//					if(obj[12].toString().equals("0")){
//						vs.setXxlx("合格");
//					}else if(obj[12].toString().equals("1")){
//						vs.setXxlx("不合格");
//					}else if(obj[12].toString().equals("2")){
//						vs.setXxlx("暂不合格");
//					}else{
//						vs.setXxlx("未审查");
//					}
//				}else{
//					vs.setXxlx("未审查");
//				}
//				
//				vlist.add(vs);
//			}
//			
//			page.setData(vlist);
//			
//			return page;
//		}catch(HibernateException e){
//			log.error("获取学生列表失败", e);
//			throw new FinanceServiceException("获取学生列表失败。", e);
//		}
//	}
//	@SuppressWarnings("unchecked")
//	public Page readStudentDistributionClassList(Map<String, Object> params, String pageNo)throws FinanceServiceException {
//		try {
//			
//			int pageSize = FinanceConfig.getIntProperty("default.system.pagesize");
//			
//			String[] back = getCondValue(params);
//			
//			//更多查询
//			if(params.get(QUERY_KEY_IF_ASSIGN) != null
//						&& !params.get(QUERY_KEY_IF_ASSIGN).equals("1") && !params.get(QUERY_KEY_IF_ASSIGN).equals("6")){
//				back[0]+=" and a.v_id in (select v_stuid from studentDistributionClass where v_classid= '" +params.get(QUERY_KEY_IF_ASSIGN)+"')";
//			}
//			//国内送培阶段与训练后在学与国外训练
//			/*
//			back[0]+=" and ( a.v_stuStatusid = '"+QUERY_KEY_STUDENT_STATUS_FINISH+"'" +
//					" or a.v_stuStatusid='"+QUERY_KEY_STUDENT_STATUS_GN_SONGPEI+"'" +
//							" or a.v_stuStatusid='"+QUERY_KEY_STUDENT_STATUS_GW_SONGPEI+"')";
//			*/
//			String sql =getSql(back[0],11);
//			//System.out.println(sql);
//			Integer pageIndex = Integer.parseInt(pageNo);
//
//			Page page;
//			if(back[1].equals("")){
//				page = this.pagedSQLQuery(sql, pageIndex, pageSize);
//			}else{
//				page = this.pagedSQLQuery(sql, pageIndex, pageSize,(Object[])back[1].split(","));
//			}
//			List<VStudentBaseInfo> vlist = new ArrayList<VStudentBaseInfo>();
//			VStudentBaseInfo vs;
//			
//			String hql = " from StudentDistributionClass where studentBaseInfo.VId=?";
//			List<StudentDistributionClass> stuClassList;
//			
//			List<VStudentDistributionClass> vsc;
//			
//			VStudentDistributionClass vclass;
//			
//			List<Object[]> olist = page.getResult();
//			
//			for(Object[] obj:olist){
//				vs = new VStudentBaseInfo();
//				vs.setVId(obj[0].toString());
//				vs.setVCode(obj[1].toString());
//				vs.setVName(obj[2].toString());
//				vs.setVGender(obj[3].toString());
//				
//				vs.setStuTypeName(obj[4].toString());
//				vs.setCompanyName(obj[5].toString());
//				vs.setStuStatusName(obj[6].toString());
//				
//				vs.setXjStatusName(obj[7].toString());
//				vs.setFormName(obj[8].toString());
//				vs.setFreeTypeName(obj[9].toString());
//				
//				//分配班级信息
//				vsc = new ArrayList<VStudentDistributionClass>();
//				stuClassList = super.find(hql, vs.getVId());
//				for(StudentDistributionClass t:stuClassList){
//					vclass = new VStudentDistributionClass();
//					vclass.setVId(t.getVId());
//					vclass.setClassid(t.getTSetClass().getVId());
//					vclass.setClassName(t.getTSetClass().getVName());
//					vclass.setDAssigntime(Utilities.format(t.getDAssigntime()));
//					vsc.add(vclass);
//				}
//				
//				vs.setStuClassList(vsc);
//				vlist.add(vs);
//			}
//			
//			page.setData(vlist);
//			
//			return page;
//		}catch(HibernateException e){
//			log.error("获取学生列表失败", e);
//			throw new FinanceServiceException("获取学生列表失败。", e);
//		}
//	}
//	
//	@SuppressWarnings("unchecked")
//	public List<VStudentBaseInfo> readAccordAllCondtionList(Map<String,Object> params) throws FinanceServiceException{
//		try{
//			String[] back = getCondValue(params);
//			
//			back[0]+=" and a.v_id in (select V_stuid from t_score where v_lessonid='f1866a954aba4ea6014ac2200d0e00f3'" +
//			" and d_score>=4.5)"; 
//			
//			back[0]+=" and a.v_id in (select V_stuid from t_score where v_lessonid='f1866a954a1470a0014a183f34380018'" +
//			" and d_score>=3)";
//			
//			back[0]+=" and a.v_id in (select V_stuid from (select V_stuid,count(i_pass) as cpass,SUM(i_pass) " +
//			"as ps FROM t_score where v_lessonid in " +
//			"(select v_id from t_lesson where i_type=2)" +
//					" group by V_stuid)  score where score.ps=0 and score.cpass>=4)";
//			
//			String sql =getSql(back[0],12);
//			List<Object[]> olist;
//	
//			if(back[1].equals("")){
//				olist = this.createSQLQuery(sql).list();
//			}else{
//				olist = this.createSQLQuery(sql, (Object[])back[1].split(",")).list();
//			}
//			List<VStudentBaseInfo> vlist = new ArrayList<VStudentBaseInfo>();
//			VStudentBaseInfo vs;
//		
//			String scoreHql = " from TScore where studentBaseInfo.VId=? order by DCreateDate desc";
//			List<TScore> list;
//			double p = 0;
//			double z = 0;
//			int m=0;
//			Date date;
//			for(Object[] obj:olist){
//				date= new Date();
//				vs = new VStudentBaseInfo();
//				vs.setVId(obj[0].toString());
//				vs.setVCode(obj[1].toString());
//				vs.setVName(obj[2].toString());
//				vs.setCompanyName(obj[5].toString());		
//				vs.setVClassNoid(obj[13].toString());
//				if(obj[10]!=null){//成绩
//					
//					if(obj[10].toString().equals("0")){
//						vs.setZy("合格");
//					}else if(obj[10].toString().equals("1")){
//						vs.setZy("不合格");
//					}else if(obj[10].toString().equals("2")){
//						vs.setZy("暂不合格");
//					}else{
//						vs.setZy("未审查");
//					}
//					
//				}else{
//					vs.setZy("未审查");
//				}
//				if(obj[11]!=null){//身体
//					if(obj[11].toString().equals("0")){
//						vs.setSyd("合格");
//					}else if(obj[11].toString().equals("1")){
//						vs.setSyd("不合格");
//					}else if(obj[11].toString().equals("2")){
//						vs.setSyd("暂不合格");
//					}else{
//						vs.setSyd("未审查");
//					}
//				}else{
//					vs.setSyd("未审查");
//				}
//				if(obj[12]!=null){//在校表现
//					if(obj[12].toString().equals("0")){
//						vs.setXxlx("合格");
//					}else if(obj[12].toString().equals("1")){
//						vs.setXxlx("不合格");
//					}else if(obj[12].toString().equals("2")){
//						vs.setXxlx("暂不合格");
//					}else{
//						vs.setXxlx("未审查");
//					}
//				}else{
//					vs.setXxlx("未审查");
//				}
//				list = super.find(scoreHql, vs.getVId());
//				p=0;
//				z=0;
//				for(TScore s:list){
//					
//					if(s.getTLesson().getVId().equals("fbd33112496a70ea01496ab88a090003")){
//						vs.setVGender(Utilities.getXxje(s.getDScore()));
//					}
//					else if(s.getTLesson().getVId().equals("4028816a49882a6f0149882d9a800002")){
//						vs.setStuTypeName(Utilities.getXxje(s.getDScore()));
//					}
//					else if(s.getTLesson().getVId().equals("ff80808149698c3001496995d4f20004")){
//						vs.setStuStatusName(Utilities.getXxje(s.getDScore()));
//					}
//					else if(s.getTLesson().getVId().equals("f1866a954a1470a0014a183fb3990019")){
//						vs.setXjStatusName(Utilities.getXxje(s.getDScore()));
//					}
//					else if(s.getTLesson().getVId().equals("f1866a954a1470a0014a183f34380018")){
//						vs.setFormName(Utilities.getXxje(s.getDScore()));
//						vs.setEnScore((int)(s.getDScore()*100));//英语成绩
//					}
//	
//					else if(s.getTLesson().getVId().equals("f1866a954a1470a0014a18412c2f001b")){
//						if(s.getIPass()==0){
//							vs.setFreeTypeName(Utilities.getXxje(s.getDScore()));
//							vs.setWhcd(Utilities.format(s.getDExamTime()));
//							p+=s.getDScore();
//							z++;
//							if(s.getDExamTime().getTime()<date.getTime()){
//								date = s.getDExamTime();
//							}
//						}
//	
//					}
//					else if(s.getTLesson().getVId().equals("fbd33112496a70ea01496ab833ca0002")){
//						if(s.getIPass()==0){
//							vs.setBj(Utilities.getXxje(s.getDScore()));
//							vs.setNation(Utilities.format(s.getDExamTime()));
//							p+=s.getDScore();
//							z++;
//							if(s.getDExamTime().getTime()<date.getTime()){
//								date = s.getDExamTime();
//							}
//						}
//					}
//					else if(s.getTLesson().getVId().equals("ff80808149698c300149699581a50003")){
//						if(s.getIPass()==0){
//							vs.setLxfs(Utilities.getXxje(s.getDScore()));
//							vs.setJg(Utilities.format(s.getDExamTime()));
//							p+=s.getDScore();
//							z++;
//							if(s.getDExamTime().getTime()<date.getTime()){
//								date = s.getDExamTime();
//							}
//						}
//					}
//					else if(s.getTLesson().getVId().equals("ff80808149698c3001496994eace0002")){
//						if(s.getIPass()==0){
//							vs.setZzmm(Utilities.getXxje(s.getDScore()));
//							vs.setEnLevel(Utilities.format(s.getDExamTime()));
//							p+=s.getDScore();
//							z++;
//							if(s.getDExamTime().getTime()<date.getTime()){
//								date = s.getDExamTime();
//							}
//						}
//					}
//					
//					
//					else if(s.getTLesson().getVId().equals("f1866a954aba4ea6014ac2200d0e00f3")){
//						vs.setDvid(Utilities.getXxje(s.getDScore()));
//					}
//				}
//
//				if(z>0){
//					vs.setByyx(Utilities.getXxje(p/z));
//					m = (int)(p/z * 10000);
//					vs.setAvgScore(m);
//					vs.setJtzz(Utilities.format(date));
//					vs.setLtime((int)(date.getTime()/1000/60/60/24));
//				}
//				vlist.add(vs);
//			}
//			//排序
//			Collections.sort(vlist,new SortComparator());
//			//返回
//			return vlist;
//		}catch(HibernateException e){
//			log.error("获取学生列表失败", e);
//			throw new FinanceServiceException("获取学生列表失败。", e);
//		}
//	}
//	@SuppressWarnings("unchecked")
//	public Page readStudentInternalSendPeiList(Map<String, Object> params, String pageNo)throws FinanceServiceException {
//		try {
//			
//			int pageSize = FinanceConfig.getIntProperty("default.system.pagesize");
//			
//			String[] back = getCondValue(params);
//			
//			//雅思成绩
//			if(params.get(QUERY_KEY_SONGPEI_SY) != null
//					&& !params.get(QUERY_KEY_SONGPEI_SY).equals("")){
//				if(params.get(QUERY_KEY_SONGPEI_SY).equals("0")){
//
//					/*
//					back[0]+=" and a.v_id in (select V_stuid from (select V_stuid,SUM(i_pass) " +
//					"as ps FROM t_score where v_lessonid in " +
//					"(select v_id from t_lesson where i_type=0)" +
//							" group by V_stuid)  score where score.ps=0)";
//					*/
//					back[0]+=" and a.v_id in (select V_stuid from t_score where v_lessonid='f1866a954aba4ea6014ac2200d0e00f3'" +
//							" and d_score<11 and d_score>=4.5)";
//				}else{
//					/*
//					back[0]+=" and (a.v_id in (select V_stuid from (select V_stuid,SUM(i_pass) " +
//					"as ps FROM t_score where v_lessonid in " +
//					"(select v_id from t_lesson where i_type=0) group by V_stuid)  score where score.ps=1)" +
//							" or a.v_id not in (select V_stuid from t_score where " +
//							"v_lessonid in (select v_id from t_lesson where i_type=0)))";
//					*/
//					back[0]+=" and a.v_id not in (select V_stuid from t_score where v_lessonid='f1866a954aba4ea6014ac2200d0e00f3'" +
//							" and d_score<11 and d_score>=4.5)";
//				}
//			}
//			//校考成绩
//			if(params.get(QUERY_KEY_SONGPEI_XK) != null
//					&& !params.get(QUERY_KEY_SONGPEI_XK).equals("")){
//				if(params.get(QUERY_KEY_SONGPEI_XK).equals("0")){
//					/*
//					back[0]+=" and a.v_id in (select V_stuid from (select V_stuid,SUM(i_pass) " +
//					"as ps FROM t_score where v_lessonid in " +
//					"(select v_id from t_lesson where i_type=1)" +
//							" group by V_stuid)  score where score.ps=0)";
//					*/
//					back[0]+=" and a.v_id in (select V_stuid from t_score where v_lessonid='f1866a954a1470a0014a183f34380018'" +
//							" and d_score<11 and d_score>=3)";
//				}else{
//					/*
//					back[0]+=" and (a.v_id in (select V_stuid from (select V_stuid,SUM(i_pass) " +
//					"as ps FROM t_score where v_lessonid in " +
//					"(select v_id from t_lesson where i_type=1) group by V_stuid)  score where score.ps=1)" +
//							" or a.v_id not in (select V_stuid from t_score where " +
//							"v_lessonid in (select v_id from t_lesson where i_type=1)))";
//					*/
//					back[0]+=" and a.v_id not in (select V_stuid from t_score where v_lessonid='f1866a954a1470a0014a183f34380018'" +
//					" and d_score<11 and d_score>=3)";
//				}
//			}
//			//局方成绩
//			if(params.get(QUERY_KEY_SONGPEI_JF) != null
//					&& !params.get(QUERY_KEY_SONGPEI_JF).equals("")){
//
//				if(params.get(QUERY_KEY_SONGPEI_JF).equals("0")){
//					back[0]+=" and a.v_id in (select V_stuid from (select V_stuid,count(i_pass) as cpass,SUM(i_pass) " +
//					"as ps FROM t_score where v_lessonid in " +
//					"(select v_id from t_lesson where i_type=2)" +
//							" group by V_stuid)  score where score.ps=0 and score.cpass>=4)";
//				}else{
//					/*
//					back[0]+=" and (a.v_id in (select V_stuid from (select V_stuid,SUM(i_pass) " +
//					"as ps FROM t_score where v_lessonid in " +
//					"(select v_id from t_lesson where i_type=2) group by V_stuid)  score where score.ps=1)" +
//							" or a.v_id not in (select V_stuid from t_score where " +
//							"v_lessonid in (select v_id from t_lesson where i_type=2)))";
//					*/
//					back[0]+=" and a.v_id not in (select V_stuid from (select V_stuid,count(i_pass) as cpass,SUM(i_pass) " +
//					"as ps FROM t_score where v_lessonid in " +
//					"(select v_id from t_lesson where i_type=2)" +
//							" group by V_stuid)  score where score.ps=0 and score.cpass>=4)";
//				}
//			}
//			
//			//成绩审查
//			if(params.get(QUERY_KEY_SONGPEI_CJ) != null
//					&& !params.get(QUERY_KEY_SONGPEI_CJ).equals("")){
//				if(params.get(QUERY_KEY_SONGPEI_CJ).equals("3")){
//					back[0]+=" and a.v_id not in (select v_stuid from t_sendqualificationreview where i_type=0)";
//				}else{
//					back[0]+=" and cj.i_result=" + Integer.parseInt(params.get(QUERY_KEY_SONGPEI_CJ).toString());
//				}
//				
//			}
//			//身体审查
//			if(params.get(QUERY_KEY_SONGPEI_ST) != null
//					&& !params.get(QUERY_KEY_SONGPEI_ST).equals("")){
//				if(params.get(QUERY_KEY_SONGPEI_ST).equals("3")){
//					back[0]+=" and a.v_id not in (select v_stuid from t_sendqualificationreview where i_type=1)";
//				}else{
//					back[0]+=" and st.i_result=" + Integer.parseInt(params.get(QUERY_KEY_SONGPEI_ST).toString());
//				}
//			}
//			//在校表现
//			if(params.get(QUERY_KEY_SONGPEI_BX) != null
//					&& !params.get(QUERY_KEY_SONGPEI_BX).equals("")){
//				if(params.get(QUERY_KEY_SONGPEI_BX).equals("3")){
//					back[0]+=" and a.v_id not in (select v_stuid from t_sendqualificationreview where i_type=2)";
//				}else{
//					back[0]+=" and bx.i_result="+ Integer.parseInt(params.get(QUERY_KEY_SONGPEI_BX).toString());
//				}
//			}
//			//所有项
//			if(params.get(QUERY_KEY_SONGPEI_ALL) != null
//					&& !params.get(QUERY_KEY_SONGPEI_ALL).equals("")){
//				int pass = + Integer.parseInt(params.get(QUERY_KEY_SONGPEI_ALL).toString());
//				if(pass==0){
//					back[0]+=" and cj.i_result=0 and st.i_result=0 and bx.i_result=0";
//					back[0]+=" and a.v_id in (select V_stuid from (select V_stuid,SUM(i_pass) " +
//					"as ps FROM t_score group by V_stuid) score where score.ps=0)";
//				}else{
//					back[0]+=" and (a.v_id in (select V_stuid from (select V_stuid,SUM(i_pass) " +
//					"as ps FROM t_score group by V_stuid) score where score.ps=1)" +
//							" or a.v_id not in (select V_stuid from t_score) or" +
//							" a.v_id not in (select v_stuid from t_sendqualificationreview))";
//				}
//			}
//			String sql =getSql(back[0],12);
//			//System.out.println(sql);
//			Integer pageIndex = Integer.parseInt(pageNo);
//			Page page;
//			if(back[1].equals("")){
//				page = this.pagedSQLQuery(sql, pageIndex, pageSize);
//			}else{
//				page = this.pagedSQLQuery(sql, pageIndex, pageSize,(Object[])back[1].split(","));
//			}
//			List<VStudentBaseInfo> vlist = new ArrayList<VStudentBaseInfo>();
//			VStudentBaseInfo vs;
//			
//			//List<VStudentDistributionClass> scoreList;
//			//VStudentDistributionClass vsc;
//			
//			String scoreHql = " from TScore where studentBaseInfo.VId=? order by DCreateDate desc";
//			List<TScore> list;
//			List<Object[]> olist = page.getResult();
//			double p = 0;
//			int z = 0;
//			Date date;
//			for(Object[] obj:olist){
//				date= new Date();
//				//scoreList = new ArrayList<VStudentDistributionClass>();
//				vs = new VStudentBaseInfo();
//				vs.setVId(obj[0].toString());
//				vs.setVCode(obj[1].toString());
//				vs.setVName(obj[2].toString());
//				vs.setCompanyName(obj[5].toString());		
//				vs.setVClassNoid(obj[13].toString());
//				if(obj[10]!=null){//成绩
//					
//					if(obj[10].toString().equals("0")){
//						vs.setZy("合格");
//					}else if(obj[10].toString().equals("1")){
//						vs.setZy("不合格");
//					}else if(obj[10].toString().equals("2")){
//						vs.setZy("暂不合格");
//					}else{
//						vs.setZy("未审查");
//					}
//					
//				}else{
//					vs.setZy("未审查");
//				}
//				if(obj[11]!=null){//身体
//					if(obj[11].toString().equals("0")){
//						vs.setSyd("合格");
//					}else if(obj[11].toString().equals("1")){
//						vs.setSyd("不合格");
//					}else if(obj[11].toString().equals("2")){
//						vs.setSyd("暂不合格");
//					}else{
//						vs.setSyd("未审查");
//					}
//				}else{
//					vs.setSyd("未审查");
//				}
//				if(obj[12]!=null){//在校表现
//					if(obj[12].toString().equals("0")){
//						vs.setXxlx("合格");
//					}else if(obj[12].toString().equals("1")){
//						vs.setXxlx("不合格");
//					}else if(obj[12].toString().equals("2")){
//						vs.setXxlx("暂不合格");
//					}else{
//						vs.setXxlx("未审查");
//					}
//				}else{
//					vs.setXxlx("未审查");
//				}
//				list = super.find(scoreHql, vs.getVId());
//				p=0;
//				z=0;
//				for(TScore s:list){
//					
//					if(s.getTLesson().getVId().equals("fbd33112496a70ea01496ab88a090003")){
//						vs.setVGender(Utilities.getXxje(s.getDScore()));
//					}
//					else if(s.getTLesson().getVId().equals("4028816a49882a6f0149882d9a800002")){
//						vs.setStuTypeName(Utilities.getXxje(s.getDScore()));
//					}
//					else if(s.getTLesson().getVId().equals("ff80808149698c3001496995d4f20004")){
//						vs.setStuStatusName(Utilities.getXxje(s.getDScore()));
//					}
//					else if(s.getTLesson().getVId().equals("f1866a954a1470a0014a183fb3990019")){
//						vs.setXjStatusName(Utilities.getXxje(s.getDScore()));
//					}
//					else if(s.getTLesson().getVId().equals("f1866a954a1470a0014a183f34380018")){
//						vs.setFormName(Utilities.getXxje(s.getDScore()));
//					}
//
//					else if(s.getTLesson().getVId().equals("f1866a954a1470a0014a18412c2f001b")){
//						if(s.getIPass()==0){
//							vs.setFreeTypeName(Utilities.getXxje(s.getDScore()));
//							vs.setWhcd(Utilities.format(s.getDExamTime()));
//							p+=s.getDScore();
//							z++;
//							if(s.getDExamTime().getTime()<date.getTime()){
//								date = s.getDExamTime();
//							}
//						}
//
//					}
//					else if(s.getTLesson().getVId().equals("fbd33112496a70ea01496ab833ca0002")){
//						if(s.getIPass()==0){
//							vs.setBj(Utilities.getXxje(s.getDScore()));
//							vs.setNation(Utilities.format(s.getDExamTime()));
//							p+=s.getDScore();
//							z++;
//							if(s.getDExamTime().getTime()<date.getTime()){
//								date = s.getDExamTime();
//							}
//						}
//					}
//					else if(s.getTLesson().getVId().equals("ff80808149698c300149699581a50003")){
//						if(s.getIPass()==0){
//							vs.setLxfs(Utilities.getXxje(s.getDScore()));
//							vs.setJg(Utilities.format(s.getDExamTime()));
//							p+=s.getDScore();
//							z++;
//							if(s.getDExamTime().getTime()<date.getTime()){
//								date = s.getDExamTime();
//							}
//						}
//					}
//					else if(s.getTLesson().getVId().equals("ff80808149698c3001496994eace0002")){
//						if(s.getIPass()==0){
//							vs.setZzmm(Utilities.getXxje(s.getDScore()));
//							vs.setEnLevel(Utilities.format(s.getDExamTime()));
//							p+=s.getDScore();
//							z++;
//							if(s.getDExamTime().getTime()<date.getTime()){
//								date = s.getDExamTime();
//							}
//						}
//					}
//					
//					
//					else if(s.getTLesson().getVId().equals("f1866a954aba4ea6014ac2200d0e00f3")){
//						vs.setDvid(Utilities.getXxje(s.getDScore()));
//					}
//				}
//				if(z>0){
//					vs.setByyx(Utilities.getXxje(p/z));
//					vs.setJtzz(Utilities.format(date));
//				}
//				vlist.add(vs);
//			}
//			
//			
//			page.setData(vlist);
//			
//			return page;
//		}catch(HibernateException e){
//			log.error("获取学生列表失败", e);
//			throw new FinanceServiceException("获取学生列表失败。", e);
//		}
//	}
//	@SuppressWarnings("unchecked")
//	public Page readStudentAbroadSendPeiList(Map<String, Object> params, String pageNo)throws FinanceServiceException {
//		try {
//			
//			int pageSize = FinanceConfig.getIntProperty("default.system.pagesize");
//			
//			String[] back = getCondValue(params);
//			
//			//雅思成绩
//			if(params.get(QUERY_KEY_SONGPEI_SY) != null
//					&& !params.get(QUERY_KEY_SONGPEI_SY).equals("")){
//				if(params.get(QUERY_KEY_SONGPEI_SY).equals("0")){
//
//					back[0]+=" and a.v_id in (select V_stuid from (select V_stuid,SUM(i_pass) " +
//					"as ps FROM t_score where v_lessonid in " +
//					"(select v_id from t_lesson where i_type=0)" +
//							" group by V_stuid)  score where score.ps=0)";
//				}else{
//					back[0]+=" and (a.v_id in (select V_stuid from (select V_stuid,SUM(i_pass) " +
//					"as ps FROM t_score where v_lessonid in " +
//					"(select v_id from t_lesson where i_type=0) group by V_stuid)  score where score.ps=1)" +
//							" or a.v_id not in (select V_stuid from t_score where " +
//							"v_lessonid in (select v_id from t_lesson where i_type=0)))";
//				}
//			}
//			//面试
//			if(params.get(QUERY_KEY_SONGPEI_XK) != null
//					&& !params.get(QUERY_KEY_SONGPEI_XK).equals("")){
//				if(params.get(QUERY_KEY_SONGPEI_XK).equals("0")){
//					back[0]+=" and a.v_id in (select v_stuid from studentassignschool where" +
//							" v_id in (select v_assignid from t_foreignaviationschoolinterview where i_result=0))";
//				}else{
//					back[0]+=" and (a.v_id in (select v_stuid from studentassignschool where" +
//					" v_id in (select v_assignid from t_foreignaviationschoolinterview where i_result=1)) or" +
//					" a.v_id not in (select v_stuid from studentassignschool))";
//				}
//				
//			}
//			
//			//成绩审查
//			if(params.get(QUERY_KEY_SONGPEI_CJ) != null
//					&& !params.get(QUERY_KEY_SONGPEI_CJ).equals("")){
//				if(params.get(QUERY_KEY_SONGPEI_CJ).equals("3")){
//					back[0]+=" and a.v_id not in (select v_stuid from t_sendqualificationreview where i_type=0)";
//				}else{
//					back[0]+=" and cj.i_result=" + Integer.parseInt(params.get(QUERY_KEY_SONGPEI_CJ).toString());
//				}
//				
//			}
//			//身体审查
//			if(params.get(QUERY_KEY_SONGPEI_ST) != null
//					&& !params.get(QUERY_KEY_SONGPEI_ST).equals("")){
//				if(params.get(QUERY_KEY_SONGPEI_ST).equals("3")){
//					back[0]+=" and a.v_id not in (select v_stuid from t_sendqualificationreview where i_type=1)";
//				}else{
//					back[0]+=" and st.i_result=" + Integer.parseInt(params.get(QUERY_KEY_SONGPEI_ST).toString());
//				}
//			}
//			//在校表现
//			if(params.get(QUERY_KEY_SONGPEI_BX) != null
//					&& !params.get(QUERY_KEY_SONGPEI_BX).equals("")){
//				if(params.get(QUERY_KEY_SONGPEI_BX).equals("3")){
//					back[0]+=" and a.v_id not in (select v_stuid from t_sendqualificationreview where i_type=2)";
//				}else{
//					back[0]+=" and bx.i_result="+ Integer.parseInt(params.get(QUERY_KEY_SONGPEI_BX).toString());
//				}
//			}
//			//所有项
//			if(params.get(QUERY_KEY_SONGPEI_ALL) != null
//					&& !params.get(QUERY_KEY_SONGPEI_ALL).equals("")){
//				int pass = + Integer.parseInt(params.get(QUERY_KEY_SONGPEI_ALL).toString());
//				if(pass==0){
//					back[0]+=" and cj.i_result=0 and st.i_result=0 and bx.i_result=0";
//					
//					back[0]+=" and a.v_id in (select V_stuid from (select V_stuid,SUM(i_pass) " +
//					"as ps FROM t_score where v_lessonid in " +
//					"(select v_id from t_lesson where i_type=0)" +
//							" group by V_stuid)  score where score.ps=0)";
//					
//					back[0]+=" and a.v_id in (select v_stuid from studentassignschool where" +
//					" v_id in (select v_assignid from t_foreignaviationschoolinterview where i_result=0))";
//				}else{
//					back[0]+=" and (a.v_id in (select V_stuid from (select V_stuid,SUM(i_pass) " +
//					"as ps FROM t_score where v_lessonid in " +
//					"(select v_id from t_lesson where i_type=0) group by V_stuid)  score where score.ps=1)" +
//							" or a.v_id not in (select V_stuid from t_score where " +
//							"v_lessonid in (select v_id from t_lesson where i_type=0))" +
//							" or a.v_id not in (select v_stuid from t_sendqualificationreview)" +
//							" or a.v_id not in (select v_stuid from studentassignschool)" +
//							" or a.v_id in (select v_stuid from studentassignschool where" +
//					" v_id in (select v_assignid from t_foreignaviationschoolinterview where i_result=1)))";
//					
//				}
//			}
//			String sql =getSql(back[0],12);
//
//			Integer pageIndex = Integer.parseInt(pageNo);
//			Page page;
//			if(back[1].equals("")){
//				page = this.pagedSQLQuery(sql, pageIndex, pageSize);
//			}else{
//				page = this.pagedSQLQuery(sql, pageIndex, pageSize,(Object[])back[1].split(","));
//			}
//			List<VStudentBaseInfo> vlist = new ArrayList<VStudentBaseInfo>();
//			VStudentBaseInfo vs;
//			
//			List<VStudentDistributionClass> scoreList;
//			VStudentDistributionClass vsc;
//			
//			String scoreHql = " from TScore where studentBaseInfo.VId=? and TLesson.IType=0";//雅思
//			String viewHql = " from TForeignaviationschoolinterview where " +
//			"studentassignschool.studentBaseInfo.VId=? order by DAuditiontime desc";
//			List<TScore> list;
//			List<Object[]> olist = page.getResult();
//			
//			List<TForeignaviationschoolinterview> viewList;
//			for(Object[] obj:olist){
//				scoreList = new ArrayList<VStudentDistributionClass>();
//				vs = new VStudentBaseInfo();
//				vs.setVId(obj[0].toString());
//				vs.setVCode(obj[1].toString());
//				vs.setVName(obj[2].toString());
//				//vs.setVGender(obj[3].toString());
//				
//				viewList = super.find(viewHql, vs.getVId());
//				if(viewList.size()>0){
//					vs.setCompanyName(viewList.get(0).getStudentassignschool().getTAbroadaviationschool().getVSchoolname());
//					vs.setCreateTime(Utilities.format(viewList.get(0).getDAuditiontime()));
//					if(viewList.get(0).getIResult()==0){
//						vs.setJg("是");
//					}else{
//						vs.setJg("否");
//					}
//				}
//				//vs.setStuTypeName(obj[4].toString());
//				//vs.setCompanyName(obj[5].toString());
//				//vs.setStuStatusName(obj[6].toString());
//				
//				//vs.setXjStatusName(obj[7].toString());
//				//vs.setFormName(obj[8].toString());
//				//vs.setFreeTypeName(obj[9].toString());
//				if(obj[10]!=null){//成绩
//					
//					if(obj[10].toString().equals("0")){
//						vs.setZy("合格");
//					}else if(obj[10].toString().equals("1")){
//						vs.setZy("不合格");
//					}else if(obj[10].toString().equals("2")){
//						vs.setZy("暂不合格");
//					}else{
//						vs.setZy("未审查");
//					}
//					
//				}else{
//					vs.setZy("未审查");
//				}
//				if(obj[11]!=null){//身体
//					if(obj[11].toString().equals("0")){
//						vs.setSyd("合格");
//					}else if(obj[11].toString().equals("1")){
//						vs.setSyd("不合格");
//					}else if(obj[11].toString().equals("2")){
//						vs.setSyd("暂不合格");
//					}else{
//						vs.setSyd("未审查");
//					}
//				}else{
//					vs.setSyd("未审查");
//				}
//				if(obj[12]!=null){//在校表现
//					if(obj[12].toString().equals("0")){
//						vs.setXxlx("合格");
//					}else if(obj[12].toString().equals("1")){
//						vs.setXxlx("不合格");
//					}else if(obj[12].toString().equals("2")){
//						vs.setXxlx("暂不合格");
//					}else{
//						vs.setXxlx("未审查");
//					}
//				}else{
//					vs.setXxlx("未审查");
//				}
//				list = super.find(scoreHql, vs.getVId());
//				for(TScore s:list){
//					vsc = new VStudentDistributionClass();
//					vsc.setVId(s.getTLesson().getVId());
//					vsc.setClassid(Utilities.getXxje(s.getDScore()));
//					scoreList.add(vsc);
//				}
//				vs.setStuClassList(scoreList);
//				vlist.add(vs);
//			}
//			
//			
//			page.setData(vlist);
//			
//			return page;
//		}catch(HibernateException e){
//			log.error("获取学生列表失败", e);
//			throw new FinanceServiceException("获取学生列表失败。", e);
//		}
//	}
//	private String getSql(String cond,int type){
//		
//		String sql = "select isnull(a.v_id,'') as v_id," +
//				"isnull(a.v_code,'') as v_code," +
//				"isnull(a.v_name,'') as v_name," +
//				"isnull(a.v_gender,'') as v_gender," +
//				"isnull(g.v_name,'') as stuTypeName," +
//				"isnull(c.v_name,'') as companyname," +
//				"isnull(f.v_name,'') as stuStatusName," +
//				"isnull(h.v_name,'') as xjStatusName," +
//				"isnull(d.v_name,'') as vform," +
//				"isnull(e.v_name,'') as freename";
//			if(type==0){
//				sql+=",isnull(a.v_classnoid,'') as v_classnoid,isnull(a.v_cardid,'') as" +
//						" v_cardid,isnull(a.v_jg,'') as v_jg,isnull(a.v_lxfs,'') as v_lxfs,isnull(a.v_jtzz,'') as v_jtzz";
//				
//				sql+=",isnull(mz.v_name,'') as mzname";
//				sql+=",isnull(whcd.v_name,'') as whcdname";
//				
//				sql+=",isnull(a.v_zzmm,'') as v_zzmm,isnull(a.v_byyx,'') as" +
//				" v_byyx,isnull(a.v_enlevel,'') as v_enlevel,isnull(a.v_zy,'') as v_zy,isnull(a.v_xlxz,'') as v_xlxz";
//				sql+=",isnull(a.v_xxlx,'') as v_xxlx";
//				
//			}
//			if(type==2){//基地
//				sql+=",isnull(i.v_name,'') as basename";
//				sql+=",isnull(outa.v_name,'') as oname";
//			}
//			if(type==3){//基地、大队
//				sql+=",isnull(i.v_name,'') as basename";
//				sql+=",isnull(ii.v_name,'') as groupname";
//			}
//			if(type==4){//基地、大队、教员
//				sql+=",isnull(i.v_name,'') as basename";
//				sql+=",isnull(ii.v_name,'') as groupname";
//				
//				sql+=",isnull(iii.v_name,'') as teachername";
//			}
//			if(type==5){//停飞
//				sql+=",bbbb.d_stopflytime,bc.d_backschooltime";
//			}
//			if(type==6){
//				sql+=",isnull(c.v_id,'') as companyid";
//				sql+=",tc.i_checkResult as tcresult,tc.D_createDate as tcdate,td.i_checkResult as tdresult,td.D_createDate as tddate";
//				sql+=",tm.d_score as tmscore,tn.d_score as tnscore";
//				sql+=",tg.v_id as tgid";
//				sql+=",score.ishg as ishg";
//			}
//		//	if(type==7){//局方证照考试推荐
//		//		sql+=",isnull(a.i_tjexam,0) as i_tjexam";
//		//		sql+=",a.d_tjexamdate as d_tjexamdate";
//		//	}
//			if(type==8){//执照
//				sql+=",isnull(a.v_cardid,'') as v_cardid";
//				sql+=",zz.d_issuetime as d_issuetime,zz.d_effectdate as d_effectdate";
//				sql+=",zz.d_lastchecktime as d_lastchecktime,zz.d_nextchecktime as d_nextchecktime";
//				sql+=",zz.v_id as zzid";
//			}
//			if(type==9){//体检合格证 生日字段，获取年龄
//				sql+=",a.d_birthday as d_birthday";
//			}
//			if(type==10 || type==12){//送配管理
//				sql+=",cj.i_result as cjresult";
//				sql+=",st.i_result as stresult";
//				sql+=",bx.i_result as bxresult";
//				sql+=",isnull(a.v_classNoid,'') as v_classNoid";
//			}
//			
//
//			sql+=" from studentBaseInfo a " +
//				"left join t_org c on a.V_companyid=c.v_id " +
//				"left join t_diction d on a.V_formid=d.v_id " +
//				"left join t_diction e on  a.V_freeTypeid=e.v_id " +
//				"left join t_diction f on a.V_stuStatusid=f.v_id " +
//				"left join t_diction g on a.V_stuTypeid=g.v_id " +
//				"left join t_diction h on a.V_xjStatusid=h.v_id ";
//			if(type==0){
//				sql+="left join t_diction mz on a.V_nationid=mz.v_id ";
//				sql+="left join t_diction whcd on a.V_whcd=whcd.v_id ";
//			}
//			if(type==2){
//				
//				sql+="left join t_stuassignbase b on a.v_id=b.v_stuid ";
//				sql+="left join t_org i on b.v_baseid= i.v_id ";
//				
//				sql+="left join t_dgdistribution assign on a.v_id=assign.v_stuid ";
//				sql+="left join t_outline outa on assign.v_outlineid= outa.v_id ";
//			}
//			if(type==3){
//				sql+="left join t_stuassignbase b on a.v_id=b.v_stuid ";
//				sql+="left join t_org i on b.v_baseid= i.v_id ";
//				
//				sql+="left join t_stuassigngroup bb on a.v_id=bb.v_stuid ";
//				sql+="left join t_org ii on bb.v_groupid= ii.v_id ";
//			}
//			if(type==4){
//				sql+="left join t_stuassignbase b on a.v_id=b.v_stuid ";
//				sql+="left join t_org i on b.v_baseid= i.v_id ";
//				
//				sql+="left join t_stuassigngroup bb on a.v_id=bb.v_stuid ";
//				sql+="left join t_org ii on bb.v_groupid= ii.v_id ";
//				
//				sql+="left join t_stuassignteacher bbb on a.v_id=bbb.v_stuid ";
//				sql+="left join teacherBaseInfo iii on bbb.v_teacherid= iii.v_id ";
//			}
//			if(type==5){
//				
//				sql+="left join t_stustopfly bbbb on a.v_id=bbbb.v_stuid ";
//				
//				sql+="left join t_gntrainbackschool bc on a.v_id=bc.v_stuid ";
//			}
//			if(type==6){
//				sql+="left join (select * from graduationDesign where i_type=0) tc on a.v_id=tc.v_stuid ";
//				sql+="left join (select * from graduationDesign where i_type=1) td on a.v_id=td.v_stuid ";
//				
//				sql+="left join (select * from newworkerandchangetrain where i_trainType=0) tm on a.v_id=tm.v_stuid ";
//				sql+="left join (select * from newworkerandchangetrain where i_trainType=1) tn on a.v_id=tn.v_stuid ";
//				
//				sql+="left join graduationStudentAssign tg on a.v_id=tg.v_stuid ";
//				
//				sql+="left join (select V_stuid,case when COUNT(i_pass)=(select count(v_id) " +
//						"from t_lesson where i_type=2) then 1 else 0 end as ishg" +
//						" FROM t_score where i_pass=0 and v_lessonid in (select" +
//						" v_id from t_lesson where i_type=2) group by V_stuid) score on a.v_id=score.V_stuid ";
//			}
//			if(type==8){
//				sql+="left join studentLicense zz on a.v_id=zz.v_stuid ";
//			}
//			if(type==10 || type==12){
//				sql+="left join (select top 1000000 i_result,v_stuid from t_sendqualificationreview where i_type=0 order by d_createdate desc) cj on a.v_id=cj.v_stuid ";
//				sql+="left join (select top 1000000 i_result,v_stuid from t_sendqualificationreview where i_type=1 order by d_createdate desc) st on a.v_id=st.v_stuid ";
//				sql+="left join (select top 1000000 i_result,v_stuid from t_sendqualificationreview where i_type=2 order by d_createdate desc) bx on a.v_id=bx.v_stuid ";
//				
//			}
//			//if(type==11 || type==7){
//			//	sql+="left join studentDistributionClass stuc on a.v_id=stuc.v_stuid ";
//			//	sql+="left join t_setClass sclass on stuc.v_classid=sclass.v_id ";
//			//}
//			sql+="where a.i_usertype=0 " + cond + " order by v_code asc,a.d_createdate desc,a.v_id desc";
//
//		return sql;
//	}
//	//学生信息编辑
//	@Transactional(readOnly = false, isolation = Isolation.READ_COMMITTED)
//	public void updateStudentBaseInfo(StudentBaseInfo student) throws FinanceServiceException {
//		
//		try {
//			
//			String hql =" from StudentBaseInfo where VId<>? and VCode=?";
//			if(super.find(hql, student.getVId() ,student.getVCode()).size()>0){
//				throw new FinanceServiceException("编辑学生信息失败，学号重复。");
//			}
//			hql =" from StudentBaseInfo where VId<>? and VCardid=?";
//			if(super.find(hql, student.getVId() ,student.getVCardid()).size()>0){
//				throw new FinanceServiceException("编辑学生信息失败，身份证号重复。");
//			}
//			super.update(student);
//		}catch (HibernateException e) {
//			throw new FinanceServiceException("编辑学生信息失败，数据库错误。");
//			
//		}
//	}
//
//	//学生信息注册
//	@Transactional(readOnly = false, isolation = Isolation.READ_COMMITTED)
//	public void saveStudentBaseInfo(StudentBaseInfo student) throws FinanceServiceException {
//		
//		try {
//			
//			String vid = student.getTDictionByVStuTypeid().getVId();
//			TDiction diction = super.get(TDiction.class, vid);//学生类型对象
//			
//			if(diction.getVId().equals("4028aa494765f33d014766018972003e")//高招生
//					|| diction.getVId().equals("4028aa494765f33d01476601b9f8003f")){//2+3
//				if(StringUtils.isBlank(student.getVCode())){
//					throw new FinanceServiceException("学生注册失败，学号必须录入。");
//				}
//				
//			}else{
//				createVCode( student, diction.getVId());//生成学号
//			}
//			if(StringUtils.isBlank(student.getVClassNoid())){
//				throw new FinanceServiceException("学生注册失败，班号必须输入。");
//			}
//			String hql =" from StudentBaseInfo where VCode=?";
//			if(super.find(hql, student.getVCode()).size()>0){
//				throw new FinanceServiceException("学生注册失败，学号重复。");
//			}
//			hql =" from StudentBaseInfo where VCardid=?";
//			if(super.find(hql, student.getVCardid()).size()>0){
//				throw new FinanceServiceException("学生注册失败，身份证号重复。");
//			}
//			student.setDCreatedate( new Date() );
//			student.setIUsertype(0);
//			student.setOpenStatus(0);
//			super.save(student);
//		}catch (HibernateException e) {
//			throw new FinanceServiceException("学生注册失败，数据库错误。");
//			
//		}
//	}
//
//	/**
//	 * 生成学号
//	 * @param student
//	 */
//	@SuppressWarnings("unchecked")
//	private void createVCode( StudentBaseInfo student ,String type){
//		
//		//if(!"2+3".equals(diction.getVName()) && !"高招生".equals(diction.getVName())){
//			//141391101
//			StringBuilder sb = new StringBuilder();
//			//第1-2位：入学年份，14代表2014年入校的学生；
//			String classid = student.getVClassNoid();
//			//sb.append( UtilDateFormat.getDate("yy") );
//			sb.append(classid.substring(0, 2));
//			//第3-4位：13代表飞行学员，固定不变；
//			sb.append( "13" );
//			//System.out.println(1);
//			//第5位：9代表4+1学生，8代表军转民，7代表短训生；
//			
//			if( "4028aa494765f33d01476601dcd20040".equals(type) ){
//				sb.append( "9" );
//			}else if( "4028aa494765f33d0147660205b70041".equals(type) ){
//				sb.append( "8" );
//			}else if( "4028aa494765f33d01476602294c0042".equals(type) ){
//				sb.append( "7" );
//			}else{
//				sb.append( "6" );//暂时添加 后期确认 
//			}
//			//第6位与第7位：代表班号，1A代表A班，1B代表B班，以此类推 0A、0B  第6为可能是0或1；
//			//sb.append( "1" );
//		//	System.out.println(student.getVClassNoid());
//			String code = getClassNo(classid);
//		//	System.out.println("code=" + code);
//			sb.append( code); //班号前台选择
//			//第8-9位：代表班内的学生学号，自动生成。
//			
//			String s = student.getVClassNoid().substring(0, 5) + code;
//			//System.out.println(s);
//			//String sql = "SELECT MAX(substring(v_code,8,2)) v_code FROM studentbaseinfo " +
//			//		"WHERE substring(v_code,7,1) = ?  ORDER BY v_code desc";
//			
//			String sql = "SELECT MAX(substring(v_code,8,2)) v_code FROM studentbaseinfo " +
//					"WHERE v_code like ?  ORDER BY v_code desc";
//			//System.out.println(sql);
//			List<Object> list = super.createSQLQuery(sql, "%" +  s + "%" ).list();
//			
//			//List<Object> list = super.createSQLQuery(sql, "1" ).list();
//			
//			if( list != null && !list.isEmpty() ){
//				
//				String value = "";
//				if(list.get(0)==null || list.get(0).equals("")){
//					value = "0";
//				}else{
//					value = (String) list.get(0);
//				}
//				int count = Integer.parseInt(value)+1;
//				
//				if( count >= 10 ){
//					//如果班级里的学生是2位数的话，直接连接就可以
//					sb.append( count );
//				}else{
//					//如果班级里的学生是1位数的话，需要前面补一个0
//					sb.append( "0"+count );
//				}
//			}else{
//				
//				sb.append( "01" );
//			}
//			//将生成的学号放入student对象中
//			student.setVCode( sb.toString() );
//		//}
//	}
//	private String getClassNo(String name){
//		String[] os = {"A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"};
//		
//		String  c = name.substring(6,7);
//		String  c0 = name.substring(5,6);
//		String b = "";
//		int flag = 0;
//		for(int i=0;i<26;i++){
//			if(os[i].equals(c)){
//				flag = i+1;
//			}
//		}
//		b = String.valueOf(flag);
//		if(flag<10){
//			b = c0+flag;
//		}
//		return b;
//	}
//	//班级列表
//	public Page readClassInfoList(Map<String, Object> params,
//			String pageNo) throws FinanceServiceException {
//		
//		int pageSize = FinanceConfig.getIntProperty("default.system.pagesize");
//
//		Criteria criteria = this.createCriteria(TSetClass.class);
//		
//		if(params.get(QUERY_KEY_NAME)!=null && !params.get(QUERY_KEY_NAME).equals("")){
//			criteria.add(Restrictions.or(Restrictions.like("VClassid", "%" + params.get(QUERY_KEY_NAME) + "%"),
//					Restrictions.like("VName", "%" + params.get(QUERY_KEY_NAME) + "%")));
//		}
//		criteria.add(Restrictions.eq("IType", 1));
//		criteria.addOrder(Order.asc("DCreatedate"));
//		Integer pageIndex = Integer.parseInt(pageNo);
//		
//		try {
//			Page page = this.pagedQuery(criteria, pageIndex, pageSize);
//			return page;
//		} catch (HibernateException e) {
//			throw new FinanceServiceException("读取信息列表失败："+e.getMessage());
//		}
//	}
//	
//	//课程设置
//	@SuppressWarnings("unchecked")
//	public Page readSetLessonList(Map<String, Object> params,
//			String pageNo) throws FinanceServiceException {
//		
//		int pageSize = FinanceConfig.getIntProperty("default.system.pagesize");
//
//		Criteria criteria = this.createCriteria(TSetClass.class);
//		
//		if(params.get(QUERY_KEY_NAME)!=null && !params.get(QUERY_KEY_NAME).equals("")){
//			criteria.add(Restrictions.or(Restrictions.like("VClassid", "%" + params.get(QUERY_KEY_NAME) + "%"),
//					Restrictions.like("VName", "%" + params.get(QUERY_KEY_NAME) + "%")));
//		}
//		criteria.add(Restrictions.eq("IType", 1));
//		criteria.addOrder(Order.asc("VName"));
//		criteria.addOrder(Order.asc("DCreatedate"));
//		Integer pageIndex = Integer.parseInt(pageNo);
//		List<VSetClass> blist = new ArrayList<VSetClass>();
//		VSetClass setc;
//		String lesson = " from TPointLine where TSetClass.VId=?";
//		
//		try {
//			Page page = this.pagedQuery(criteria, pageIndex, pageSize);
//			
//			List<TSetClass> list = page.getResult();
//			
//			for(TSetClass c:list){
//				setc = new VSetClass();
//				setc.setSetClass(c);
//				setc.setList(super.find(lesson, c.getVId()));
//				blist.add(setc);
//			}
//			
//			page.setData(blist);
//			return page;
//		} catch (HibernateException e) {
//			throw new FinanceServiceException("读取信息列表失败："+e.getMessage());
//		}
//	}
//	
//	@Transactional(readOnly = false, isolation = Isolation.READ_COMMITTED)
//	public void saveChangeStudentStatus(VStudentBaseInfo student)
//			throws FinanceServiceException {
//		try{
//			
//			//获取旧的学生状态
//			String ids = student.getVId();
//			String[] os = ids.split(",");
//			List<StudentBaseInfo> list = new ArrayList<StudentBaseInfo>();
//			for(int i=0;i<os.length;i++){
//				list.add(super.get(StudentBaseInfo.class,os[i].split(";")[0]));
//			}
//			if(list.size()==0){
//				throw new FinanceServiceException("改变学生状态失败:参数传递错误。");
//			}
//			
//			TUser user = super.get(TUser.class, student.getVName());
//			
//			List<TStuStatus> slist = new ArrayList<TStuStatus>();;
//			TStuStatus status;
//			
//			TDiction dic;
//			
//			if(student.getStuStatusName().equals("1")){//送培
//				for(StudentBaseInfo s:list){
//					if(!s.getTDictionByVStuStatusid().getVId().equals(QUERY_KEY_STUDENT_STATUS_STUDY)){
//						throw new FinanceServiceException("改变学生状态失败:选取的学生中有不是理论在学的学生。");
//					}
//					dic = super.get(TDiction.class,student.getStuTypeName());
//					
//					status = new TStuStatus();
//					status.setDChangestatustime(new Date());
//					status.setDCreatedate(new Date());
//					status.setTUser(user);
//					status.setTDictionByVOldstatusid(s.getTDictionByVStuStatusid());
//					status.setTDictionByVNewstatusid(dic);
//					status.setStudentBaseInfo(s);
//					status.setVComment("理论学员送培");
//					slist.add(status);
//					
//					s.setTDictionByVStuStatusid(dic);//改变学生状态
//				}
//				if(list.size()>0)
//					super.saveOrUpdateALL(list);
//				if(slist.size()>0)
//					super.saveOrUpdateALL(slist);
//				
//				
//				//4028aa494765f33d014765f78e55000f 理论在学 ----送培---4028aa494765f33d014765f7b9ab0010
//				
//			}
//			else if(student.getStuStatusName().equals("2")){//国内送培出发：
//				//4028aa494765f33d014765f7b9ab0010国内送培-------国内训练---4028aa494765f33d014765f7df820011
//				
//				for(StudentBaseInfo s:list){
//					
//					
//					if(!s.getTDictionByVStuStatusid().getVId().equals(QUERY_KEY_STUDENT_STATUS_GN_SONGPEI)){
//						throw new FinanceServiceException("改变学生状态失败:选取的学生中有不是送培的学生。");
//					}
//					dic = super.get(TDiction.class,QUERY_KEY_STUDENT_STATUS_GUONEI);
//					
//					
//					status = new TStuStatus();
//					status.setDChangestatustime(Utilities.parse(student.getCreateTime()));
//					status.setDCreatedate(new Date());
//					status.setTUser(user);
//					status.setTDictionByVOldstatusid(s.getTDictionByVStuStatusid());
//					status.setTDictionByVNewstatusid(dic);
//					status.setStudentBaseInfo(s);
//					status.setVComment(student.getStuTypeName());
//					slist.add(status);
//					
//					s.setTDictionByVStuStatusid(dic);
//				}
//				if(list.size()>0)
//					super.saveOrUpdateALL(list);
//				if(slist.size()>0)
//					super.saveOrUpdateALL(slist);
//				
//			}else if(student.getStuStatusName().equals("3")){//国外送培出发
//				//4028816a4b0f0b3d014b1025385a0003国外送培-------国外训练---4028aa494765f33d014765f808570012
//				
//				for(StudentBaseInfo s:list){
//					if(!s.getTDictionByVStuStatusid().getVId().equals(QUERY_KEY_STUDENT_STATUS_GW_SONGPEI)){
//						throw new FinanceServiceException("改变学生状态失败:选取的学生中有不是送培的学生。");
//					}
//					dic = super.get(TDiction.class,QUERY_KEY_STUDENT_STATUS_GUOWAI);
//					
//					
//					status = new TStuStatus();
//					status.setDChangestatustime(Utilities.parse(student.getCreateTime()));
//					status.setDCreatedate(new Date());
//					status.setTUser(user);
//					status.setTDictionByVOldstatusid(s.getTDictionByVStuStatusid());
//					status.setTDictionByVNewstatusid(dic);
//					status.setStudentBaseInfo(s);
//					status.setVComment(student.getStuTypeName());
//					slist.add(status);
//					
//					s.setTDictionByVStuStatusid(dic);//base
//					
//				}
//				if(list.size()>0)
//					super.saveOrUpdateALL(list);
//				if(slist.size()>0)
//					super.saveOrUpdateALL(slist);
//
//				
//			}
//			else if(student.getStuStatusName().equals("4")){//国内与国外调配
//				//4028aa494765f33d014765f7df820011国内---国外---4028aa494765f33d014765f808570012
//				List<TGnchangedgw> clist = new ArrayList<TGnchangedgw>();
//				TGnchangedgw change;
//				String stautsid;
//				for(StudentBaseInfo s:list){
//					stautsid= s.getTDictionByVStuStatusid().getVId();
//					if(!stautsid.equals(QUERY_KEY_STUDENT_STATUS_GN_SONGPEI)
//							&& !stautsid.equals(QUERY_KEY_STUDENT_STATUS_GW_SONGPEI)
//							){
//						throw new FinanceServiceException("改变学生状态失败:选取的学生中有既不是国内又不是国外的学生。");
//					}
//
//					if(stautsid.equals(QUERY_KEY_STUDENT_STATUS_GW_SONGPEI)){
//	
//						dic = super.get(TDiction.class,QUERY_KEY_STUDENT_STATUS_GN_SONGPEI);
//						status = new TStuStatus();
//						status.setDChangestatustime(new Date());
//						status.setDCreatedate(new Date());
//						status.setTUser(user);
//						status.setTDictionByVOldstatusid(s.getTDictionByVStuStatusid());
//						status.setTDictionByVNewstatusid(dic);
//						status.setStudentBaseInfo(s);
//						status.setVComment("国外调配到国内");
//						slist.add(status);
//						
//						s.setTDictionByVStuStatusid(dic);
//					}
//					if(stautsid.equals(QUERY_KEY_STUDENT_STATUS_GN_SONGPEI)){
//	
//						dic = super.get(TDiction.class,QUERY_KEY_STUDENT_STATUS_GW_SONGPEI);
//						status = new TStuStatus();
//						status.setDChangestatustime(new Date());
//						status.setDCreatedate(new Date());
//						status.setTUser(user);
//					
//						status.setTDictionByVOldstatusid(s.getTDictionByVStuStatusid());
//						status.setTDictionByVNewstatusid(dic);
//						status.setStudentBaseInfo(s);
//						status.setVComment("国内调配到国外");
//						slist.add(status);
//						
//						s.setTDictionByVStuStatusid(dic);
//					}
//
//					
//					change = new TGnchangedgw();
//					change.setDCreatedate(new Date());
//					change.setDChangedtime(new Date());
//					change.setStudentBaseInfo(s);
//					change.setTUser(user);
//					clist.add(change);
//						
//					
//					
//				}
//				if(list.size()>0)
//					super.saveOrUpdateALL(list);
//
//				if(slist.size()>0)
//					super.saveOrUpdateALL(slist);
//				
//				if(clist.size()>0)
//					super.saveOrUpdateALL(clist);
//				
//			}
//		}catch (ParseException e) {
//			throw new RuntimeException("改变学生状态失败，出发日期格式错误。");
//		}catch (HibernateException e) {
//			throw new RuntimeException("改变学生状态失败，数据库错误。");
//		}
//	}
//	
//	@SuppressWarnings("unchecked")
//	@Transactional(readOnly = false, isolation = Isolation.READ_COMMITTED)
//	public void saveStudentAssignBase(TStuassignbase base)
//			throws FinanceServiceException {
//		try{
//
//			String ids = base.getVId();
//			String[] os = ids.split(",");
//			List<StudentBaseInfo> list = new ArrayList<StudentBaseInfo>();
//			for(int i=0;i<os.length;i++){
//				list.add(super.get(StudentBaseInfo.class,os[i].split(";")[0]));
//			}
//			if(list.size()==0){
//				throw new FinanceServiceException("学生分配基地失败:参数传递错误。");
//			}
//			
//			List<TStuassignbase> slist = new ArrayList<TStuassignbase>();
//			TStuassignbase assignBase;
//			String hql =" from TStuassignbase where studentBaseInfo.VId=?";
//			
//			String out = " from TDgdistribution where studentBaseInfo.VId=?";
//			List<TDgdistribution> olist;
//			TDgdistribution outline;
//
//			Calendar rightNow = Calendar.getInstance(); 
//			for(StudentBaseInfo s:list){
//				if(super.find(hql, s.getVId()).size()>0){
//					throw new FinanceServiceException("学生分配基地失败:选取的学生中有已分配到基地的学生。");
//				}
//				//根据学员id获取大纲周期，计算完成训练时间。如果没有大纲，不能分配基地。
//				olist = super.find(out, s.getVId());
//				if(olist.size()==0){
//					throw new FinanceServiceException("学生分配基地失败:选取的学生中有未分配大纲的学生，请先分配大纲。");
//				}
//
//				outline=olist.get(0);
//				rightNow.setTime(base.getDStarttraindate());
//				if(outline.getIType()==0){//周
//					rightNow.add(Calendar.WEEK_OF_YEAR, outline.getICycle());
//				}else if(outline.getIType()==1){//天
//					
//					rightNow.add(Calendar.DAY_OF_YEAR, outline.getICycle());
//				}else{//月
//					rightNow.add(Calendar.MONTH, outline.getICycle());
//				}
//				assignBase = new TStuassignbase();
//				assignBase.setDFinishtraindate(rightNow.getTime());
//				assignBase.setDCreatedate(new Date());
//				assignBase.setTUser(base.getTUser());
//				assignBase.setDAssigntime(base.getDAssigntime());
//				assignBase.setDReportdate(base.getDReportdate());
//				assignBase.setDStarttraindate(base.getDStarttraindate());
//				
//				
//				assignBase.setTOrg(base.getTOrg());
//				assignBase.setStudentBaseInfo(s);
//				slist.add(assignBase);
//			}
//			if(slist.size()>0)
//				super.saveOrUpdateALL(slist);			
//			
//			
//		}catch (HibernateException e) {
//			throw new RuntimeException("学生分配基地失败，数据库错误。");
//		}
//	}
//	
//
//	@SuppressWarnings("unchecked")
//	@Transactional(readOnly = false, isolation = Isolation.READ_COMMITTED)
//	public void saveStudentChangeBase(TChangedbase base)
//			throws FinanceServiceException {
//		try{
//
//			String ids = base.getVId();
//			String[] os = ids.split(",");
//			List<StudentBaseInfo> list = new ArrayList<StudentBaseInfo>();
//			for(int i=0;i<os.length;i++){
//				list.add(super.get(StudentBaseInfo.class,os[i].split(";")[0]));
//			}
//			if(list.size()==0){
//				throw new FinanceServiceException("学生调换基地失败:参数传递错误。");
//			}
//			
//			List<TStuassignbase> bslist = new ArrayList<TStuassignbase>();
//			List<TStuassignbase> blist;
//			TStuassignbase assignBase;
//			String hql =" from TStuassignbase where studentBaseInfo.VId=?";
//			
//			String ghql = " from TStuassigngroup where studentBaseInfo.VId=?";
//			
//			
//			List<TChangedbase> slist = new ArrayList<TChangedbase>();
//			TChangedbase changeBase;
//			
//			for(StudentBaseInfo s:list){
//				if(super.find(ghql, s.getVId()).size()>0){
//					throw new FinanceServiceException("学生调换基地失败:选中的学生中有分配大队的学生。");
//				}
//				blist = super.find(hql, s.getVId());
//				assignBase = blist.get(0);
//				
//				changeBase = new TChangedbase();
//				changeBase.setTUser(base.getTUser());
//				changeBase.setStudentBaseInfo(s);
//				changeBase.setDCreatedate(new Date());
//				changeBase.setDChangedtime(base.getDChangedtime());
//				changeBase.setTOrgByVOldbaseid(assignBase.getTOrg());
//				changeBase.setTOrgByVNewbaseid(base.getTOrgByVNewbaseid());
//				slist.add(changeBase);
//				
//				
//				assignBase.setTOrg(base.getTOrgByVNewbaseid());
//				bslist.add(assignBase);
//				
//			}
//			
//			if(slist.size()>0)
//				super.saveOrUpdateALL(slist);
//			if(bslist.size()>0){
//				super.saveOrUpdateALL(bslist);
//			}
//			
//		}catch (HibernateException e) {
//			throw new RuntimeException("学生分配基地失败，数据库错误。");
//		}
//	}
//	
//	@SuppressWarnings("unchecked")
//	@Transactional(readOnly = false, isolation = Isolation.READ_COMMITTED)
//	public void escStudentAssignBase(String id,String userid) throws FinanceServiceException {
//		try{
//			String ghql = " from TStuassigngroup where studentBaseInfo.VId=?";
//			if(super.find(ghql, id).size()>0){
//				throw new FinanceServiceException("取消分配基地失败:选中的学生已分配大队。");
//			}
//			
//			String hql =" from TStuassignbase where studentBaseInfo.VId=?";
//			if(super.find(hql, id).size()==0){
//				throw new FinanceServiceException("取消分配基地失败:参数传递错误。");
//			}
//			//TStuassignbase base = ((List<TStuassignbase>)super.find(hql, id)).get(0);
//			
//			List<TStuassignbase> list = super.find(hql, id);
//			TStuassignbase base = list.get(0);
//			
//			TUser user = super.get(TUser.class, userid);
//			
//			TChangedbase change = new TChangedbase();
//			change.setDChangedtime(new Date());
//			change.setDCreatedate(new Date());
//			change.setTUser(user);
//			change.setStudentBaseInfo(base.getStudentBaseInfo());
//			change.setTOrgByVOldbaseid(base.getTOrg());
//			change.setTOrgByVNewbaseid(null);
//			super.save(change);
//		
//			
//			super.removeALL(list);
//		}catch (HibernateException e) {
//			throw new RuntimeException("取消分配基地失败，数据库错误。");
//		}
//	}
//
//	@SuppressWarnings("unchecked")
//	public List<TOrg> readOrgByUserId(String userid)
//			throws FinanceServiceException {
//		String hql = " from TOtheruser where VCode=?";
//		List<TOtheruser> olist = super.find(hql, userid);
//		String orgHql =" from TOrg where VParentid=? and VName like '%大队%'";
//		
//		if(userid.equals("sa")){//管理员
//			return super.find(" from TOrg where VName like '%大队%'");
//		}
//		
//		if(olist.size()>0){
//			TOtheruser other = olist.get(0);
//			return super.find(orgHql, other.getTOrg().getVParentid());
//
//		}
//		return null;
//	}
//	
//	@SuppressWarnings("unchecked")
//	public List<TeacherBaseInfo> readTeacherByUserId(String userid)
//			throws FinanceServiceException {
//		
//		String hql =" from TeacherBaseInfo where TOrg.VId=?";
//		
//		String thql =" from TeacherBaseInfo where VCode=?";
//		List<TeacherBaseInfo> list;
//		
//		TUser user = super.get(TUser.class, userid);
//		int userType = user.getIUserType();
//		if(userType==3){//管理员
//			return super.find(" from TeacherBaseInfo  where TDictionByVFlytype is not null " +
//					"and TDictionByVFlyform is not null and TDictionByVTecdengji is not null");
//		}else if(userType==2){//教员，获取教员所属大队
//			list = super.find(thql, user.getVUsername());
//			if(list.size()==0){
//				return null;
//			}
//			return super.find(hql, list.get(0).getTOrg().getVId());
//		}
//		return null;
//	}
//	
//	//学员大队管理
//	@Transactional(readOnly = false, isolation = Isolation.READ_COMMITTED)
//	public void saveStudentAssignGroup(TStuassigngroup base)
//			throws FinanceServiceException {
//		try{
//
//			String ids = base.getVId();
//			String[] os = ids.split(",");
//			List<StudentBaseInfo> list = new ArrayList<StudentBaseInfo>();
//			for(int i=0;i<os.length;i++){
//				list.add(super.get(StudentBaseInfo.class,os[i].split(";")[0]));
//			}
//			if(list.size()==0){
//				throw new FinanceServiceException("学生分配大队失败:参数传递错误。");
//			}
//			
//			List<TStuassigngroup> slist = new ArrayList<TStuassigngroup>();
//			TStuassigngroup assignBase;
//			String hql =" from TStuassigngroup where studentBaseInfo.VId=?";
//
//
//			for(StudentBaseInfo s:list){
//				if(super.find(hql, s.getVId()).size()>0){
//					throw new FinanceServiceException("学生分配大队失败:选取的学生中有已分配到大队的学生。");
//				}
//			
//				assignBase = new TStuassigngroup();
//				assignBase.setDCreatedate(new Date());
//				assignBase.setTUser(base.getTUser());
//				assignBase.setDAssigntime(base.getDAssigntime());				
//				assignBase.setTOrg(base.getTOrg());
//				assignBase.setStudentBaseInfo(s);
//				slist.add(assignBase);
//			}
//			if(slist.size()>0)
//				super.saveOrUpdateALL(slist);			
//			
//			
//		}catch (HibernateException e) {
//			throw new RuntimeException("学生分配大队失败，数据库错误。");
//		}
//	}
//	
//
//	@SuppressWarnings("unchecked")
//	@Transactional(readOnly = false, isolation = Isolation.READ_COMMITTED)
//	public void saveStudentChangeGroup(TChangedgroup group)
//			throws FinanceServiceException {
//		try{
//
//			String ids = group.getVId();
//			String[] os = ids.split(",");
//			List<StudentBaseInfo> list = new ArrayList<StudentBaseInfo>();
//			for(int i=0;i<os.length;i++){
//				list.add(super.get(StudentBaseInfo.class,os[i].split(";")[0]));
//			}
//			if(list.size()==0){
//				throw new FinanceServiceException("学生调换大队失败:参数传递错误。");
//			}
//			
//			List<TStuassigngroup> bslist = new ArrayList<TStuassigngroup>();
//			List<TStuassigngroup> blist;
//			TStuassigngroup assignBase;
//			String hql =" from TStuassigngroup where studentBaseInfo.VId=?";
//			
//			String ghql = " from TStuassignteacher where studentBaseInfo.VId=?";
//			
//			List<TChangedgroup> slist = new ArrayList<TChangedgroup>();
//			TChangedgroup changeBase;
//			
//			for(StudentBaseInfo s:list){
//				if(super.find(ghql, s.getVId()).size()>0){
//					throw new FinanceServiceException("学生调换大队失败:选中的学生中有分配教员的学生。");
//				}
//				blist = super.find(hql, s.getVId());
//				assignBase = blist.get(0);
//				
//				changeBase = new TChangedgroup();
//				changeBase.setTUser(group.getTUser());
//				changeBase.setStudentBaseInfo(s);
//				changeBase.setDCreatedate(new Date());
//				changeBase.setDChangedtime(group.getDChangedtime());
//				changeBase.setTOrgByVOldgroup(assignBase.getTOrg());
//				changeBase.setTOrgByVNewgroup(group.getTOrgByVNewgroup());
//				slist.add(changeBase);
//				
//				
//				assignBase.setTOrg(group.getTOrgByVNewgroup());
//				bslist.add(assignBase);
//				
//			}
//			
//			if(slist.size()>0)
//				super.saveOrUpdateALL(slist);
//			if(bslist.size()>0){
//				super.saveOrUpdateALL(bslist);
//			}
//			
//		}catch (HibernateException e) {
//			throw new RuntimeException("学生调换大队失败，数据库错误。");
//		}
//	}
//	
//	@SuppressWarnings("unchecked")
//	@Transactional(readOnly = false, isolation = Isolation.READ_COMMITTED)
//	public void escStudentAssignGroup(String id,String userid) throws FinanceServiceException {
//		try{
//			
//			String ghql = " from TStuassignteacher where studentBaseInfo.VId=?";
//			if(super.find(ghql, id).size()>0){
//				throw new FinanceServiceException("取消分配大队失败:选中的学生已分配教员。");
//			}
//			
//			String hql =" from TStuassigngroup where studentBaseInfo.VId=?";
//			if(super.find(hql, id).size()==0){
//				throw new FinanceServiceException("取消分配大队失败:参数传递错误。");
//			}
//			
//			List<TStuassigngroup> list = super.find(hql, id);
//			TStuassigngroup base = list.get(0);
//			TUser user = super.get(TUser.class, userid);
//			
//			TChangedgroup change = new TChangedgroup();
//			change.setDChangedtime(new Date());
//			change.setDCreatedate(new Date());
//			change.setTUser(user);
//			change.setStudentBaseInfo(base.getStudentBaseInfo());
//			change.setTOrgByVOldgroup(base.getTOrg());
//			change.setTOrgByVNewgroup(null);
//			super.save(change);
//			
//			super.removeALL(list);
//			
//		}catch (HibernateException e) {
//			throw new RuntimeException("取消分配大队失败，数据库错误。");
//		}
//	}
//
//	//学员教员管理
//	@Transactional(readOnly = false, isolation = Isolation.READ_COMMITTED)
//	public void saveStudentAssignTeacher(TStuassignteacher base)
//			throws FinanceServiceException {
//		try{
//
//			String ids = base.getVId();
//			String[] os = ids.split(",");
//			List<StudentBaseInfo> list = new ArrayList<StudentBaseInfo>();
//			for(int i=0;i<os.length;i++){
//				list.add(super.get(StudentBaseInfo.class,os[i].split(";")[0]));
//			}
//			if(list.size()==0){
//				throw new FinanceServiceException("学生分配教员失败:参数传递错误。");
//			}
//			
//			List<TStuassignteacher> slist = new ArrayList<TStuassignteacher>();
//			TStuassignteacher assignBase;
//			String hql =" from TStuassignteacher where studentBaseInfo.VId=?";
//
//
//			for(StudentBaseInfo s:list){
//				if(super.find(hql, s.getVId()).size()>0){
//					throw new FinanceServiceException("学生分配教员失败:选取的学生中有已分配教员的学生。");
//				}
//			
//				assignBase = new TStuassignteacher();
//				assignBase.setDCreatedate(new Date());
//				assignBase.setTUser(base.getTUser());
//				assignBase.setDAssigndate(base.getDAssigndate());				
//				assignBase.setTeacherBaseInfo(base.getTeacherBaseInfo());
//				assignBase.setStudentBaseInfo(s);
//				slist.add(assignBase);
//			}
//			if(slist.size()>0)
//				super.saveOrUpdateALL(slist);			
//			
//			
//		}catch (HibernateException e) {
//			throw new RuntimeException("学生分配教员失败，数据库错误。");
//		}
//	}
//	
//
//	@SuppressWarnings("unchecked")
//	@Transactional(readOnly = false, isolation = Isolation.READ_COMMITTED)
//	public void saveStudentChangeTeacher(TStuchangedteacher group)
//			throws FinanceServiceException {
//		try{
//
//			String ids = group.getVId();
//			String[] os = ids.split(",");
//			List<StudentBaseInfo> list = new ArrayList<StudentBaseInfo>();
//			for(int i=0;i<os.length;i++){
//				list.add(super.get(StudentBaseInfo.class,os[i].split(";")[0]));
//			}
//			if(list.size()==0){
//				throw new FinanceServiceException("学生调换教员失败:参数传递错误。");
//			}
//			
//			List<TStuassignteacher> bslist = new ArrayList<TStuassignteacher>();
//			List<TStuassignteacher> blist;
//			TStuassignteacher assignBase;
//			String hql =" from TStuassignteacher where studentBaseInfo.VId=?";
//			
//			
//		
//			
//			List<TStuchangedteacher> slist = new ArrayList<TStuchangedteacher>();
//			TStuchangedteacher changeBase;
//			
//			for(StudentBaseInfo s:list){
//			
//				blist = super.find(hql, s.getVId());
//				assignBase = blist.get(0);
//				if(assignBase.getTeacherBaseInfo().getVId().equals(group.getTeacherBaseInfoByVNewteacherid().getVId())){
//					throw new FinanceServiceException("学生调换教员失败:新教员与原教员相同。");
//				}
//				
//				changeBase = new TStuchangedteacher();
//				changeBase.setTUser(group.getTUser());
//				changeBase.setStudentBaseInfo(s);
//				changeBase.setDCreatedate(new Date());
//				changeBase.setDChangeddate(group.getDChangeddate());
//				changeBase.setTeacherBaseInfoByVOldteacherid(assignBase.getTeacherBaseInfo());
//				changeBase.setTeacherBaseInfoByVNewteacherid(group.getTeacherBaseInfoByVNewteacherid());
//				slist.add(changeBase);
//				
//				
//				assignBase.setTeacherBaseInfo(group.getTeacherBaseInfoByVNewteacherid());
//				bslist.add(assignBase);
//				
//			}
//			
//			if(slist.size()>0)
//				super.saveOrUpdateALL(slist);
//			if(bslist.size()>0){
//				super.saveOrUpdateALL(bslist);
//			}
//			
//		}catch (HibernateException e) {
//			throw new RuntimeException("学生调换教员失败，数据库错误。");
//		}
//	}
//	
//	@SuppressWarnings("unchecked")
//	@Transactional(readOnly = false, isolation = Isolation.READ_COMMITTED)
//	public void escStudentAssignTeacher(String id,String userid) throws FinanceServiceException {
//		try{
//			
//		
//			String hql =" from TStuassignteacher where studentBaseInfo.VId=?";
//			if(super.find(hql, id).size()==0){
//				throw new FinanceServiceException("取消分配教员失败:参数传递错误。");
//			}
//			
//			List<TStuassignteacher> list = super.find(hql, id);
//			TStuassignteacher base = list.get(0);
//			TUser user = super.get(TUser.class, userid);
//			
//			TStuchangedteacher change = new TStuchangedteacher();
//			change.setDChangeddate(new Date());
//			change.setDCreatedate(new Date());
//			change.setTUser(user);
//			change.setStudentBaseInfo(base.getStudentBaseInfo());
//			change.setTeacherBaseInfoByVOldteacherid(base.getTeacherBaseInfo());
//			change.setTeacherBaseInfoByVNewteacherid(null);
//			super.save(change);
//			
//			super.removeALL(list);
//			
//		}catch (HibernateException e) {
//			throw new RuntimeException("取消分配教员失败，数据库错误。");
//		}
//	}
//
//	@SuppressWarnings("unchecked")
//	public List<TOtheruser> readNormalTeacher() throws FinanceServiceException {
//		//只有角色是理论教员的人才能被分配为某个执照班的责任教员
//		String llid = "f1866a954c27de64014c3168871b004b";//理论教员id
//
//		String hql =" from TOtheruser where VCode in (select TUserByVUserid.VUsername from TUserRights where TRole.VId=?)";
//		return super.find(hql, llid);
//	}
//	
//	@SuppressWarnings("unchecked")
//	public List<TeacherBaseInfo> readTheoryTeacher() throws FinanceServiceException {
//		//String hql =" from TeacherBaseInfo where TDictionByVGeneraltype.VId=? ";
//		//只有角色是理论教员的人才能被分配为某个执照班的责任教员
//		
//		String hql =" from TeacherBaseInfo  where TDictionByVFlytype is null " +
//		"or TDictionByVFlyform is null or TDictionByVTecdengji is null";
//		return super.find(hql);//所飞机型空、技术等级、
//	}
//
//	@Transactional(readOnly = false, isolation = Isolation.READ_COMMITTED)
//	public void saveAddClassLesson(TPointLine line) throws FinanceServiceException {
//		try{
//		
//			List<TPointLine> lineList = new ArrayList<TPointLine>();
//			TPointLine sline;
//			String hql =" from TPointLine where TSetClass.VId=? and TLesson.VId=?";
//			
//			String[] os = line.getVId().split(",");
//			for(int i=0;i<os.length;i++){
//				if(super.find(hql,line.getTSetClass().getVId(), os[i].split(";")[0]).size()==0){
//					sline = new TPointLine();
//					sline.setDCreatedate(new Date());
//					sline.setTUser(line.getTUser());
//					sline.setIBktimes(Integer.parseInt(os[i].split(";")[2]));
//					sline.setDBkpointLine(Integer.parseInt(os[i].split(";")[1]));
//					sline.setDPointLine(Integer.parseInt(os[i].split(";")[1]));
//					sline.setIDays(Integer.parseInt(os[i].split(";")[3]));
//					sline.setTSetClass(line.getTSetClass());
//					sline.setTLesson(super.get(TLesson.class, os[i].split(";")[0]));
//					lineList.add(sline);
//				}
//			}
//			super.saveOrUpdateALL(lineList);
//			
//		}catch (HibernateException e) {
//			throw new FinanceServiceException("保存失败，数据库错误。");
//		}
//	}
//	
//	@Transactional(readOnly = false, isolation = Isolation.READ_COMMITTED)
//	public void saveChangeAssignAbroadSchool(Studentassignschool school)
//			throws FinanceServiceException {
//		try{
//			Studentassignschool old= super.get(Studentassignschool.class, school.getVId());
//			old.setTAbroadaviationschool(school.getTAbroadaviationschool());
//			super.update(old);
//		}catch (HibernateException e) {
//			throw new FinanceServiceException("保存分派失败，数据库错误。");
//		}
//	}
//	@Transactional(readOnly = false, isolation = Isolation.READ_COMMITTED)
//	public void saveAssignAbroadSchool(Studentassignschool school)
//			throws FinanceServiceException {
//		try{
//			String[] os =  school.getStudentBaseInfo().getVId().split(",");
//			List<Studentassignschool> slist = new ArrayList<Studentassignschool>();
//			Studentassignschool assignc;
//			String hql = " from Studentassignschool where studentBaseInfo.VId=? and TAbroadaviationschool.VId=?";
//			for(int i=0;i<os.length;i++){
//				if(super.find(hql,  os[i].split(";")[0],school.getTAbroadaviationschool().getVId()).size()>0){
//					throw new FinanceServiceException("保存分派失败，所选学生已分派选中航校。");
//				}
//				assignc = new Studentassignschool();
//				assignc.setDCreatedate(school.getDCreatedate());
//				assignc.setTUser(school.getTUser());
//				assignc.setTAbroadaviationschool(school.getTAbroadaviationschool());
//				assignc.setStudentBaseInfo(super.get(StudentBaseInfo.class, os[i].split(";")[0]));
//				slist.add(assignc);
//			}
//			
//			if(slist.size()>0){
//				super.saveOrUpdateALL(slist);
//			}
//		}catch (HibernateException e) {
//			throw new FinanceServiceException("保存分派失败，数据库错误。");
//		}
//	}
//
//	@SuppressWarnings("unchecked")
//	@Transactional(readOnly = false, isolation = Isolation.READ_COMMITTED)
//	public void saveAddInterview(String id,String userid) throws FinanceServiceException {
//		try{
//			String[] os = id.split(",");
//			TUser user = super.get(TUser.class, userid);
//			List<TAbroadtrain> trainingList = new ArrayList<TAbroadtrain>();
//			TAbroadtrain training;
//			List<TForeignaviationschoolinterview> viewList = new ArrayList<TForeignaviationschoolinterview>();
//			TForeignaviationschoolinterview view;
//			String viewHql = " from TForeignaviationschoolinterview where studentassignschool.VId=? and IResult=? and DAuditiontime=?";
//			Studentassignschool assign;
//			String hql =" from TAbroadtrain where studentassignschool.VId=?";
//			for(int i=0;i<os.length;i++){
//				
//				assign = super.get(Studentassignschool.class, os[i].split(";")[0]);
//				
//				if(super.find(viewHql, os[i].split(";")[0],Integer.parseInt(os[i].split(";")[1])
//						,Utilities.parse(os[i].split(";")[2])).size()==0){
//					view = new TForeignaviationschoolinterview();
//					
//					view.setStudentassignschool(assign);
//					view.setDCreatedate(new Date());
//					view.setTUser(user);
//					view.setIResult(Integer.parseInt(os[i].split(";")[1]));
//					view.setDAuditiontime(Utilities.parse(os[i].split(";")[2]));
//					
//					viewList.add(view);
//				}
//				
//				
//				if(super.find(hql, os[i].split(";")[0]).size()==0){
//					training = new TAbroadtrain();
//					training.setTUser(user);
//					training.setDCreatedate(new Date());
//					training.setStudentassignschool(assign);
//					if(StringUtils.isNotBlank(os[i].split(";")[3]) && os[i].split(";")[3].length()==10){
//						training.setDCgtime(Utilities.parse(os[i].split(";")[3]));
//					}
//					if(StringUtils.isNotBlank(os[i].split(";")[4]) && os[i].split(";")[4].length()==10){
//						training.setDHgtime(Utilities.parse(os[i].split(";")[4]));
//					}
//					if(StringUtils.isNotBlank(os[i].split(";")[5]) && os[i].split(";")[5].length()==10){
//						training.setDStopflytime(Utilities.parse(os[i].split(";")[5]));
//					}
//					if(os[i].split(";")[6].equals("0")){
//						training.setVReason("");
//					}else{
//						training.setVReason(os[i].split(";")[6]);
//					}
//					if(training.getVReason().equals("")){
//						training.setIStatus(0);
//					}else{
//						training.setIStatus(1);
//					}
//					trainingList.add(training);
//				}else{
//					training = ((List<TAbroadtrain>)super.find(hql, os[i].split(";")[0])).get(0);
//					
//					if(StringUtils.isNotBlank(os[i].split(";")[3]) && os[i].split(";")[3].length()==10){
//						training.setDCgtime(Utilities.parse(os[i].split(";")[3]));
//					}
//					if(StringUtils.isNotBlank(os[i].split(";")[4]) && os[i].split(";")[4].length()==10){
//						training.setDHgtime(Utilities.parse(os[i].split(";")[4]));
//					}
//					if(StringUtils.isNotBlank(os[i].split(";")[5]) && os[i].split(";")[5].length()==10){
//						training.setDStopflytime(Utilities.parse(os[i].split(";")[5]));
//					}
//					
//					if(os[i].split(";")[6].equals("0")){
//						training.setVReason("");
//					}else{
//						training.setVReason(os[i].split(";")[6]);
//					}
//					if(training.getVReason().equals("")){
//						training.setIStatus(0);
//					}else{
//						training.setIStatus(1);
//					}
//					trainingList.add(training);
//				}
//					
//				
//			}
//			
//			if(trainingList.size()>0)
//				super.saveOrUpdateALL(trainingList);
//			
//			if(viewList.size()>0){
//				super.saveOrUpdateALL(viewList);
//			}
//			
//		}catch (ParseException e) {
//			throw new RuntimeException("保存面试信息失败，日期格式错误。");
//		}
//		catch (HibernateException e) {
//			throw new RuntimeException("保存面试信息失败，数据库错误。");
//		}
//		
//	}
//	
//	@Transactional(readOnly = false, isolation = Isolation.READ_COMMITTED)
//	public void saveSetClass(TSetClass tclass) throws FinanceServiceException {
//		try{
//			String hql =" from TSetClass where VClassid=?";
//			if(super.find(hql, tclass.getVName()).size()>0){
//				throw new FinanceServiceException("新增班级失败，班级重复。。");
//			}
//			tclass.setIType(1);
//			tclass.setVClassid(tclass.getVName());
//			tclass.setDCreatedate(new Date());
//			super.save(tclass);
//			
//		}catch(HibernateException e){
//			throw new FinanceServiceException("新增班级失败，数据库错误。");
//		}
//	}
//	
//	@SuppressWarnings("unchecked")
//	@Transactional(readOnly = false, isolation = Isolation.READ_COMMITTED)
//	public void saveAddSutdentMedical(String id, String userid)
//			throws FinanceServiceException {
//		try{
//			TUser user =super.get(TUser.class, userid);
//			String[] os = id.split(",");
//			List<TStuMedical> slist = new ArrayList<TStuMedical>();
//			TStuMedical medical;
//			String hql = " from TStuMedical where studentBaseInfo.VId=?";
//			List<TStuMedical> list;
//			for(int i=0;i<os.length;i++){
//				list = super.find(hql, os[i].split(";")[0]);
//				if(list.size()==0){
//					medical = new TStuMedical();
//					medical.setDCreateDate(new Date());
//					medical.setTUser(user);
//					medical.setStudentBaseInfo(super.get(StudentBaseInfo.class, os[i].split(";")[0]));
//					medical.setILevel(Integer.parseInt(os[i].split(";")[1]));
//					if(StringUtils.isNotBlank(os[i].split(";")[2]) && os[i].split(";")[2].length()==10){
//						medical.setDResultdate(Utilities.parse(os[i].split(";")[2]));
//					}
//					
//					if(StringUtils.isNotBlank(os[i].split(";")[3]) && os[i].split(";")[3].length()==10){
//						medical.setDIssueTime(Utilities.parse(os[i].split(";")[3]));
//					}
//					if(StringUtils.isNotBlank(os[i].split(";")[4]) && os[i].split(";")[4].length()==10){
//						medical.setDUsedTime(Utilities.parse(os[i].split(";")[4]));
//					}
//					medical.setVDoctor(os[i].split(";")[5]);
//					medical.setVIssuer(os[i].split(";")[6]);
//				}else{
//					medical = list.get(0);
//					medical.setDCreateDate(new Date());
//					medical.setTUser(user);
//					medical.setStudentBaseInfo(super.get(StudentBaseInfo.class, os[i].split(";")[0]));
//					medical.setILevel(Integer.parseInt(os[i].split(";")[1]));
//					if(StringUtils.isNotBlank(os[i].split(";")[2]) && os[i].split(";")[2].length()==10){
//						medical.setDResultdate(Utilities.parse(os[i].split(";")[2]));
//					}
//					
//					if(StringUtils.isNotBlank(os[i].split(";")[3]) && os[i].split(";")[3].length()==10){
//						medical.setDIssueTime(Utilities.parse(os[i].split(";")[3]));
//					}
//					if(StringUtils.isNotBlank(os[i].split(";")[4]) && os[i].split(";")[4].length()==10){
//						medical.setDUsedTime(Utilities.parse(os[i].split(";")[4]));
//					}
//					medical.setVDoctor(os[i].split(";")[5]);
//					medical.setVIssuer(os[i].split(";")[6]);
//					
//				}
//				slist.add(medical);
//			}
//			if(slist.size()>0){
//				super.saveOrUpdateALL(slist);
//			}
//		}catch (ParseException e) {
//			throw new RuntimeException("保存体检信息失败，日期格式错误。");
//		}catch(HibernateException e){
//			throw new FinanceServiceException("保存体检信息失败，数据库错误。");
//		}
//	}
//	
//	//完成训练
//	@Transactional(readOnly = false, isolation = Isolation.READ_COMMITTED)
//	public void saveStudentFinishTraining(TGntrainbackschool finish)
//			throws FinanceServiceException {
//		try{
//			List<TGntrainbackschool> slist = new ArrayList<TGntrainbackschool>();
//			TGntrainbackschool gn;
//			//学生状态是国内训练，变成训练后在学
//			String[] os = finish.getStudentBaseInfo().getVId().split(",");
//			List<StudentBaseInfo> stul = new ArrayList<StudentBaseInfo>();
//			StudentBaseInfo student;
//			for(int i=0;i<os.length;i++){
//				
//				student = super.get(StudentBaseInfo.class, os[i].split(";")[0]);
//				//学生状态不是国内训练返回
//				if(!student.getTDictionByVStuStatusid().getVId().equals(QUERY_KEY_STUDENT_STATUS_GUONEI)
//						&&!student.getTDictionByVStuStatusid().getVId().equals(QUERY_KEY_STUDENT_STATUS_GUOWAI)
//				){
//					
//					throw new FinanceServiceException("保存完成训练信息失败，所选学生中的学生状态不全是国内或国外训练。");
//				}
//				gn = new TGntrainbackschool();
//				gn.setStudentBaseInfo(student);
//				gn.setDBackschooltime(finish.getDBackschooltime());
//				gn.setDFinishtime(finish.getDFinishtime());
//				gn.setDCreatedate(new Date());
//				gn.setIType(0);//正常完成训练。
//				gn.setTUser(finish.getTUser());
//				slist.add(gn);
//				
//				//更新学生状态变化
//				
//				student.setTDictionByVStuStatusid(super.get(TDiction.class, QUERY_KEY_STUDENT_STATUS_FINISH));
//				stul.add(student);
//			}
//			
//			if(slist.size()>0)
//				super.saveOrUpdateALL(slist);
//			if(stul.size()>0){
//				super.saveOrUpdateALL(stul);
//			}
//			
//		}catch(HibernateException e){
//			throw new RuntimeException("保存完成训练信息失败，数据库错误。");
//		}
//	}
//	//停飞
//	@Transactional(readOnly = false, isolation = Isolation.READ_COMMITTED)
//	public void saveStudentStopFly(TStustopfly stop)
//			throws FinanceServiceException {
//		try{
//			List<TStustopfly> slist = new ArrayList<TStustopfly>();
//			TStustopfly gn;
//			//学生状态是国内训练，变成训练后在学
//			String[] os = stop.getStudentBaseInfo().getVId().split(",");
//			List<StudentBaseInfo> stul = new ArrayList<StudentBaseInfo>();
//			StudentBaseInfo student;
//			for(int i=0;i<os.length;i++){
//				
//				student = super.get(StudentBaseInfo.class, os[i].split(";")[0]);
//				//学生状态不是国内训练返回
//				if(!student.getTDictionByVStuStatusid().getVId().equals(QUERY_KEY_STUDENT_STATUS_GUONEI)
//						&&!student.getTDictionByVStuStatusid().getVId().equals(QUERY_KEY_STUDENT_STATUS_GUOWAI)
//				){
//					
//					throw new FinanceServiceException("保存完成训练信息失败，所选学生中的学生状态不全是国内或国外训练。");
//				}
//				gn = new TStustopfly();
//				gn.setStudentBaseInfo(student);
//				gn.setDStopflytime(stop.getDStopflytime());
//				gn.setDCreatedate(new Date());
//				gn.setVStopflyreason(stop.getVStopflyreason());
//				gn.setTUser(stop.getTUser());
//				slist.add(gn);
//				
//				//将4+1、军转民、短训生的状态变成停飞离校
//				if(student.getTDictionByVStuTypeid().getVId().equals("4028aa494765f33d01476601dcd20040")
//						|| student.getTDictionByVStuTypeid().getVId().equals("4028aa494765f33d0147660205b70041")
//						|| student.getTDictionByVStuTypeid().getVId().equals("4028aa494765f33d01476602294c0042")
//						){
//					student.setTDictionByVStuStatusid(super.get(TDiction.class, "4028aa494765f33d014765f85a400014"));//停飞离校
//					stul.add(student);
//					//更新学生状态变化
//				}
//				
//			}
//		
//			if(slist.size()>0)
//				super.saveOrUpdateALL(slist);
//			if(stul.size()>0){
//				super.saveOrUpdateALL(stul);
//			}
//			
//		}catch(HibernateException e){
//			throw new RuntimeException("保存停飞信息失败，数据库错误。");
//		}
//	}
//	//派回学校
//	@Transactional(readOnly = false, isolation = Isolation.READ_COMMITTED)
//	public void saveStudentBackSchool(TGntrainbackschool finish)
//			throws FinanceServiceException {
//		try{
//			List<TGntrainbackschool> slist = new ArrayList<TGntrainbackschool>();
//			TGntrainbackschool gn;
//
//			String[] os = finish.getStudentBaseInfo().getVId().split(",");
//			StudentBaseInfo student;
//			String hql =" from TStustopfly where studentBaseInfo.VId=?";
//			for(int i=0;i<os.length;i++){
//				
//				if(super.find(hql, os[i].split(";")[0]).size()==0){
//					throw new FinanceServiceException("保存派回学校信息失败，所选的学生中有不是停飞的学生。");
//				}
//				student = super.get(StudentBaseInfo.class, os[i].split(";")[0]);
//				
//				gn = new TGntrainbackschool();
//				gn.setStudentBaseInfo(student);
//				gn.setDBackschooltime(finish.getDBackschooltime());
//				gn.setDCreatedate(new Date());
//				gn.setIType(1);//停飞。
//				gn.setTUser(finish.getTUser());
//				slist.add(gn);
//			}
//			if(slist.size()>0)
//				super.saveOrUpdateALL(slist);
//		}catch(HibernateException e){
//			throw new FinanceServiceException("保存派回学校信息失败，数据库错误。");
//		}
//	}
//
//
//	//停飞学籍管理
//	@Transactional(readOnly = false, isolation = Isolation.READ_COMMITTED)
//	public void saveStopFlyXjManage(Studentstatuschange xueJi)
//			throws FinanceServiceException {
//		try{
//			List<Studentstatuschange> slist = new ArrayList<Studentstatuschange>();
//			Studentstatuschange gn;
//
//			String[] os = xueJi.getStudentBaseInfo().getVId().split(",");
//			String hql =" from TStustopfly where studentBaseInfo.VId=?";
//			List<StudentBaseInfo> xjlist = new ArrayList<StudentBaseInfo>();
//			StudentBaseInfo student;
//			for(int i=0;i<os.length;i++){
//				
//				if(super.find(hql, os[i].split(";")[0]).size()==0){
//					throw new FinanceServiceException("停飞学籍管理失败，所选的学生中有不是停飞的学生。");
//				}
//				student = super.get(StudentBaseInfo.class, os[i].split(";")[0]);
//
//				//学生类型是高招生、2+3
//				if(student.getTDictionByVStuTypeid().getVId().equals("4028aa494765f33d01476601b9f8003f")//2+3
//						|| student.getTDictionByVStuTypeid().getVId().equals("4028aa494765f33d014766018972003e")//高招生
//						){
//					gn = new Studentstatuschange();
//					gn.setStudentBaseInfo(student);
//					gn.setDChangedtime(xueJi.getDChangedtime());
//					gn.setDCreatedate(new Date());
//					gn.setTUser(xueJi.getTUser());
//					gn.setVComment("停飞改变学籍。");
//					gn.setTDictionByVOldStatusid(student.getTDictionByVXjStatusid());
//					gn.setTDictionByVNewstatusid(xueJi.getTDictionByVNewstatusid());
//					
//					slist.add(gn);
//					
//					student.setTDictionByVXjStatusid(xueJi.getTDictionByVNewstatusid());//学籍更新
//					//状态更新
//					if(xueJi.getTDictionByVNewstatusid().getVId().equals("4028aa494765f33d014765fad5430020")){//学籍---停飞转专业
//						student.setTDictionByVStuStatusid(super.get(TDiction.class, "4028aa494765f33d014765f832650013"));//状态---停飞转专业
//					}else if(xueJi.getTDictionByVNewstatusid().getVId().equals("4028aa494765f33d014765fb531d0023")//结业
//							|| xueJi.getTDictionByVNewstatusid().getVId().equals("4028aa494765f33d014765fb77300024")//肄业
//							){
//						student.setTDictionByVStuStatusid(super.get(TDiction.class, "4028aa494765f33d014765f85a400014"));//状态---停飞离校
//					}
//					xjlist.add(student);
//				}
//
//				
//			}
//			if(slist.size()>0)
//				super.saveOrUpdateALL(slist);
//			if(xjlist.size()>0){
//				super.saveOrUpdateALL(xjlist);
//			}
//
//		}catch(HibernateException e){
//			throw new RuntimeException("停飞学籍管理失败，数据库错误。");
//		}
//	}
//	
//	//停飞离校
//	@SuppressWarnings("unchecked")
//	@Transactional(readOnly = false, isolation = Isolation.READ_COMMITTED)
//	public void saveStudentStopFlyOffSchool(TOffschool off)
//			throws FinanceServiceException {
//		try{
//			List<TOffschool> slist = new ArrayList<TOffschool>();
//			TOffschool gn;
//
//			String[] os = off.getStudentBaseInfo().getVId().split(",");
//			List<TUser> ulist = new ArrayList<TUser>();
//			TUser user;
//			String hql = " from TUser where VUsername=?";
//			List<TUser> list;
//			StudentBaseInfo student;
//			for(int i=0;i<os.length;i++){
//				
//				student = super.get(StudentBaseInfo.class, os[i].split(";")[0]);
//	
//				if(!student.getTDictionByVStuStatusid().getVId().equals("4028aa494765f33d014765f85a400014")////停飞离校
//					&& !student.getTDictionByVStuStatusid().getVId().equals("4028aa494765f33d014765f832650013")//转专业
//				){
//					throw new FinanceServiceException("停飞离校失败，所选学生中的学生状态不全是停飞或转专业。");
//				}
//				gn = new TOffschool();
//				gn.setStudentBaseInfo(student);
//				gn.setDOffschooltime(off.getDOffschooltime());
//				gn.setDCreatedate(new Date());
//				gn.setTUser(off.getTUser());
//				slist.add(gn);
//				
//				//账号收回
//				list = super.find(hql, student.getVCode());
//				if(list.size()>0){
//					user = list.get(0);
//					if(user!=null){
//						user.setIStatus(1);//停用
//						ulist.add(user);
//					}
//				}
//				
//			}
//			if(slist.size()>0)
//				super.saveOrUpdateALL(slist);
//			if(ulist.size()>0){
//				super.saveOrUpdateALL(ulist);
//			}
//		}catch(HibernateException e){
//			throw new FinanceServiceException("停飞离校失败，数据库错误。");
//		}
//	}
//
//	//确认毕设、领毕业证
//	@SuppressWarnings("unchecked")
//	@Transactional(readOnly = false, isolation = Isolation.READ_COMMITTED)
//	public void saveConfirmGraduationDesign(GraduationDesign design)
//			throws FinanceServiceException {
//		String type = "";
//		try{
//			
//			List<GraduationDesign> slist = new ArrayList<GraduationDesign>();
//			GraduationDesign sde;
//			String[] os = design.getStudentBaseInfo().getVId().split(",");//学生id;毕设或领毕业证是否合格(0、1);确认日期
//			StudentBaseInfo student;
//			
//			if(design.getIType()==0){
//				type = "确认毕设";
//			}else{
//				type = "领毕业证";
//			}
//			String hql = " from GraduationDesign where studentBaseInfo.VId=? and IType=?";
//			List<GraduationDesign> glist;
//			for(int i=0;i<os.length;i++){
//				student = super.get(StudentBaseInfo.class, os[i].split(";")[0]);
//				if(!student.getTDictionByVStuStatusid().getVId().equals(QUERY_KEY_STUDENT_STATUS_FINISH)
//				){
//					throw new FinanceServiceException(type + "失败，所选学生中的学生状态不全是训练后在学。");
//				}
//				glist = super.find(hql, os[i].split(";")[0],design.getIType());
//				if(glist.size()==0){
//					sde = new GraduationDesign();
//				}else{
//					sde = glist.get(0);
//				}
//				
//				sde.setDCreateDate(Utilities.parse(os[i].split(";")[2]));
//				sde.setTUser(design.getTUser());
//				sde.setIType(design.getIType());//0:毕设；1:领毕业证
//				sde.setStudentBaseInfo(student);
//				sde.setICheckResult(Integer.parseInt(os[i].split(";")[1]));
//				slist.add(sde);
//			}
//			if(slist.size()>0)
//				super.saveOrUpdateALL(slist);
//			
//		}catch(ParseException e){
//			throw new FinanceServiceException(type + "失败，日期格式错误。");
//		}
//		catch(HibernateException e){
//			throw new FinanceServiceException(type = "确认毕设失败，数据库错误。");
//		}
//	}
//	
//	//毕业分配
//	@SuppressWarnings("unchecked")
//	@Transactional(readOnly = false, isolation = Isolation.READ_COMMITTED)
//	public void saveGraduationStudentAssign(GraduationStudentAssign assign)
//			throws FinanceServiceException {
//		try{
//			List<GraduationStudentAssign> slist = new ArrayList<GraduationStudentAssign>();
//			GraduationStudentAssign sde;
//			String[] os = assign.getStudentBaseInfo().getVId().split(",");//学生id;公司id;分配日期;分配地点
//			StudentBaseInfo student;
//			String hql =" from GraduationStudentAssign where studentBaseInfo.VId=?";//只能分配一次，存在更新。
//			List<GraduationStudentAssign> glist;
//			for(int i=0;i<os.length;i++){
//				student = super.get(StudentBaseInfo.class, os[i].split(";")[0]);
//				if(!student.getTDictionByVStuStatusid().getVId().equals(QUERY_KEY_STUDENT_STATUS_FINISH)
//				){
//					throw new FinanceServiceException("确认毕设失败，所选学生中的学生状态不全是训练后在学。");
//				}
//				glist = super.find(hql, os[i].split(";")[0]);
//				if(glist.size()==0){
//					sde = new GraduationStudentAssign();
//				}else{
//					sde = glist.get(0);
//				}
//				
//				sde.setDCreatedate(new Date());
//				sde.setTUser(assign.getTUser());
//				sde.setStudentBaseInfo(student);
//				
//				sde.setTOrg(super.get(TOrg.class,os[i].split(";")[1]));
//				if(os[i].split(";")[2].length()==10){
//					sde.setVAssigndate(Utilities.parse(os[i].split(";")[2]));
//				}
//				sde.setVAssignaddress(os[i].split(";")[3]);
//				
//				slist.add(sde);
//			}
//			if(slist.size()>0)
//				super.saveOrUpdateALL(slist);
//			
//		}catch(ParseException e){
//			throw new FinanceServiceException("毕业生分配失败，日期格式错误。");
//		}catch(HibernateException e){
//			throw new FinanceServiceException("毕业生分配失败，数据库错误。");
//		}
//	}
//	
//	//毕业离校
//	@SuppressWarnings("unchecked")
//	@Transactional(readOnly = false, isolation = Isolation.READ_COMMITTED)
//	public void saveStudentGraduationOffSchool(TOffschool off)
//			throws FinanceServiceException {
//		try{
//			List<TOffschool> slist = new ArrayList<TOffschool>();
//			TOffschool gn;
//
//			String[] os = off.getStudentBaseInfo().getVId().split(",");//学生id;毕业证日期;实际离校日期
//			List<TUser> ulist = new ArrayList<TUser>();
//			TUser user;
//			String hql = " from TUser where VUsername=?";
//			List<StudentBaseInfo> stuList = new ArrayList<StudentBaseInfo>();
//			StudentBaseInfo student;
//			List<TUser> list;
//			for(int i=0;i<os.length;i++){
//				
//				student = super.get(StudentBaseInfo.class, os[i].split(";")[0]);
//	
//				if(!student.getTDictionByVStuStatusid().getVId().equals(QUERY_KEY_STUDENT_STATUS_FINISH)){//训练后在学
//					
//					throw new FinanceServiceException("正常毕业离校失败，所选学生中的学生状态不全是训练后在学。");
//				}
//				gn = new TOffschool();
//				gn.setStudentBaseInfo(student);
//				gn.setDFinishtime(Utilities.parse(os[i].split(";")[1]));
//				gn.setDOffschooltime(Utilities.parse(os[i].split(";")[2]));
//				
//				gn.setDCreatedate(new Date());
//				gn.setTUser(off.getTUser());
//				slist.add(gn);
//				
//				//账号收回
//				list = super.find(hql, student.getVCode());
//				if(list.size()>0){
//					user = list.get(0);
//					if(user!=null){
//						user.setIStatus(1);//停用
//						ulist.add(user);
//					}
//				}
//				
//				//更改学生状态（离校）与学籍状态(毕业)
//				student.setTDictionByVStuStatusid(super.get(TDiction.class, QUERY_KEY_STUDENT_STATUS_OFF_SCHOOL));//状态-离校
//				student.setTDictionByVXjStatusid(super.get(TDiction.class, "4028aa494765f33d014765fa87fd001e"));//学籍-毕业
//				stuList.add(student);
//				
//				//更改学生状态表
//				
//				//学籍状态表
//			}
//			if(slist.size()>0)
//				super.saveOrUpdateALL(slist);
//			if(ulist.size()>0){
//				super.saveOrUpdateALL(ulist);
//			}
//			if(stuList.size()>0){
//				super.saveOrUpdateALL(stuList);
//			}
//		}catch(ParseException p){
//			throw new RuntimeException("正常毕业离校失败，日期格式错误。");
//		}
//		catch(HibernateException e){
//			throw new RuntimeException("正常毕业离校失败，数据库错误。");
//		}
//	}
//	
//	@SuppressWarnings("unchecked")
//	@Transactional(readOnly = false, isolation = Isolation.READ_COMMITTED)
//	public void saveNewWorkerAndChangeTrain(Newworkerandchangetrain score)
//			throws FinanceServiceException {
//		try{
//			List<Newworkerandchangetrain> slist = new ArrayList<Newworkerandchangetrain>();
//			Newworkerandchangetrain sde;
//			String[] os = score.getStudentBaseInfo().getVId().split(",");//学生id;开始日期;结束日期;成绩
//			StudentBaseInfo student;
//			String hql = " from Newworkerandchangetrain where studentBaseInfo.VId=? and ITrainType=?";
//			List<Newworkerandchangetrain> nlist;
//			
//			for(int i=0;i<os.length;i++){
//				student = super.get(StudentBaseInfo.class, os[i].split(";")[0]);
//				if(!student.getTDictionByVStuStatusid().getVId().equals(QUERY_KEY_STUDENT_STATUS_FINISH)
//				){
//					throw new FinanceServiceException("确认毕设失败，所选学生中的学生状态不全是训练后在学。");
//				}
//				nlist = super.find(hql, os[i].split(";")[0],score.getITrainType());
//				if(nlist.size()==0){
//					sde = new Newworkerandchangetrain();
//				}else{
//					sde = nlist.get(0);
//				}
//				sde.setDCreatedate(new Date());
//				sde.setTUser(score.getTUser());
//				sde.setStudentBaseInfo(student);
//				sde.setITrainType(score.getITrainType());//0:培训;1:训练
//				
//				
//				if(os[i].split(";")[1].length()==10){
//					sde.setDStarttime(Utilities.parse(os[i].split(";")[1]));
//				}
//				if(os[i].split(";")[2].length()==10){
//					sde.setDEndtime(Utilities.parse(os[i].split(";")[2]));
//				}
//				if(os[i].split(";")[3]!=null && !os[i].split(";")[3].equals("")){
//					sde.setDScore(Double.parseDouble(os[i].split(";")[3]));
//				}
//				slist.add(sde);
//			}
//			if(slist.size()>0)
//				super.saveOrUpdateALL(slist);
//		}catch(ParseException p){
//			throw new FinanceServiceException("录入成绩失败，日期格式错误。");
//		}catch(HibernateException e){
//			throw new FinanceServiceException("录入成绩失败，数据库错误。");
//		}
//	}
//	
//	//保存成绩
//	@SuppressWarnings("unchecked")
//	@Transactional(readOnly = false, isolation = Isolation.READ_COMMITTED)
//	public void saveAddLessonScore(TScore lessonScore)
//			throws FinanceServiceException {
//		try{
//			String lessonid = lessonScore.getTLesson().getVId();
//			String classid = lessonScore.getTSetClass().getVId();
//			TSetClass className = lessonScore.getTSetClass();
//			//1.获取分数线与补考次数
//			double pline =0;
//			int times =3;
//			String lHql = " from TPointLine where TLesson.VId=? and TSetClass.VId=?";
//			List<TPointLine> plist = super.find(lHql, lessonid,classid);
//			
//			if(plist.size()>0){
//				pline = plist.get(0).getDPointLine();
//				times = plist.get(0).getIBktimes();
//			}else{
//				pline = 80;
//			}
//			
//			List<TScore> slist = new ArrayList<TScore>();
//			TScore sde;
//			String[] os = lessonScore.getStudentBaseInfo().getVId().split(",");//学生id;成绩;考试日期
//			StudentBaseInfo student;
//			String hql = " from TScore where studentBaseInfo.VId=? and TLesson.VId=? and TSetClass.VId=?";
//			List<TScore> nlist;
//			List<THistoryscore> hlist = new ArrayList<THistoryscore>();
//			THistoryscore history;//ITimes  存储是否补考成绩 1:新成绩2:补考成绩
//			//IPass  存储保存还是保存并提交审核1:保存2:保存并提交审核
//			
//			
//			int ifaudit = lessonScore.getIPass();
//			
//			List<TScore> clist;
//			String sHql = " from TScore where studentBaseInfo.VId=? and TLesson.VId=? and DExamTime=? and TSetClass.VId=?";//判断是否重复
//			
//			String hisHql = " from THistoryscore where DExamtime=? and TScore.VId=?";//历史成绩是否重复
//			
//			List<THistoryscore> hisList;
//			
//			for(int i=0;i<os.length;i++){
//
//				clist = super.find(sHql, os[i].split(";")[0],lessonid,lessonScore.getDExamTime(),classid);
//				if(!os[i].split(";")[1].equals("-1") && clist.size()>0){
//					throw new FinanceServiceException("录入成绩失败，选定的考试时间，学生成绩重复。");
//				}
//				nlist = super.find(hql, os[i].split(";")[0],lessonid,classid);
//				if(!os[i].split(";")[1].equals("-1")){
//					
//					if(nlist.size()>0 && nlist.get(0).getITimes()==times+1){
//						throw new FinanceServiceException("录入成绩失败，补考成绩超过限制次数。");
//					}
//					if(nlist.size()>0){
//						hisList = super.find(hisHql, lessonScore.getDExamTime(),nlist.get(0).getVId());
//						if(hisList.size()>0){
//							throw new FinanceServiceException("录入成绩失败，选定的考试时间，学生成绩重复。");
//						}
//					}
//				}
//				student = super.get(StudentBaseInfo.class, os[i].split(";")[0]);
//				
//				/*
//				if(lessonScore.getITimes()==1 && nlist.size()>0 && !os[i].split(";")[1].equals("-1")){
//					throw new FinanceServiceException("录入新成绩失败，所选学生中有学生已经有该课程成绩。");
//				}
//				if(lessonScore.getITimes()==2 && nlist.size()==0 && !os[i].split(";")[1].equals("-1")){
//					throw new FinanceServiceException("录入补考成绩失败，所选学生中有学生没有以往成绩。");
//				}
//				*/
//				if(nlist.size()==0){//录入新成绩 0:未提交审核1:提交审核2:审核通过 3:审核未通过4
//					if(!os[i].split(";")[1].equals("-1")){//-1表示未考试
//						sde = new TScore();
//						sde.setTUserByVCreateUserId(lessonScore.getTUserByVCreateUserId());
//						sde.setDCreateDate(new Date());
//						sde.setStudentBaseInfo(student);
//						sde.setTLesson(lessonScore.getTLesson());
//						sde.setTSetClass(className);
//						if(os[i].split(";")[1]!=null && !os[i].split(";")[1].equals("")){
//							sde.setDScore(Double.parseDouble(os[i].split(";")[1]));
//						}
//						sde.setDExamTime(lessonScore.getDExamTime());
//						
//						sde.setITimes(1);//第一次考试
//						if(ifaudit==1){//保存
//							sde.setIAudit(0);
//						}else{//提交审核
//							sde.setIAudit(1);
//						}
//						
//						if(sde.getDScore()>=pline){
//							sde.setIPass(0);
//						}else{
//							sde.setIPass(1);
//						}
//						slist.add(sde);
//					}
//					
//				}else{//录入补考成绩
//					if(!os[i].split(";")[1].equals("-1")){//-1表示未考试
//						sde = nlist.get(0);
//						//首先复制到历史成绩表
//						history = new THistoryscore();
//						history.setDAuditDate(sde.getDAuditDate());
//						history.setDCreateDate(sde.getDCreateDate());
//						history.setTUserByVCreateUserId(sde.getTUserByVCreateUserId());
//						history.setTUserByVAuditUserId(sde.getTUserByVAuditUserId());
//						history.setDExamtime(sde.getDExamTime());
//						history.setTScore(sde);
//						history.setDScore(sde.getDScore());
//						hlist.add(history);
//						
//						//然后更新主成绩表
//						sde.setTUserByVCreateUserId(lessonScore.getTUserByVCreateUserId());
//						sde.setDCreateDate(new Date());
//						
//						sde.setDExamTime(lessonScore.getDExamTime());
//						
//						if(os[i].split(";")[1]!=null && !os[i].split(";")[1].equals("")){
//							sde.setDScore(Double.parseDouble(os[i].split(";")[1]));
//						}
//						sde.setITimes(sde.getITimes()+1);//以往历次成绩次数+1
//						if(ifaudit==1){//保存
//							sde.setIAudit(0);
//						}else{//提交审核
//							sde.setIAudit(1);
//						}
//						
//						if(sde.getDScore()>=pline){
//							sde.setIPass(0);
//						}else{
//							sde.setIPass(1);
//						}
//						slist.add(sde);
//					}
//				}
//				
//			}
//			if(slist.size()>0)
//				super.saveOrUpdateALL(slist);
//			if(hlist.size()>0){
//				super.saveOrUpdateALL(hlist);				
//			}
//		}catch(HibernateException e){
//			throw new FinanceServiceException("录入成绩失败，数据库错误。");
//		}
//	}
//	
//	@SuppressWarnings("unchecked")
//	@Transactional(readOnly = false, isolation = Isolation.READ_COMMITTED)
//	public void saveAuditLessonScore(String id) throws FinanceServiceException {
//		try{
//			String[] os = id.split(",");
//			List<TScore> slist = new ArrayList<TScore>();
//			String hql =" from TScore where IAudit=0 and TLesson.VId=?";
//			List<TScore> list;
//			for(int i=0;i<os.length;i++){
//				list = super.find(hql, os[i]);
//				for(TScore s:list){
//					s.setIAudit(1);
//					slist.add(s);
//				}
//			}
//			if(slist.size()>0){
//				super.saveOrUpdateALL(slist);
//			}
//		}catch(HibernateException e){
//			throw new FinanceServiceException("成绩提交审核失败，数据库错误。");
//		}
//	}
//	
//
//	@Transactional(readOnly = false, isolation = Isolation.READ_COMMITTED)
//	public void saveSutdentLicenseExam(RecommendStudentLicenseExam stu)
//			throws FinanceServiceException {
//		try{
//			String[] os = stu.getVId().split(",");
//			//List<StudentBaseInfo> slist = new ArrayList<StudentBaseInfo>();
//			List<RecommendStudentLicenseExam> slist = new ArrayList<RecommendStudentLicenseExam>();
//			RecommendStudentLicenseExam exam;
//			StudentBaseInfo student;
//		
//			for(int i=0;i<os.length;i++){
//				
//				exam = new RecommendStudentLicenseExam();
//				student = super.get(StudentBaseInfo.class, os[i]);
//				exam.setStudentBaseInfo(student);
//				exam.setTLesson(stu.getTLesson());
//				exam.setTOtheruser(stu.getTOtheruser());
//				exam.setDExamDate(stu.getDExamDate());
//				exam.setDCreateDate(new Date());
//				exam.setDTjdate(new Date());
//				slist.add(exam);
//			}
//			if(slist.size()>0){
//				super.saveOrUpdateALL(slist);
//			}
//		}catch(HibernateException e){
//			throw new FinanceServiceException("保存推荐局方证照考试失败，数据库错误。");
//		}
//	}
//	
//	@Transactional(readOnly = false, isolation = Isolation.READ_COMMITTED)
//	public void saveStudentLicense(StudentLicense license)
//			throws FinanceServiceException {
//		try{
//			String hql =" from StudentLicense where studentBaseInfo.VId=?";
//			if(super.find(hql, license.getStudentBaseInfo().getVId()).size()>0){
//				throw new FinanceServiceException("保存学生执照信息失败，所选学生已经有执照。");
//			}
//			license.setDCreatedate(new Date());
//			super.save(license);
//		}catch(HibernateException e){
//			throw new FinanceServiceException("保存学生执照信息失败，数据库错误。");
//		}
//	}
//
//	@SuppressWarnings("unchecked")
//	public StudentLicense readStudentLicense(String studentid)
//			throws FinanceServiceException {
//		String hql =" from StudentLicense where studentBaseInfo.VId=?";
//		List<StudentLicense> list = super.find(hql, studentid);
//		if(list==null)
//			return null;
//		return list.get(0);
//	}
//	
//	@SuppressWarnings("unchecked")
//	@Transactional(readOnly = false, isolation = Isolation.READ_COMMITTED)
//	public void updateStudentLicense(StudentLicense license)
//			throws FinanceServiceException {
//		try{
//			String type = license.getVBeizhu().split(",")[1];//up、edit
//			String beizhu = license.getVBeizhu().split(",")[0];//是否监控
//			StudentLicense old = super.get(StudentLicense.class, license.getVId());
//			
//			if(type.equals("edit")){
//				old.setVCardid(license.getVCardid());
//				old.setDEffectdate(license.getDEffectdate());
//				old.setVIssuer(license.getVIssuer());
//				old.setDIssuetime(license.getDIssuetime());
//				old.setVCompany(license.getVCompany());
//				old.setDUpdatedate(license.getDUpdatedate());
//				old.setTDiction(license.getTDiction());
//				old.setVZhizhaoxingzhi(license.getVZhizhaoxingzhi());
//				if(license.getVHangkongqileibie().equals("297ea69a483310cd01483326f442000e")){//飞机
//					old.setVXuanzhuanjijibie("");
//				}
//				if(license.getVHangkongqileibie().equals("297ea69a483310cd014833271c94000f")){//旋翼机
//					old.setVFeijijibie("");
//				}
//				old.setVHangkongqileibie(license.getVHangkongqileibie());
//				old.setVZhizhaodengji(license.getVZhizhaodengji());
//				old.setVFeijijibie(license.getVFeijijibie());
//				old.setVXuanzhuanjijibie(license.getVXuanzhuanjijibie());
//				old.setVHkqdj(license.getVHkqdj());
//				old.setVBeizhu(beizhu);
//				
//				super.update(old);
//			}else if(type.equals("up")){
//				//1.旧执照保存历史
//				StudentLicensehistory history = new StudentLicensehistory();
//				
//				history.setStudentLicense(old);
//				history.setStudentBaseInfo(old.getStudentBaseInfo());
//				history.setTUser(old.getTUser());
//				history.setDCreatedate(old.getDCreatedate());
//				history.setVCardid(old.getVCardid());
//				history.setDEffectdate(old.getDEffectdate());
//				history.setVIssuer(old.getVIssuer());
//				history.setDIssuetime(old.getDIssuetime());
//				history.setVCompany(old.getVCompany());
//				history.setDUpdatedate(old.getDUpdatedate());
//				history.setTDiction(old.getTDiction());
//				history.setVZhizhaoxingzhi(old.getVZhizhaoxingzhi());
//				history.setVHangkongqileibie(old.getVHangkongqileibie());
//				history.setVZhizhaodengji(old.getVZhizhaodengji());
//				history.setVFeijijibie(old.getVFeijijibie());
//				history.setVXuanzhuanjijibie(old.getVXuanzhuanjijibie());
//				history.setVHkqdj(old.getVHkqdj());
//				history.setVBeizhu(old.getVBeizhu());
//				
//				super.save(history);
//				//执照检查表
//				String hql1 = "from StudentLicenseskilledcheck where studentLicense.VId=? and studentLicensehistory is null";
//				List<StudentLicenseskilledcheck> list = super.find(hql1, old.getVId());
//				for(StudentLicenseskilledcheck tt:list){
//					tt.setStudentLicensehistory(history);
//					list.add(tt);
//				}
//				if(list.size()>0)
//					super.saveOrUpdateALL(list);
//				
//				//2.更新执照
//				old.setVCardid(license.getVCardid());
//				old.setDEffectdate(license.getDEffectdate());
//				old.setVIssuer(license.getVIssuer());
//				old.setDIssuetime(license.getDIssuetime());
//				old.setVCompany(license.getVCompany());
//				old.setDUpdatedate(license.getDUpdatedate());
//				old.setTDiction(license.getTDiction());
//				old.setVZhizhaoxingzhi(license.getVZhizhaoxingzhi());
//				if(license.getVHangkongqileibie().equals("297ea69a483310cd01483326f442000e")){//飞机
//					old.setVXuanzhuanjijibie("");
//				}
//				if(license.getVHangkongqileibie().equals("297ea69a483310cd014833271c94000f")){//旋翼机
//					old.setVFeijijibie("");
//				}
//				old.setVHangkongqileibie(license.getVHangkongqileibie());
//				old.setVZhizhaodengji(license.getVZhizhaodengji());
//				old.setVFeijijibie(license.getVFeijijibie());
//				old.setVXuanzhuanjijibie(license.getVXuanzhuanjijibie());
//				old.setVHkqdj(license.getVHkqdj());
//				old.setVBeizhu(beizhu);
//				super.update(old);
//			}
//			
//			
//		}catch(HibernateException e){
//			throw new RuntimeException("更新学生执照信息失败，数据库错误。");
//		}
//	}
//
//	@SuppressWarnings("unchecked")
//	public List<VStudentLicense> readLicenseStudentById(String id)
//			throws FinanceServiceException {
//		String hql = " from StudentLicense where studentBaseInfo.VId=?";
//		String check = " from StudentLicenseskilledcheck where studentLicense.VId=? and " +
//				"studentLicensehistory is null order by DCreatedate desc";
//		String update = " from StudentLicensehistory where studentLicense.VId=?";
//		
//		List<VStudentLicense> vlist = new ArrayList<VStudentLicense>();
//		try {
//			List<StudentLicense> list = super.find(hql, id);
//			if(list.size()==0){
//				
//				return null;
//			}
//			StudentLicense old  = list.get(0);
//			VStudentLicense te = new VStudentLicense();
//			te.setVCode(old.getStudentBaseInfo().getVCode());
//			te.setVId(old.getVId());
//			te.setVName(old.getStudentBaseInfo().getVName());
//			te.setVCardid(old.getVCardid());
//			te.setTuserId(old.getTDiction().getVName());
//
//			te.setDResultdate(Utilities.format(old.getDLastchecktime()));//上一次熟练检查日期
//			te.setDIssueTime(Utilities.format(old.getDIssuetime()));//签发日期
//			te.setDUsedTime(Utilities.format(old.getDEffectdate()));//有效期
//			te.setVDoctor(Utilities.format(old.getDNextchecktime()));//下一熟练检查日期
//			te.setCheckList(readTeaLicenseCheckList(id));
//
//			te.setIExam(super.find(check, old.getVId()).size());//是否有检查信息
//			long l1 = old.getDEffectdate().getTime();
//			long l2 = new Date().getTime();
//			long dd = (l1-l2)/1000/3600/24 + 1;
//			int d = (int)dd;
//			te.setIday(d);//剩余天数
//			te.setUsed(0);//在用
//			vlist.add(te);
//			
//			List<StudentLicensehistory> ulist = super.find(update, old.getVId());
//
//			for(StudentLicensehistory u:ulist){
//				
//				
//				te = new VStudentLicense();
//				te.setVCode(old.getStudentBaseInfo().getVCode());
//				te.setVId(u.getVId());
//				te.setVName(old.getStudentBaseInfo().getVName());
//				te.setVCardid(u.getVCardid());
//				te.setTuserId(u.getTDiction().getVName());
//
//				te.setCheckList(readTeaLicenseCheckListById(u.getVId()));
//				te.setDResultdate(Utilities.format(u.getDLastchecktime()));//上一次熟练检查日期
//				te.setDIssueTime(Utilities.format(u.getDIssuetime()));//签发日期
//				te.setDUsedTime(Utilities.format(u.getDEffectdate()));//有效期
//				te.setVDoctor(Utilities.format(u.getDNextchecktime()));//下一熟练检查日期
//
//				te.setIExam(super.find(check, u.getVId()).size());//是否有检查信息
//				l1 = u.getDEffectdate().getTime();
//				l2 = new Date().getTime();
//				dd = (l1-l2)/1000/3600/24 + 1;
//				d = (int)dd;
//				te.setIday(d);//剩余天数
//				te.setUsed(1);//历史
//				vlist.add(te);
//			}
//			
//			
//		} catch (HibernateException e) {
//			e.printStackTrace();
//			throw new FinanceServiceException("历史执照信息列表失败！", e);
//		}
//		return vlist;
//	}
//	
//	@SuppressWarnings("unchecked")
//	private List<VOTTeaLicenseskilledcheck> readTeaLicenseCheckListById(String uid)
//			throws FinanceServiceException {
//		String hql =" from StudentLicenseskilledcheck where studentLicensehistory.VId=?";
//		List<StudentLicenseskilledcheck> list = super.find(hql, uid);
//		
//		List<VOTTeaLicenseskilledcheck> bList = new ArrayList<VOTTeaLicenseskilledcheck>();
//		VOTTeaLicenseskilledcheck vo;
//		for(StudentLicenseskilledcheck t:list){
//
//			vo = new VOTTeaLicenseskilledcheck();
//			vo.setViewDCheckdate(Utilities.format(t.getDCheckdate()));
//			
//			//检查类型
//			if(t.getIChecktype()==0){
//				vo.setTypeName("熟练检查");
//			}else if(t.getIChecktype()==1){
//				vo.setTypeName("定期检查");
//			}else{
//				vo.setTypeName("实践考试");
//			}
//			vo.setVFlyform(t.getVFlyform());
//			vo.setVCheckteacher(t.getVCheckteacher());
//			vo.setViewDEffectdate(Utilities.format(t.getDEffectdate()));
//			long l1 = t.getDEffectdate().getTime();
//			long l2 = new Date().getTime();
//			long dd = (l1-l2)/1000/3600/24 + 1;
//			int d = (int)dd;
//			vo.setIday(d);//剩余天数
//			bList.add(vo);
//		}
//		return bList;
//	}
//	@SuppressWarnings("unchecked")
//	public List<VOTTeaLicenseskilledcheck> readTeaLicenseCheckList(String teaid)
//			throws FinanceServiceException {
//		String hql =" from StudentLicenseskilledcheck where studentLicense.studentBaseInfo.VId=? and  studentLicensehistory is null";
//		List<StudentLicenseskilledcheck> list = super.find(hql, teaid);
//		
//		List<VOTTeaLicenseskilledcheck> bList = new ArrayList<VOTTeaLicenseskilledcheck>();
//		VOTTeaLicenseskilledcheck vo;
//		for(StudentLicenseskilledcheck t:list){
//			vo = new VOTTeaLicenseskilledcheck();
//			vo.setViewDCheckdate(Utilities.format(t.getDCheckdate()));
//			
//			//检查类型
//			if(t.getIChecktype()==0){
//				vo.setTypeName("熟练检查");
//			}else if(t.getIChecktype()==1){
//				vo.setTypeName("定期检查");
//			}else{
//				vo.setTypeName("实践考试");
//			}
//			vo.setVFlyform(t.getVFlyform());
//			vo.setVCheckteacher(t.getVCheckteacher());
//			vo.setViewDEffectdate(Utilities.format(t.getDEffectdate()));
//			long l1 = t.getDEffectdate().getTime();
//			long l2 = new Date().getTime();
//			long dd = (l1-l2)/1000/3600/24 + 1;
//			int d = (int)dd;
//			vo.setIday(d);//剩余天数
//			bList.add(vo);
//		}
//		return bList;
//	}
//
//	public StudentBaseInfo readStudentBaseInfo(String id)
//			throws FinanceServiceException {
//		return super.get(StudentBaseInfo.class, id);
//	}
//
//	public VStudentLicense readVStudentLicense(String id, String type)
//			throws FinanceServiceException {
//		
//		try{
//			
//			if(type==null || type.equals("0")){
//				VStudentLicense vs = new VStudentLicense();
//				StudentLicense license = super.get(StudentLicense.class, id);
//				vs.setVCode(license.getStudentBaseInfo().getVCode());
//				vs.setVName(license.getStudentBaseInfo().getVName());
//				vs.setVCompany(license.getVCompany());
//				vs.setVCardid(license.getVCardid());
//				vs.setDIssuetime(Utilities.format(license.getDIssuetime()));
//				vs.setDEffectdate(Utilities.format(license.getDEffectdate()));
//				vs.setDUpdatedate(Utilities.format(license.getDUpdatedate()));
//				vs.setVIssuer(license.getVIssuer());
//				vs.setILevel(license.getTDiction().getVName());
//				if(license.getVBeizhu().equals("1")){
//					vs.setVBeizhu("监控");
//				}else{
//					vs.setVBeizhu("不监控");
//				}
//				vs.setVZhizhaoxingzhi(license.getVZhizhaoxingzhi());
//				
//				vs.setVHangkongqileibie(super.get(TDiction.class,license.getVHangkongqileibie()).getVName());
//				
//				vs.setVZhizhaodengji(getName(license.getVZhizhaodengji()));//仪表等级
//				
//				vs.setVFeijijibie(getName(license.getVFeijijibie()));//飞机级别等级
//				
//				vs.setVXuanzhuanjijibie(getName(license.getVXuanzhuanjijibie()));//旋翼机级别等级
//				
//				vs.setVHkqdj(getName(license.getVHkqdj()));//航空器型别等级
//				return vs;
//			}else{
//				StudentLicensehistory license =super.get(StudentLicensehistory.class, id);
//				VStudentLicense vs = new VStudentLicense();
//				vs.setVCode(license.getStudentBaseInfo().getVCode());
//				vs.setVName(license.getStudentBaseInfo().getVName());
//				vs.setVCompany(license.getVCompany());
//				vs.setVCardid(license.getVCardid());
//				vs.setDIssuetime(Utilities.format(license.getDIssuetime()));
//				vs.setDEffectdate(Utilities.format(license.getDEffectdate()));
//				vs.setDUpdatedate(Utilities.format(license.getDUpdatedate()));
//				vs.setVIssuer(license.getVIssuer());
//				vs.setILevel(license.getTDiction().getVName());
//				if(license.getVBeizhu().equals("1")){
//					vs.setVBeizhu("监控");
//				}else{
//					vs.setVBeizhu("不监控");
//				}
//				vs.setVZhizhaoxingzhi(license.getVZhizhaoxingzhi());
//				
//				vs.setVHangkongqileibie(super.get(TDiction.class,license.getVHangkongqileibie()).getVName());
//				
//				vs.setVZhizhaodengji(getName(license.getVZhizhaodengji()));//仪表等级
//				
//				vs.setVFeijijibie(getName(license.getVFeijijibie()));//飞机级别等级
//				
//				vs.setVXuanzhuanjijibie(getName(license.getVXuanzhuanjijibie()));//旋翼机级别等级
//				
//				vs.setVHkqdj(getName(license.getVHkqdj()));//航空器型别等级
//				return vs;
//			}
//			
//		}catch (HibernateException e) {
//			e.printStackTrace();
//			throw new FinanceServiceException("获取执照信息列失败！", e);
//		}
//		
//	}
//	private String getName(String str){
//		if(StringUtils.isBlank(str)){
//			return "";
//		}
//		String[] os = str.split(",");
//		String back="";
//		for(int i=0;i<os.length;i++){
//			if(i==os.length-1){
//				back+= super.get(TDiction.class,os[i]).getVName();
//			}else{
//				back+= super.get(TDiction.class,os[i]).getVName() + "、";
//			}
//		}
//		
//		return back;
//	}
//	
//
//	@SuppressWarnings("unchecked")
//	@Transactional(readOnly = false, isolation = Isolation.READ_COMMITTED)
//	public void importStudentBaseInfo(VStudentBaseInfo student,
//			Map<String, VStudentBaseInfo> map) throws FinanceServiceException {
//		try{
//	
//			Iterator iter = map.entrySet().iterator();
//			
//			TUser user = super.get(TUser.class, student.getUserid());
//			TSetClass setc;
//			Map<String,TSetClass> classList = new HashMap<String, TSetClass>();
//			String cchql =" from TSetClass where VClassid=?";
//			List<StudentBaseInfo> slist= new ArrayList<StudentBaseInfo>();
//			StudentBaseInfo s;
//			String hql = " from StudentBaseInfo where VCode=?";
//			String chql = " from TOrg where VName=?";
//			List<TDiction> dlist;
//			String dhql =" from TDiction where VName=?";
//			List<TOrg> olist;
//			String year;
//			String type;
//			VStudentBaseInfo t;
//			Map.Entry entry;
//			while (iter.hasNext()){
//				entry = (Map.Entry) iter.next();
//				t = (VStudentBaseInfo)entry.getValue();
//			//for(VStudentBaseInfo t:blist){
//				if(super.find(hql, t.getVCode()).size()==0 && t.getVCode().length()==9){
//					
//					//保存班级
//					if(StringUtils.isNotBlank(t.getVClassNoid()) && super.find(cchql, t.getVClassNoid()).size()==0){
//						setc = new TSetClass();
//						setc.setVClassid(t.getVClassNoid());
//						setc.setVName(t.getVClassNoid());
//						setc.setDCreatedate(new Date());
//						setc.setIModel(0);
//						setc.setTUser(user);
//						setc.setIType(0);//自然班、1培训班
//						classList.put(t.getVClassNoid(),setc);
//					}
//					//--------------------------------------------
//					s= new StudentBaseInfo();
//					s.setDCreatedate(new Date());
//					s.setTUser(user);
//					s.setVCode(t.getVCode());//学号获取入校年月
//					
//					if(StringUtils.isNotBlank(t.getRxny())){
//						if(t.getRxny().indexOf("-")==-1){
//							s.setDRxsj(Utilities.parse(t.getRxny(),"yyyyMMdd"));
//						}else{
//							s.setDRxsj(Utilities.parse(t.getRxny()));
//						}
//					}else{
//						year = "20" + t.getVCode().substring(0, 2);
//						s.setDRxsj(Utilities.parse(year + "-09-01"));
//					}
//					if(StringUtils.isNotBlank(t.getLxny())){
//						if(t.getLxny().indexOf("-")==-1){
//							s.setDLxsj(Utilities.parse(t.getLxny(),"yyyyMMdd"));
//						}else{
//							s.setDLxsj(Utilities.parse(t.getLxny()));
//						}
//					}
//					
//					if(StringUtils.isNotBlank(t.getStuTypeName())){
//						dlist= super.find(dhql, t.getStuTypeName());
//						if(dlist.size()>0){
//							s.setTDictionByVStuTypeid(dlist.get(0));
//						}
//					}else{
//						type = t.getVCode().substring(4, 5);
//						if(type.equals("9")){//9代表4+1学生
//							s.setTDictionByVStuTypeid(super.get(TDiction.class, "4028aa494765f33d01476601dcd20040"));
//						}else if(type.equals("8")){//8代表军转民
//							s.setTDictionByVStuTypeid(super.get(TDiction.class, "4028aa494765f33d0147660205b70041"));
//						}else if(type.equals("7")){//7代表短训生
//							s.setTDictionByVStuTypeid(super.get(TDiction.class, "4028aa494765f33d01476602294c0042"));
//						}else{//高招生4028aa494765f33d014766018972003e和2+3 4028aa494765f33d01476601b9f8003f
//							s.setTDictionByVStuTypeid(super.get(TDiction.class, "4028aa494765f33d014766018972003e"));
//						}
//					}
//					s.setVName(t.getVName());
//					s.setVClassNoid(t.getVClassNoid());
//					s.setVCardid(t.getVCardid());
//					s.setVGender(t.getVGender());
//					s.setVJg(t.getJg());
//					s.setVSyd(t.getSyd());
//					if(StringUtils.isNotBlank(t.getCreateTime())){
//						if(t.getCreateTime().indexOf("-")==-1){
//							s.setDBirthday(Utilities.parse(t.getCreateTime(),"yyyyMMdd"));
//						}else{
//							s.setDBirthday(Utilities.parse(t.getCreateTime()));
//						}
//					}
//					if(StringUtils.isNotBlank(t.getCompanyName())){
//						olist = super.find(chql,t.getCompanyName());
//						if(olist.size()>0){
//							s.setTOrg(olist.get(0));
//						}
//					}
//
//					if(StringUtils.isNotBlank(t.getStuStatusName())){
//						dlist= super.find(dhql, t.getStuStatusName());
//						if(dlist.size()>0){
//							s.setTDictionByVStuStatusid(dlist.get(0));
//						}
//					}
//					if(StringUtils.isNotBlank(t.getXjStatusName())){
//						dlist= super.find(dhql, t.getXjStatusName());
//						if(dlist.size()>0){
//							s.setTDictionByVXjStatusid(dlist.get(0));
//						}
//					}
//					
//					if(StringUtils.isNotBlank(t.getFormName())){
//						dlist= super.find(dhql, t.getFormName());
//						if(dlist.size()>0){
//							s.setTDictionByVFormid(dlist.get(0));
//						}
//					}
//					
//					if(StringUtils.isNotBlank(t.getFreeTypeName())){
//						dlist= super.find(dhql, t.getFreeTypeName());
//						if(dlist.size()>0){
//							s.setTDictionByVFreeTypeid(dlist.get(0));
//						}
//					}
//					s.setVLxfs(t.getLxfs());
//					s.setVByyx(t.getByyx());
//					s.setVZzmm(t.getZzmm());
//					
//					if(StringUtils.isNotBlank(t.getNation())){
//						dlist= super.find(dhql, t.getNation());
//						if(dlist.size()>0){
//							s.setTDictionByVNationid(dlist.get(0));
//						}
//					}
//					
//					s.setVJtzz(t.getJtzz());
//					
//					if(StringUtils.isNotBlank(t.getWhcd())){
//						dlist= super.find(dhql, t.getWhcd());
//						if(dlist.size()>0){
//							s.setTDictionByVWhcd(dlist.get(0));
//						}
//					}
//					s.setVEnlevel(t.getEnLevel());
//					s.setVZy(t.getZy());
//					s.setIUsertype(0);
//					s.setOpenStatus(0);
//					s.setITjexam(0);
//					slist.add(s);
//				}
//			}
//
//			if(classList.size()>0){
//				List<TSetClass> cslist= new ArrayList<TSetClass>(); 
//				Iterator citer = classList.entrySet().iterator();
//				Map.Entry centry;
//				while (citer.hasNext()){
//					centry = (Map.Entry) citer.next();
//					cslist.add((TSetClass)centry.getValue());
//				}
//				super.saveOrUpdateALL(cslist);
//			}
//			if(slist.size()>0)
//				super.saveOrUpdateALL(slist);
//			
//			
//			
//		}catch(ParseException p){
//			throw new RuntimeException("导入失败，生日格式错误。");
//		}
//		catch(HibernateException e){
//			throw new RuntimeException("导入失败，数据库错误。");
//		}
//		
//	}
//	/*
//	private List<VStudentBaseInfo> readNotExistStudentList(List<VStudentBaseInfo> list,List<StudentBaseInfo> allStuList){
//		
//		List<VStudentBaseInfo> blist = new ArrayList<VStudentBaseInfo>();
//		
//		boolean flag = false;
//		for(int i=0;i<list.size();i++){
//			flag = false;
//			for(StudentBaseInfo s:allStuList){
//				if(list.get(i).getVCode().equals(s.getVCode())){
//					flag =true;
//					break;
//				}
//			}
//			if(!flag){
//				blist.add(list.get(i));
//			}
//			list.remove(i);//先处理，再移除，提升运算速度。
//			i--;
//		}
//		
//		return blist;
//	}
//	*/
//	private StudentBaseInfo readStudentByCode(String code, List<StudentBaseInfo> list){
//		for(StudentBaseInfo t:list){
//			if(t.getVCode().equals(code)){
//				return t;
//			}
//		}
//		return null;
//	}
//	
//	
//	public TLesson getLesson() {
//		return lesson;
//	}
//
//	public void setLesson(TLesson lesson) {
//		this.lesson = lesson;
//	}
//
//	public TSetClass getSetClass() {
//		return setClass;
//	}
//
//	public void setSetClass(TSetClass setClass) {
//		this.setClass = setClass;
//	}
//	
//	public TScore getScore() {
//		return score;
//	}
//
//	public void setScore(TScore score) {
//		this.score = score;
//	}
//
//	@SuppressWarnings("unchecked")
//	@Transactional(readOnly = false, isolation = Isolation.READ_COMMITTED)
//	public List<VStudentBaseInfo> importStudentScore(VStudentBaseInfo student,
//			List<VStudentBaseInfo> list) throws FinanceServiceException {
//		try{
//			
//			List<StudentBaseInfo> allStuList = super.getAll(StudentBaseInfo.class);
//			
//			//List<VStudentBaseInfo> cclist = new ArrayList<VStudentBaseInfo>();
//			//cclist.addAll(list);
//			
//			//List<VStudentBaseInfo> blist = readNotExistStudentList(cclist,allStuList);
//			List<VStudentBaseInfo> blist = new ArrayList<VStudentBaseInfo>();
//			//if(blist.size()>0){
//			//	return blist;
//			//}
//			String type = student.getStuTypeName();
//
//			List<TScore> slist = new ArrayList<TScore>();
//			TScore sde;
//			
//			TUser user = super.get(TUser.class, student.getUserid());
//			
//			List<TPointLine> pList = super.getAll(TPointLine.class);
//			
//			//String exsistHql = " from TScore where studentBaseInfo.VCode=? and" +
//			//		" TLesson.VLessonName=? and DExamTime=? and TSetClass.VName=?";//判断是否重复
//			
//		//	String exsistHql = " from TScore where studentBaseInfo.VCode=? and" +
//		//	" TLesson.VLessonName=? and TSetClass.VName=?";//判断是否重复
//			
//			List<TScore> clist = super.getAll(TScore.class);
//			
//			//String stuHql = " from StudentBaseInfo where VCode=?";//学生
//			//List<StudentBaseInfo> stuList;
//			
//		//	String lessonHql = " from TLesson where VLessonName=? and IType=?";//课程
//			
//			List<TLesson> lessonList = super.getAll(TLesson.class);
//
//			
//			//String classHql =" from TSetClass where VName=?";//班级
//			List<TSetClass> classList = super.getAll(TSetClass.class);
//			
//			double pline =0;
//			Date date;
//			//List<THistoryscore> hlist = new ArrayList<THistoryscore>();
//			THistoryscore history;//ITimes  存储是否补考成绩 1:新成绩2:补考成绩
//			String hisHql = " from THistoryscore where TScore.VId=? and DExamtime=? ";//历史成绩是否重复
//			List<THistoryscore> hisList;
//			boolean flag = false;
//		//	boolean hisbool = false;
//			for(VStudentBaseInfo t:list){
//				
//				if(t.getCreateTime().indexOf("-")==-1){
//					date = Utilities.parse(t.getCreateTime(),"yyyyMMdd");
//				}else{
//					date = Utilities.parse(t.getCreateTime());
//				}
//				
//				//clist = super.find(exsistHql, t.getVCode(),t.getCompanyName(),t.getVClassNoid());
//				flag = false;
//				for(TScore ts:clist){
//					
//					if(t.getVCode().equals(ts.getStudentBaseInfo().getVCode()) &&
//						t.getCompanyName().equals(ts.getTLesson().getVLessonName()) && 
//						t.getVClassNoid().equals(ts.getTSetClass().getVName()) &&
//						t.getCreateTime().equals(Utilities.format(ts.getDExamTime()))
//					){
//
//						flag = true;
//						break;
//					}
//				}
//				
//				if(!flag){
//					sde = new TScore();
//					sde.setTUserByVCreateUserId(user);
//					sde.setDCreateDate(new Date());
//
//					for(TLesson l:lessonList){
//						if(l.getIType().equals(Integer.parseInt(type)) && l.getVLessonName().endsWith(t.getCompanyName())){
//							this.setLesson(l);
//							break;
//						}
//					}
//					
//					if(this.getLesson()==null || StringUtils.isBlank(this.getLesson().getVId())){
//						throw new FinanceServiceException("导入失败，课程名称有误。");
//					}
//								
//					for(TSetClass c:classList){
//						
//						if(c.getVName().equals(t.getVClassNoid())){
//							this.setSetClass(c);
//							break;
//						}
//						
//					}
//					if(this.getSetClass()==null || StringUtils.isBlank(this.getSetClass().getVId())){
//						throw new FinanceServiceException("导入失败，班级名称有误。");
//					}
//					
//					pline = 4.5;
//					for(TPointLine p:pList){
//						
//						if(p.getTLesson().getVLessonName().equals(t.getCompanyName())
//								&& p.getTSetClass().getVName().equals(t.getVClassNoid())){
//							pline =pList.get(0).getDPointLine();
//							break;
//						}
//						
//					}
//										
//					sde.setTSetClass(this.getSetClass());
//					sde.setTLesson(this.getLesson());
//					sde.setStudentBaseInfo(readStudentByCode(t.getVCode(), allStuList));
//					sde.setDExamTime(date);
//					sde.setITimes(1);//第一次考试
//					sde.setIAudit(3);//审核通过
//					sde.setDScore(Double.parseDouble(t.getSyd()));
//					if(sde.getDScore()>=pline){
//						sde.setIPass(0);
//					}else{
//						sde.setIPass(1);
//					}
//					slist.add(sde);
//				}
//
//			}
//			
//			if(slist.size()>0){
//				super.saveOrUpdateALL(slist);
//			}
//			
//			//将重复的成绩转移到历史表
//			
//			String sql = "select v_classid,v_stuid,v_lessonid,count(v_lessonid) from t_score" +
//					" group by v_classid,v_stuid,v_lessonid having count(v_lessonid)>1";
//			String hql = " from TScore where TSetClass.VId=? and studentBaseInfo.VId=? and TLesson.VId=? order by DExamTime desc";
//			TScore mainScore;
//			List<TScore> cslist;
//			List<Object[]> olist = super.createSQLQuery(sql).list();
//			int times=1;
//			for(Object[] o:olist){
//				
//				times=1;
//				cslist = super.find(hql, o[0],o[1],o[2]);//除了第一个全部转到历史表
//				mainScore = cslist.get(0);//主成绩
//				for(int i=1;i<cslist.size();i++){
//					times = times+1;
//					//判断历史成绩表中是否有该历史成绩
//					hisList = super.find(hisHql, mainScore.getVId(),cslist.get(i).getDExamTime());
//					
//					if(hisList.size()==0){
//						history = new THistoryscore();
//						history.setDCreateDate(new Date());
//						history.setTUserByVCreateUserId(user);
//						history.setDExamtime(cslist.get(i).getDExamTime());
//						history.setTScore(mainScore);
//						history.setDScore(cslist.get(i).getDScore());
//						super.save(history);
//					}
//					super.remove(cslist.get(i));
//				}
//				mainScore.setITimes(times);
//				super.update(mainScore);
//				
//				
//			}
//			
//
//			return blist;
//		}catch(ParseException p){
//			throw new FinanceServiceException("导入失败，生日格式错误。");
//		}
//		catch(HibernateException e){
//			throw new FinanceServiceException("导入失败，数据库错误。");
//		}
//		
//	}
//	@SuppressWarnings("unchecked")
//	public List<VScore> readStudentScoreById(String id,String type)
//			throws FinanceServiceException {
//		List<VScore> blist = new ArrayList<VScore>();
//		VScore vs;
//		String hql =" from TScore where studentBaseInfo.VId=? and TLesson.IType=?";
//		List<TScore> list = super.find(hql, id,Integer.parseInt(type));
//		for(TScore t:list){
//			vs = new VScore();
//			vs.setDScore(t.getDScore());
//			vs.setLessonid(t.getTLesson().getVId());
//			vs.setIAudit(t.getIAudit());
//			blist.add(vs);
//		}
//		return blist;
//	}
//	
//
//	@Transactional(readOnly = false, isolation = Isolation.READ_COMMITTED)
//	public void editLessonScore(String id,String dscore) throws FinanceServiceException {
//		try{
//			TScore score = super.get(TScore.class,id);
//			if(score==null){
//				THistoryscore history = super.get(THistoryscore.class,id);
//				if(history!=null){
//					history.setDScore(Double.parseDouble(dscore));
//					super.update(history);
//				}
//			}else{
//				score.setDScore(Double.parseDouble(dscore));
//				super.update(score);
//			}
//			
//		}catch(HibernateException e){
//			throw new RuntimeException("编辑成绩失败，数据库错误。");
//		}
//	}
//	
//	@SuppressWarnings("unchecked")
//	@Transactional(readOnly = false, isolation = Isolation.READ_COMMITTED)
//	public void deleteLessonScore(String id) throws FinanceServiceException {
//		try{
//			
//			TScore  score = super.get(TScore.class, id);
//			
//			if(score==null){//删除补考成
//				
//				THistoryscore his = super.get(THistoryscore.class, id);
//				
//				//补考次数减一
//				TScore mains = his.getTScore();
//				mains.setITimes(mains.getITimes()-1);
//				super.update(mains);
//				super.removeById(THistoryscore.class,id);
//							
//			
//			}else{//删除主体表的成绩
//				
//				//首先处理补考成绩
//				String hql =" from THistoryscore where TScore.VId=? order by DExamtime desc";
//				
//				List<THistoryscore> list = super.find(hql, id);
//				if(list.size()==0){
//					super.removeById(TScore.class, id);
//				}else{
//					score.setITimes(score.getITimes()-1);
//					score.setDExamTime(list.get(0).getDExamtime());
//					score.setDScore(list.get(0).getDScore());
//					score.setDCreateDate(list.get(0).getDCreateDate());
//					score.setTUserByVCreateUserId(list.get(0).getTUserByVCreateUserId());
//					super.update(score);
//					
//					super.remove(list.get(0));
//				}
//				
//			}			
//			
//			
//		}catch(HibernateException e){
//			throw new FinanceServiceException("删除成绩失败，数据库错误。");
//		}
//	}
//
//	public VSetClassContent readVSetClassContent(String id)
//			throws FinanceServiceException {
//		VSetClassContent vs = new VSetClassContent();
//		TSetClass vc = super.get(TSetClass.class, id);
//		vs.setVId(vc.getVId());
//		vs.setVName(vc.getVName());
//		if(vc.getTOtheruser()!=null){
//			vs.setUserid(vc.getTOtheruser().getVId());
//		}else{
//			vs.setUserid("");
//		}
//		
//		vs.setIModel(vc.getIModel());
//		vs.setDCreateClassTime(Utilities.format(vc.getDCreateClassTime()));
//		vs.setDBeginLessionTime(Utilities.format(vc.getDBeginLessionTime()));
//		vs.setDEndLessionTime(Utilities.format(vc.getDEndLessionTime()));
//		return vs;
//	}
//	
//	@Transactional(readOnly = false, isolation = Isolation.READ_COMMITTED)
//	public void deleteClassInfoById(String id) throws FinanceServiceException {
//		super.removeById(TSetClass.class, id);
//	}
//	
//	@Transactional(readOnly = false, isolation = Isolation.READ_COMMITTED)
//	public void updateSetClass(TSetClass sclass) throws FinanceServiceException {
//		TSetClass old = super.get(TSetClass.class, sclass.getVId());
//		old.setVName(sclass.getVName());
//		old.setVClassid(sclass.getVName());
//		old.setIModel(sclass.getIModel());
//		old.setTOtheruser(sclass.getTOtheruser());
//		old.setDCreateClassTime(sclass.getDCreateClassTime());
//		old.setDBeginLessionTime(sclass.getDBeginLessionTime());
//		old.setDEndLessionTime(sclass.getDEndLessionTime());
//		super.update(old);
//	}
//	
//	@Transactional(readOnly = false, isolation = Isolation.READ_COMMITTED)
//	public void deletePointLineById(String id) throws FinanceServiceException {
//
//		try{
//			TPointLine line = super.get(TPointLine.class, id);
//			String hql = " from TScore where TLesson.VId=?";
//			
//			if(super.find(hql, line.getTLesson().getVId()).size()>0){
//				throw new FinanceServiceException("删除失败，课程已经有成绩。");
//			}
//			
//			super.remove(line);
//			
//		}catch(HibernateException e){
//			throw new FinanceServiceException("删除失败，数据错误。");
//		}
//	}
//	
//	@Transactional(readOnly = false, isolation = Isolation.READ_COMMITTED)
//	public void updatePointLine(TPointLine line) throws FinanceServiceException {
//		try{
//			TPointLine old = super.get(TPointLine.class, line.getVId());
//			String hql = " from TScore where TLesson.VId=?";
//			if(super.find(hql, old.getTLesson().getVId()).size()>0){
//				throw new FinanceServiceException("编辑失败，课程已经有成绩。");
//			}
//			old.setDPointLine(line.getDPointLine());
//			old.setIBktimes(line.getIBktimes());
//			old.setIDays(line.getIDays());
//			super.update(old);
//			
//		}catch(HibernateException e){
//			throw new FinanceServiceException("编辑失败，数据错误。");
//		}
//	}
//	
//	@Transactional(readOnly = false, isolation = Isolation.READ_COMMITTED)
//	public void saveStudentAssignClass(StudentDistributionClass stuClass)
//			throws FinanceServiceException {
//		try{
//			
//			List<StudentDistributionClass> saveList = new ArrayList<StudentDistributionClass>();
//			
//			StudentDistributionClass sc;
//			String sid = stuClass.getStudentBaseInfo().getVId();
//			String[] os = sid.split(",");
//			
//			String hql = " from StudentDistributionClass where studentBaseInfo.VId=? and TSetClass.VId=?";
//			
//			for(int i=0;i<os.length;i++){
//				
//				if(super.find(hql, os[i],stuClass.getTSetClass().getVId()).size()>0){
//					//throw new FinanceServiceException("分班失败，选择的学生中有已分配班级的学生。");
//					continue;
//				}
//				sc = new StudentDistributionClass();
//				sc.setDAssigntime(stuClass.getDAssigntime());
//				sc.setDCreatedate(new Date());
//				sc.setTUser(stuClass.getTUser());
//				sc.setTSetClass(stuClass.getTSetClass());
//				sc.setStudentBaseInfo(super.get(StudentBaseInfo.class, os[i]));
//				saveList.add(sc);
//			}
//			
//			if(saveList.size()>0){
//				super.saveOrUpdateALL(saveList);
//			}
//			
//		}catch(HibernateException e){
//			throw new FinanceServiceException("分配班级失败，数据错误。");
//		}
//	}
//	
//	@Transactional(readOnly = false, isolation = Isolation.READ_COMMITTED)
//	public void deleteStudentAssignClassById(String id)
//			throws FinanceServiceException {
//		super.removeById(StudentDistributionClass.class, id);
//	}
//	
//	@Transactional(readOnly = false, isolation = Isolation.READ_COMMITTED)
//	public void updateStudentAssignClass(StudentDistributionClass stuClass)
//			throws FinanceServiceException {
//		StudentDistributionClass old = super.get(StudentDistributionClass.class, stuClass.getVId());
//		
//		String hql = " from StudentDistributionClass where VId<>? and studentBaseInfo.VId=? and TSetClass.VId=?";
//		
//		if(super.find(hql, old.getVId(),old.getStudentBaseInfo().getVId(),stuClass.getTSetClass().getVId()).size()>0){
//			throw new FinanceServiceException("编辑班级失败，新班级与已分配的班级重复。");
//		}
//		old.setDAssigntime(stuClass.getDAssigntime());
//		old.setTSetClass(stuClass.getTSetClass());
//		
//		super.update(old);
//	}
//
//	@SuppressWarnings("unchecked")
//	public List<StudentBaseInfo> readStudentBaseInfoByClassid(String classid,
//			String isView,String lessonid) throws FinanceServiceException {
//		String hql ="";
//		List<StudentDistributionClass> list;
//		
//		if(isView!=null && isView.equals("0")){
//			hql =" from StudentDistributionClass where TSetClass.VId=?" +
//					" and studentBaseInfo.VId not in (select studentBaseInfo.VId" +
//					" from TScore where IPass=0 and  TLesson.VId=? and TSetClass.VId=?) order by studentBaseInfo.VCode,VId";
//			list = super.find(hql, classid,lessonid,classid);
//		}else{
//
//			hql =" from StudentDistributionClass where TSetClass.VId=? order by studentBaseInfo.VCode,VId";
//			list = super.find(hql, classid);
//		}
//		String shql = " from TScore where studentBaseInfo.VId=? and TLesson.VId=? and TSetClass.VId=?";
//		List<TScore> slist;
//		List<StudentBaseInfo> blist = new ArrayList<StudentBaseInfo>();
//		StudentBaseInfo sb;
//		for(StudentDistributionClass s:list){
//			sb = s.getStudentBaseInfo();
//			
//			slist = super.find(shql, s.getStudentBaseInfo().getVId(),lessonid,classid);
//			if(slist.size()==0){
//				sb.setITjexam(0);
//				sb.setVJtzz("");
//			}else{
//				if(slist.get(0).getIPass()==0){
//					sb.setITjexam(1);
//				}else{
//					sb.setITjexam(2);
//				}
//				sb.setVJtzz(Utilities.getXxje(slist.get(0).getDScore()));
//				sb.setVJg(Utilities.format(slist.get(0).getDExamTime()));
//			}
//			
//			blist.add(sb);
//		}
//		
//		return blist;
//	}
//	
//	@Transactional(readOnly = false, isolation = Isolation.READ_COMMITTED)
//	public void saveChangeStudentCommpany(String ids, String newid, String opt,
//			String changeDate, String changeReason)
//			throws FinanceServiceException {
//		try{
//			List<StudentBaseInfo> saveList = new ArrayList<StudentBaseInfo>();
//			StudentBaseInfo st;
//			String[] os = ids.split(",");
//			if(opt.equals("zt")){
//				
//				for(int i=0;i<os.length;i++){
//					st = super.get(StudentBaseInfo.class, os[i]);
//					st.setTDictionByVStuStatusid(super.get(TDiction.class, newid));
//					saveList.add(st);
//				}
//				
//			}else if(opt.equals("xj")){
//				for(int i=0;i<os.length;i++){
//					st = super.get(StudentBaseInfo.class, os[i]);
//					st.setTDictionByVXjStatusid(super.get(TDiction.class, newid));
//					saveList.add(st);
//				}
//			}else if(opt.equals("gs")){
//				for(int i=0;i<os.length;i++){
//					st = super.get(StudentBaseInfo.class, os[i]);
//					st.setTOrg(super.get(TOrg.class, newid));
//					saveList.add(st);
//				}	
//			}else{
//				
//			}
//			if(saveList.size()>0)
//				super.saveOrUpdateALL(saveList);
//			
//		}catch(HibernateException e){
//			throw new FinanceServiceException("更新失败，数据错误。");
//		}
//	}
//
//	@Transactional(readOnly = false, isolation = Isolation.READ_COMMITTED)
//	public void deleteForeignaviationschoolinterview(String id)
//			throws FinanceServiceException {
//		try{
//			super.removeById(TForeignaviationschoolinterview.class, id);
//		}catch(HibernateException e){
//			throw new FinanceServiceException("删除失败，数据错误。");
//		}
//	}
//
//	@Transactional(readOnly = false, isolation = Isolation.READ_COMMITTED)
//	public void updateForeignaviationschoolinterview(
//			TForeignaviationschoolinterview view)
//			throws FinanceServiceException {
//		try{
//			TForeignaviationschoolinterview old = super.get(TForeignaviationschoolinterview.class, view.getVId());
//			old.setDAuditiontime(view.getDAuditiontime());
//			old.setIResult(view.getIResult());
//			super.update(old);
//			
//			Studentassignschool oldSchool = old.getStudentassignschool();
//			oldSchool.setTAbroadaviationschool(super.get(TAbroadaviationschool.class, view.getTUser().getVId()));//借用user.vid存储新的航校
//			
//			super.update(oldSchool);
//			
//		}catch(HibernateException e){
//			throw new RuntimeException("更新失败，数据错误。");
//		}
//		
//	}
//
//	@Transactional(readOnly = false, isolation = Isolation.READ_COMMITTED)
//	public void deleteAbroadtrain(String id)
//			throws FinanceServiceException {
//		try{
//			super.removeById(TAbroadtrain.class, id);
//		}catch(HibernateException e){
//			throw new FinanceServiceException("删除失败，数据错误。");
//		}
//	}
//
//	@Transactional(readOnly = false, isolation = Isolation.READ_COMMITTED)
//	public void updateAbroadtrain(TAbroadtrain abroadtrain)
//			throws FinanceServiceException {
//		try{
//			TAbroadtrain old = super.get(TAbroadtrain.class, abroadtrain.getVId());
//
//			old.setDCgtime(abroadtrain.getDCgtime());
//			old.setDHgtime(abroadtrain.getDHgtime());
//			if(StringUtils.isNotBlank(abroadtrain.getVReason())){
//				old.setIStatus(1);				
//			}else{
//				old.setIStatus(0);
//			}
//			old.setDStopflytime(abroadtrain.getDStopflytime());
//			old.setVReason(abroadtrain.getVReason());
//			super.update(old);
//			
//			
//			
//		}catch(HibernateException e){
//			throw new RuntimeException("更新失败，数据错误。");
//		}
//		
//	}
//
//	@SuppressWarnings("unchecked")
//	public TOtheruser readOtherUserByCode(String code)
//			throws FinanceServiceException {
//		String hql =" from TOtheruser where VCode=?";
//		List<TOtheruser> list = super.find(hql, code);
//		if(list.size()==0){
//			return null;
//		}
//		return list.get(0);
//	}
//
//	@SuppressWarnings("unchecked")
//	public Page readRecommendedList(Map<String, Object> params, String pageNo)
//			throws FinanceServiceException {
//
//		String ids = "";
//		if(params.get("ids")!=null && !params.get("ids").equals("")){
//			ids = params.get("ids").toString();
//		}
//		String order = " studentBaseInfo.VCode";
//		if(ids.length()>0){
//			order = "";
//			String[] os = ids.split(",");
//			for(int i=0;i<os.length;i++){
//				if(i==os.length-1){
//					if(os[i].equals("lesson")){
//						order+= "TLesson.VId";
//					}else if(os[i].equals("person")){
//						order+= "TOtheruser.VId";
//					}else{
//						order+= "DExamDate";
//					}
//					
//				}else{
//					if(os[i].equals("lesson")){
//						order+= "TLesson.VId,";
//					}else if(os[i].equals("person")){
//						order+= "TOtheruser.VId,";
//					}else{
//						order+= "DExamDate,";
//					}
//				}
//			}
//		}else{
//		
//			if(params.get("order")!=null && !params.get("order").equals("")){
//				order = params.get("order").toString();
//			}
//			if(order.equals("VCode")){
//				order = "studentBaseInfo.VCode";
//			}else if(order.equals("Lesson")){
//				order = "TLesson.VId";
//			}else if(order.equals("DExamDate")){
//				order = "DExamDate";
//			}else if(order.equals("Other")){
//				order = "TOtheruser.VId";
//			}else{
//				order = "DTjdate";
//			}
//		}
//	//	Criteria criteria = this.createCriteria(RecommendStudentLicenseExam.class);
//		String cond ="";
//		String zhql ="";
//		//获取教员所在培训班，获取该办的学员信息
//		String hql =" from TSetClass where TOtheruser.VCode=?";
//		List<TSetClass> tlist = super.find(hql, params.get(QUERY_KEY_LOGIN_USER));
//		String str = "";
//		for(int i = 0;i<tlist.size();i++){
//			if(i==tlist.size()-1){
//				str+="'"+tlist.get(i).getVId()+"'";
//			}else{
//				str+="'"+tlist.get(i).getVId()+"',";
//			}
//		}
//		if(tlist.size()>0){
//			cond += " and studentBaseInfo.VId in (select studentBaseInfo.VId " +
//					"from StudentDistributionClass where TSetClass.VId in (" + str + "))";
//			//criteria.add(Restrictions.sqlRestriction(sql));
//		}
//		
//		if(params.get(QUERY_KEY_NAME)!=null && !params.get(QUERY_KEY_NAME).equals("")){
//			
//			cond+=" and (studentBaseInfo.VName like '%"+params.get(QUERY_KEY_NAME)+"%'" +
//					" or studentBaseInfo.VCode like '%"+params.get(QUERY_KEY_NAME)+"%')";
//			//criteria.createCriteria("studentBaseInfo", "stu").
//			
//			//add(Restrictions.or(Restrictions.eq("VName", params.get(QUERY_KEY_NAME)),Restrictions.eq("VCode", params.get(QUERY_KEY_NAME))));
//		}
//		if(params.get("lesson")!=null && !params.get("lesson").equals("")){//课程
//			
//			cond+=" and TLesson.VLessonName='"+params.get("lesson")+"'";
//		
//		}	
//		if(params.get("riqi")!=null && !params.get("riqi").equals("")){//日期
//			
//			cond+=" and DExamDate='"+params.get("riqi")+"'";
//		
//		}
//		if(params.get("id")!=null && !params.get("id").equals("")){//推荐人
//			cond+=" and TOtheruser.VName like '%"+params.get("id")+"%'";
//		}
//		zhql =" from RecommendStudentLicenseExam where 1=1 " + cond +" order by " +order;
//		//System.out.println(zhql);
//		Integer pageIndex = Integer.parseInt(pageNo);
//		int pageSize = FinanceConfig.getIntProperty("default.index.min");
//		try {
//			Page page = this.pagedQuery(zhql, pageIndex, pageSize);
//			return page;
//		} catch (HibernateException e) {
//		//	e.printStackTrace();
//			throw new FinanceServiceException("获取学生信息列表失败", e);
//		}
//		
//	}
//
//	@Transactional(readOnly = false, isolation = Isolation.READ_COMMITTED)
//	public void importHistoryScore() throws FinanceServiceException {
//
//		List<THistoryscorebak> list = super.getAll(THistoryscorebak.class);
//		List<TScore> slist = super.getAll(TScore.class);
//		List<THistoryscore> hisList = super.getAll(THistoryscore.class);
//		
//		List<THistoryscore> saveList = new ArrayList<THistoryscore>();
//		THistoryscore his;
//		TScore score;
//		int flag = 0;
//		int p = 0;
//		int n=0;
//		for(THistoryscorebak b:list){
//			flag = 0;
//			p=0;
//			for(THistoryscore h:hisList){
//				if(h.getTScore().getVId().equals(b.getVScoreid()) && h.getDExamtime().equals(b.getDExamtime())){
//					flag=1;
//					n=n+1;
//					
//					break;
//				}
//			}
//			
//			if(flag==0){//不改原历史表
//				for(TScore s:slist){
//					if(s.getVId().equals(b.getVScoreid()) && s.getDExamTime().equals(b.getDExamtime())){
//						p=1;
//						break;
//					}
//				}
//				if(p==0){
//					score = super.get(TScore.class, b.getVScoreid());
//					if(score==null){
//						continue;
//					}
//					his = new THistoryscore();
//					his.setDExamtime(b.getDExamtime());
//					his.setTScore(score);
//					his.setDScore(b.getDScore());
//					his.setDCreateDate(b.getDCreateDate());
//					his.setTUserByVCreateUserId(super.get(TUser.class, b.getVCreateUserId()));
//					saveList.add(his);
//				}
//			}
//			
//		}
//		
//		if(saveList.size()>0){
//			
//			super.saveOrUpdateALL(saveList);
//		}
//	}
//	
//	
//}
